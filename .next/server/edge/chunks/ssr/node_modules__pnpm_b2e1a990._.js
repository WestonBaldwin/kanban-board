(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["chunks/ssr/node_modules__pnpm_b2e1a990._.js",4812,(a,b,c)=>{!function(d){"use strict";function e(a){var b,e=a&&a.Promise||d.Promise,f=a&&a.XMLHttpRequest||d.XMLHttpRequest;return b=Object.create(d,{fetch:{value:void 0,writable:!0}}),function(a){var c=void 0!==b&&b||"undefined"!=typeof self&&self||void 0!==c&&c,d={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch(a){return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};if(d.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(a){return a&&g.indexOf(Object.prototype.toString.call(a))>-1};function i(a){if("string"!=typeof a&&(a=String(a)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(a)||""===a)throw TypeError("Invalid character in header field name");return a.toLowerCase()}function j(a){return"string"!=typeof a&&(a=String(a)),a}function k(a){var b={next:function(){var b=a.shift();return{done:void 0===b,value:b}}};return d.iterable&&(b[Symbol.iterator]=function(){return b}),b}function l(a){this.map={},a instanceof l?a.forEach(function(a,b){this.append(b,a)},this):Array.isArray(a)?a.forEach(function(a){this.append(a[0],a[1])},this):a&&Object.getOwnPropertyNames(a).forEach(function(b){this.append(b,a[b])},this)}function m(a){if(a.bodyUsed)return e.reject(TypeError("Already read"));a.bodyUsed=!0}function n(a){return new e(function(b,c){a.onload=function(){b(a.result)},a.onerror=function(){c(a.error)}})}function o(a){var b=new FileReader,c=n(b);return b.readAsArrayBuffer(a),c}function p(a){if(a.slice)return a.slice(0);var b=new Uint8Array(a.byteLength);return b.set(new Uint8Array(a)),b.buffer}function q(){return this.bodyUsed=!1,this._initBody=function(a){if(this.bodyUsed=this.bodyUsed,this._bodyInit=a,a)if("string"==typeof a)this._bodyText=a;else if(d.blob&&Blob.prototype.isPrototypeOf(a))this._bodyBlob=a;else if(d.formData&&FormData.prototype.isPrototypeOf(a))this._bodyFormData=a;else if(d.searchParams&&URLSearchParams.prototype.isPrototypeOf(a))this._bodyText=a.toString();else{var b;d.arrayBuffer&&d.blob&&(b=a)&&DataView.prototype.isPrototypeOf(b)?(this._bodyArrayBuffer=p(a.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(a)||h(a))?this._bodyArrayBuffer=p(a):this._bodyText=a=Object.prototype.toString.call(a)}else this._bodyText="";!this.headers.get("content-type")&&("string"==typeof a?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var a=m(this);if(a)return a;if(this._bodyBlob)return e.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return e.resolve(new Blob([this._bodyArrayBuffer]));if(!this._bodyFormData)return e.resolve(new Blob([this._bodyText]));throw Error("could not read FormData body as blob")},this.arrayBuffer=function(){if(!this._bodyArrayBuffer)return this.blob().then(o);var a=m(this);return a||(ArrayBuffer.isView(this._bodyArrayBuffer)?e.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):e.resolve(this._bodyArrayBuffer))}),this.text=function(){var a,b,c,d=m(this);if(d)return d;if(this._bodyBlob)return a=this._bodyBlob,c=n(b=new FileReader),b.readAsText(a),c;if(this._bodyArrayBuffer)return e.resolve(function(a){for(var b=new Uint8Array(a),c=Array(b.length),d=0;d<b.length;d++)c[d]=String.fromCharCode(b[d]);return c.join("")}(this._bodyArrayBuffer));if(!this._bodyFormData)return e.resolve(this._bodyText);throw Error("could not read FormData body as text")},d.formData&&(this.formData=function(){return this.text().then(t)}),this.json=function(){return this.text().then(JSON.parse)},this}l.prototype.append=function(a,b){a=i(a),b=j(b);var c=this.map[a];this.map[a]=c?c+", "+b:b},l.prototype.delete=function(a){delete this.map[i(a)]},l.prototype.get=function(a){return a=i(a),this.has(a)?this.map[a]:null},l.prototype.has=function(a){return this.map.hasOwnProperty(i(a))},l.prototype.set=function(a,b){this.map[i(a)]=j(b)},l.prototype.forEach=function(a,b){for(var c in this.map)this.map.hasOwnProperty(c)&&a.call(b,this.map[c],c,this)},l.prototype.keys=function(){var a=[];return this.forEach(function(b,c){a.push(c)}),k(a)},l.prototype.values=function(){var a=[];return this.forEach(function(b){a.push(b)}),k(a)},l.prototype.entries=function(){var a=[];return this.forEach(function(b,c){a.push([c,b])}),k(a)},d.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var r=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function s(a,b){if(!(this instanceof s))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var c,d,e=(b=b||{}).body;if(a instanceof s){if(a.bodyUsed)throw TypeError("Already read");this.url=a.url,this.credentials=a.credentials,b.headers||(this.headers=new l(a.headers)),this.method=a.method,this.mode=a.mode,this.signal=a.signal,e||null==a._bodyInit||(e=a._bodyInit,a.bodyUsed=!0)}else this.url=String(a);if(this.credentials=b.credentials||this.credentials||"same-origin",(b.headers||!this.headers)&&(this.headers=new l(b.headers)),this.method=(d=(c=b.method||this.method||"GET").toUpperCase(),r.indexOf(d)>-1?d:c),this.mode=b.mode||this.mode||null,this.signal=b.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e)throw TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(e),("GET"===this.method||"HEAD"===this.method)&&("no-store"===b.cache||"no-cache"===b.cache)){var f=/([?&])_=[^&]*/;f.test(this.url)?this.url=this.url.replace(f,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime()}}function t(a){var b=new FormData;return a.trim().split("&").forEach(function(a){if(a){var c=a.split("="),d=c.shift().replace(/\+/g," "),e=c.join("=").replace(/\+/g," ");b.append(decodeURIComponent(d),decodeURIComponent(e))}}),b}function u(a,b){if(!(this instanceof u))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');b||(b={}),this.type="default",this.status=void 0===b.status?200:b.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in b?b.statusText:"",this.headers=new l(b.headers),this.url=b.url||"",this._initBody(a)}s.prototype.clone=function(){return new s(this,{body:this._bodyInit})},q.call(s.prototype),q.call(u.prototype),u.prototype.clone=function(){return new u(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},u.error=function(){var a=new u(null,{status:0,statusText:""});return a.type="error",a};var v=[301,302,303,307,308];u.redirect=function(a,b){if(-1===v.indexOf(b))throw RangeError("Invalid status code");return new u(null,{status:b,headers:{location:a}})},a.DOMException=c.DOMException;try{new a.DOMException}catch(b){a.DOMException=function(a,b){this.message=a,this.name=b;var c=Error(a);this.stack=c.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function w(b,g){return new e(function(e,h){var i=new s(b,g);if(i.signal&&i.signal.aborted)return h(new a.DOMException("Aborted","AbortError"));var k=new f;function m(){k.abort()}k.onload=function(){var a,b,c={status:k.status,statusText:k.statusText,headers:(a=k.getAllResponseHeaders()||"",b=new l,a.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(a){return 0===a.indexOf("\n")?a.substr(1,a.length):a}).forEach(function(a){var c=a.split(":"),d=c.shift().trim();if(d){var e=c.join(":").trim();b.append(d,e)}}),b)};c.url="responseURL"in k?k.responseURL:c.headers.get("X-Request-URL");var d="response"in k?k.response:k.responseText;setTimeout(function(){e(new u(d,c))},0)},k.onerror=function(){setTimeout(function(){h(TypeError("Network request failed"))},0)},k.ontimeout=function(){setTimeout(function(){h(TypeError("Network request failed"))},0)},k.onabort=function(){setTimeout(function(){h(new a.DOMException("Aborted","AbortError"))},0)},k.open(i.method,function(a){try{return""===a&&c.location.href?c.location.href:a}catch(b){return a}}(i.url),!0),"include"===i.credentials?k.withCredentials=!0:"omit"===i.credentials&&(k.withCredentials=!1),"responseType"in k&&(d.blob?k.responseType="blob":d.arrayBuffer&&i.headers.get("Content-Type")&&-1!==i.headers.get("Content-Type").indexOf("application/octet-stream")&&(k.responseType="arraybuffer")),!g||"object"!=typeof g.headers||g.headers instanceof l?i.headers.forEach(function(a,b){k.setRequestHeader(b,a)}):Object.getOwnPropertyNames(g.headers).forEach(function(a){k.setRequestHeader(a,j(g.headers[a]))}),i.signal&&(i.signal.addEventListener("abort",m),k.onreadystatechange=function(){4===k.readyState&&i.signal.removeEventListener("abort",m)}),k.send(void 0===i._bodyInit?null:i._bodyInit)})}w.polyfill=!0,c.fetch||(c.fetch=w,c.Headers=l,c.Request=s,c.Response=u),a.Headers=l,a.Request=s,a.Response=u,a.fetch=w,Object.defineProperty(a,"__esModule",{value:!0})}(c),{fetch:b.fetch,Headers:b.Headers,Request:b.Request,Response:b.Response,DOMException:b.DOMException}}if("function"==typeof define&&define.amd)a.r,void 0!==e&&a.v(e);else b.exports=e}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:a.g)},86936,(a,b,c)=>{b.exports=self.fetch.bind(self),b.exports.default=b.exports},33369,(a,b,c)=>{"use strict";var d=a.r(61088);d.useState,d.useEffect,d.useLayoutEffect,d.useDebugValue,c.useSyncExternalStore=void 0!==d.useSyncExternalStore?d.useSyncExternalStore:function(a,b){return b()}},98178,(a,b,c)=>{"use strict";b.exports=a.r(33369)},84856,(a,b,c)=>{"use strict";var d=a.r(61088),e=a.r(98178),f="function"==typeof Object.is?Object.is:function(a,b){return a===b&&(0!==a||1/a==1/b)||a!=a&&b!=b},g=e.useSyncExternalStore,h=d.useRef,i=d.useEffect,j=d.useMemo,k=d.useDebugValue;c.useSyncExternalStoreWithSelector=function(a,b,c,d,e){var l=h(null);if(null===l.current){var m={hasValue:!1,value:null};l.current=m}else m=l.current;var n=g(a,(l=j(function(){function a(a){if(!i){if(i=!0,g=a,a=d(a),void 0!==e&&m.hasValue){var b=m.value;if(e(b,a))return h=b}return h=a}if(b=h,f(g,a))return b;var c=d(a);return void 0!==e&&e(b,c)?(g=a,b):(g=a,h=c)}var g,h,i=!1,j=void 0===c?null:c;return[function(){return a(b())},null===j?void 0:function(){return a(j())}]},[b,c,d,e]))[0],l[1]);return i(function(){m.hasValue=!0,m.value=n},[n]),k(n),n}},28081,(a,b,c)=>{"use strict";b.exports=a.r(84856)},37969,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.__assign=function(){return c.__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a},c.__assign.apply(this,arguments)},c.__read=function(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g},c.__rest=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c},c.__spreadArray=function(a,b,c){if(c||2==arguments.length)for(var d,e=0,f=b.length;e<f;e++)!d&&e in b||(d||(d=Array.prototype.slice.call(b,0,e)),d[e]=b[e]);return a.concat(d||Array.prototype.slice.call(b))},c.__values=function(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}},79436,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a.r(37969),e={timeout:1e4};c.waitFor=function(a,b,c){var f=d.__assign(d.__assign({},e),c);return new Promise(function(c,d){var e=!1,g=f.timeout===1/0?void 0:setTimeout(function(){i.unsubscribe(),d(Error("Timeout of ".concat(f.timeout," ms exceeded")))},f.timeout),h=function(){clearTimeout(g),e=!0,null==i||i.unsubscribe()},i=a.subscribe({next:function(a){b(a)&&(h(),c(a))},error:function(a){h(),d(a)},complete:function(){h(),d(Error("Actor terminated without satisfying predicate"))}});e&&i.unsubscribe()})}},81307,50693,a=>{"use strict";class b extends Error{}function c(a,c){let d;if("string"!=typeof a)throw new b("Invalid token specified: must be a string");c||(c={});let e=+(!0!==c.header),f=a.split(".")[e];if("string"!=typeof f)throw new b(`Invalid token specified: missing part #${e+1}`);try{d=function(a){let b=a.replace(/-/g,"+").replace(/_/g,"/");switch(b.length%4){case 0:break;case 2:b+="==";break;case 3:b+="=";break;default:throw Error("base64 string is not of the correct length")}try{var c;return c=b,decodeURIComponent(atob(c).replace(/(.)/g,(a,b)=>{let c=b.charCodeAt(0).toString(16).toUpperCase();return c.length<2&&(c="0"+c),"%"+c}))}catch(a){return atob(b)}}(f)}catch(a){throw new b(`Invalid token specified: invalid base64 for part #${e+1} (${a.message})`)}try{return JSON.parse(d)}catch(a){throw new b(`Invalid token specified: invalid json for part #${e+1} (${a.message})`)}}b.prototype.name="InvalidTokenError";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=function(){return(t=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function u(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}function v(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g}function x(a,b,c){if(c||2==arguments.length)for(var d,e=0,f=b.length;e<f;e++)!d&&e in b||(d||(d=Array.prototype.slice.call(b,0,e)),d[e]=b[e]);return a.concat(d||Array.prototype.slice.call(b))}(d=l||(l={})).Start="xstate.start",d.Stop="xstate.stop",d.Raise="xstate.raise",d.Send="xstate.send",d.Cancel="xstate.cancel",d.NullEvent="",d.Assign="xstate.assign",d.After="xstate.after",d.DoneState="done.state",d.DoneInvoke="done.invoke",d.Log="xstate.log",d.Init="xstate.init",d.Invoke="xstate.invoke",d.ErrorExecution="error.execution",d.ErrorCommunication="error.communication",d.ErrorPlatform="error.platform",d.ErrorCustom="xstate.error",d.Update="xstate.update",d.Pure="xstate.pure",d.Choose="xstate.choose",(e=m||(m={})).Parent="#_parent",e.Internal="#_internal";var y=l.Start,z=l.Stop,A=l.Raise,B=l.Send,C=l.Cancel,D=l.NullEvent,E=l.Assign,F=l.After,G=l.DoneState,H=l.Log,I=l.Init,J=l.Invoke,K=l.ErrorExecution,L=l.ErrorPlatform,M=l.ErrorCustom,N=l.Update,O=l.Choose,P=l.Pure;a.s(["after",()=>F,"assign",()=>E,"cancel",()=>C,"choose",()=>O,"doneState",()=>G,"error",()=>M,"errorExecution",()=>K,"errorPlatform",()=>L,"init",()=>I,"invoke",()=>J,"log",()=>H,"nullEvent",()=>D,"pure",()=>P,"raise",()=>A,"send",()=>B,"start",()=>y,"stop",()=>z,"update",()=>N],60371);var Q={},R="xstate.guard";function S(a,b,c){void 0===c&&(c=".");var d=V(a,c),e=V(b,c);return ah(e)?!!ah(d)&&e===d:ah(d)?d in e:Object.keys(d).every(function(a){return a in e&&S(d[a],e[a])})}function T(a){try{return ah(a)||"number"==typeof a?"".concat(a):a.type}catch(a){throw Error("Events must be strings or objects with a string event.type property.")}}function U(a,b){try{if(af(a))return a;return a.toString().split(b)}catch(b){throw Error("'".concat(a,"' is not a valid state path."))}}function V(a,b){return"object"==typeof a&&"value"in a&&"context"in a&&"event"in a&&"_event"in a?a.value:af(a)?W(a):"string"!=typeof a?a:W(U(a,b))}function W(a){if(1===a.length)return a[0];for(var b={},c=b,d=0;d<a.length-1;d++)d===a.length-2?c[a[d]]=a[d+1]:(c[a[d]]={},c=c[a[d]]);return b}function X(a,b){for(var c={},d=Object.keys(a),e=0;e<d.length;e++){var f=d[e];c[f]=b(a[f],f,a,e)}return c}function Y(a,b,c){var d,e,f={};try{for(var g=v(Object.keys(a)),h=g.next();!h.done;h=g.next()){var i=h.value,j=a[i];c(j)&&(f[i]=b(j,i,a))}}catch(a){d={error:a}}finally{try{h&&!h.done&&(e=g.return)&&e.call(g)}finally{if(d)throw d.error}}return f}var Z=function(a){return function(b){var c,d,e=b;try{for(var f=v(a),g=f.next();!g.done;g=f.next())e=e[g.value]}catch(a){c={error:a}}finally{try{g&&!g.done&&(d=f.return)&&d.call(f)}finally{if(c)throw c.error}}return e}};function $(a){return a?ah(a)?[[a]]:_(Object.keys(a).map(function(b){var c=a[b];return"string"==typeof c||c&&Object.keys(c).length?$(a[b]).map(function(a){return[b].concat(a)}):[[b]]})):[[]]}function _(a){var b;return(b=[]).concat.apply(b,x([],w(a),!1))}function aa(a){var b;return void 0===a?[]:af(b=a)?b:[b]}function ab(a,b,c){if(ag(a))return a(b,c.data);var d,e,f={};try{for(var g=v(Object.keys(a)),h=g.next();!h.done;h=g.next()){var i=h.value,j=a[i];ag(j)?f[i]=j(b,c.data):f[i]=j}}catch(a){d={error:a}}finally{try{h&&!h.done&&(e=g.return)&&e.call(g)}finally{if(d)throw d.error}}return f}function ac(a){return!!(a instanceof Promise||null!==a&&(ag(a)||"object"==typeof a)&&ag(a.then))}function ad(a,b,c,d){return a?c.reduce(function(a,c){var e,f,g=c.assignment,h={state:d,action:c,_event:b},i={};if(ag(g))i=g(a,b.data,h);else try{for(var j=v(Object.keys(g)),k=j.next();!k.done;k=j.next()){var l=k.value,m=g[l];i[l]=ag(m)?m(a,b.data,h):m}}catch(a){e={error:a}}finally{try{k&&!k.done&&(f=j.return)&&f.call(j)}finally{if(e)throw e.error}}return Object.assign({},a,i)},a):a}var ae=function(){};function af(a){return Array.isArray(a)}function ag(a){return"function"==typeof a}function ah(a){return"string"==typeof a}function ai(a,b){if(a)return ah(a)?{type:R,name:a,predicate:b?b[a]:void 0}:ag(a)?{type:R,name:a.name,predicate:a}:a}var aj="function"==typeof Symbol&&Symbol.observable||"@@observable";function ak(a){return!!a&&"__xstatenode"in a}(n={})[aj]=function(){return this},n[Symbol.observable]=function(){return this};var al=(f=0,function(){return f++,f.toString(16)});function am(a,b){return ah(a)||"number"==typeof a?t({type:a},b):a}function an(a,b){if(!ah(a)&&"$$type"in a&&"scxml"===a.$$type)return a;var c=am(a);return t({name:c.type,data:c,$$type:"scxml",type:"external"},b)}function ao(a,b){var c;return(af(c=b)?c:[c]).map(function(b){return void 0===b||"string"==typeof b||ak(b)?{target:b,event:a}:t(t({},b),{event:a})})}function ap(a,b,c,d,e){var f=a.options.guards,g={state:e,cond:b,_event:d};if(b.type===R)return((null==f?void 0:f[b.name])||b.predicate)(c,d.data,g);var h=null==f?void 0:f[b.type];if(!h)throw Error("Guard '".concat(b.type,"' is not implemented on machine '").concat(a.id,"'."));return h(c,d.data,g)}function aq(a){return"string"==typeof a?{type:a}:a}function ar(a,b,c){var d=function(){},e="object"==typeof a,f=e?a:null;return{next:((e?a.next:a)||d).bind(f),error:((e?a.error:b)||d).bind(f),complete:((e?a.complete:c)||d).bind(f)}}function as(a,b){return"".concat(a,":invocation[").concat(b,"]")}function at(a){return(a.type===A||a.type===B&&a.to===m.Internal)&&"number"!=typeof a.delay}var au=function(a){return"atomic"===a.type||"final"===a.type};function av(a){return Object.keys(a.states).map(function(b){return a.states[b]})}function aw(a){return av(a).filter(function(a){return"history"!==a.type})}function ax(a,b){var c,d,e,f,g,h,i,j,k=ay(new Set(a)),l=new Set(b);try{for(var m=v(l),n=m.next();!n.done;n=m.next())for(var o=n.value,p=o.parent;p&&!l.has(p);)l.add(p),p=p.parent}catch(a){c={error:a}}finally{try{n&&!n.done&&(d=m.return)&&d.call(m)}finally{if(c)throw c.error}}var q=ay(l);try{for(var r=v(l),s=r.next();!s.done;s=r.next()){var o=s.value;if("compound"!==o.type||q.get(o)&&q.get(o).length){if("parallel"===o.type)try{for(var t=(g=void 0,v(aw(o))),u=t.next();!u.done;u=t.next()){var w=u.value;l.has(w)||(l.add(w),k.get(w)?k.get(w).forEach(function(a){return l.add(a)}):w.initialStateNodes.forEach(function(a){return l.add(a)}))}}catch(a){g={error:a}}finally{try{u&&!u.done&&(h=t.return)&&h.call(t)}finally{if(g)throw g.error}}}else k.get(o)?k.get(o).forEach(function(a){return l.add(a)}):o.initialStateNodes.forEach(function(a){return l.add(a)})}}catch(a){e={error:a}}finally{try{s&&!s.done&&(f=r.return)&&f.call(r)}finally{if(e)throw e.error}}try{for(var x=v(l),y=x.next();!y.done;y=x.next())for(var o=y.value,p=o.parent;p&&!l.has(p);)l.add(p),p=p.parent}catch(a){i={error:a}}finally{try{y&&!y.done&&(j=x.return)&&j.call(x)}finally{if(i)throw i.error}}return l}function ay(a){var b,c,d=new Map;try{for(var e=v(a),f=e.next();!f.done;f=e.next()){var g=f.value;d.has(g)||d.set(g,[]),g.parent&&(d.has(g.parent)||d.set(g.parent,[]),d.get(g.parent).push(g))}}catch(a){b={error:a}}finally{try{f&&!f.done&&(c=e.return)&&c.call(e)}finally{if(b)throw b.error}}return d}function az(a,b){return Array.isArray(a)?a.some(function(a){return a===b}):a instanceof Set&&a.has(b)}function aA(a,b){return"compound"===b.type?aw(b).some(function(b){return"final"===b.type&&az(a,b)}):"parallel"===b.type&&aw(b).every(function(b){return aA(a,b)})}function aB(a){return new Set(_(a.map(function(a){return a.tags})))}var aC=a.i(60371),aD=an({type:I});function aE(a,b){return b&&b[a]||void 0}function aF(a,b){var c;if(ah(a)||"number"==typeof a){var d=aE(a,b);c=ag(d)?{type:a,exec:d}:d||{type:a,exec:void 0}}else if(ag(a))c={type:a.name||a.toString(),exec:a};else{var d=aE(a.type,b);if(ag(d))c=t(t({},a),{exec:d});else if(d){var e=d.type||a.type;c=t(t(t({},d),a),{type:e})}else c=a}return c}var aG=function(a,b){return a?(af(a)?a:[a]).map(function(a){return aF(a,b)}):[]};function aH(a){var b=aF(a);return t(t({id:ah(a)?a:b.id},b),{type:b.type})}function aI(a,b){return{type:A,event:"function"==typeof a?a:am(a),delay:b?b.delay:void 0,id:null==b?void 0:b.id}}function aJ(a,b,c,d){var e,f={_event:c},g=an(ag(a.event)?a.event(b,c.data,f):a.event);if(ah(a.delay)){var h=d&&d[a.delay];e=ag(h)?h(b,c.data,f):h}else e=ag(a.delay)?a.delay(b,c.data,f):a.delay;return t(t({},a),{type:A,_event:g,delay:e})}function aK(a,b){return{to:b?b.to:void 0,type:B,event:ag(a)?a:am(a),delay:b?b.delay:void 0,id:b&&void 0!==b.id?b.id:ag(a)?a.name:T(a)}}function aL(a,b,c,d){var e,f={_event:c},g=an(ag(a.event)?a.event(b,c.data,f):a.event);if(ah(a.delay)){var h=d&&d[a.delay];e=ag(h)?h(b,c.data,f):h}else e=ag(a.delay)?a.delay(b,c.data,f):a.delay;var i=ag(a.to)?a.to(b,c.data,f):a.to;return t(t({},a),{to:i,_event:g,event:g.data,delay:e})}function aM(a,b){return aK(a,t(t({},b),{to:m.Parent}))}function aN(a,b,c){return aK(b,t(t({},c),{to:a}))}function aO(){return aM(N)}function aP(a,b){return aK(a,t(t({},b),{to:function(a,b,c){return c._event.origin}}))}var aQ=function(a,b){return{context:a,event:b}};function aR(a,b){return void 0===a&&(a=aQ),{type:H,label:b,expr:a}}var aS=function(a,b,c){return t(t({},a),{value:ah(a.expr)?a.expr:a.expr(b,c.data,{_event:c})})},aT=function(a){return{type:C,sendId:a}};function aU(a){var b=aH(a);return{type:l.Start,activity:b,exec:void 0}}function aV(a){var b=ag(a)?a:aH(a);return{type:l.Stop,activity:b,exec:void 0}}function aW(a,b,c){var d=ag(a.activity)?a.activity(b,c.data):a.activity;return{type:l.Stop,activity:"string"==typeof d?{id:d}:d}}var aX=function(a){return{type:E,assignment:a}};function aY(a){return"object"==typeof a&&"type"in a}function aZ(a,b){return"".concat(l.After,"(").concat(a,")").concat(b?"#".concat(b):"")}function a$(a,b){var c="".concat(l.DoneState,".").concat(a),d={type:c,data:b};return d.toString=function(){return c},d}function a_(a,b){var c="".concat(l.DoneInvoke,".").concat(a),d={type:c,data:b};return d.toString=function(){return c},d}function a0(a,b){var c="".concat(l.ErrorPlatform,".").concat(a),d={type:c,data:b};return d.toString=function(){return c},d}function a1(a){return{type:l.Pure,get:a}}function a2(a,b){return aK(function(a,b){return b},t(t({},b),{to:a}))}function a3(a,b){return aM(function(b,c,d){return{type:M,data:ag(a)?a(b,c,d):a}},t(t({},b),{to:m.Parent}))}function a4(a){return{type:l.Choose,conds:a}}var a5=function(a){var b,c,d=[];try{for(var e=v(a),f=e.next();!f.done;f=e.next())for(var g=f.value,h=0;h<g.actions.length;){if(g.actions[h].type===E){d.push(g.actions[h]),g.actions.splice(h,1);continue}h++}}catch(a){b={error:a}}finally{try{f&&!f.done&&(c=e.return)&&c.call(e)}finally{if(b)throw b.error}}return d};function a6(a,b,c,d,e,f,g){void 0===g&&(g=!1);var h=g?[]:a5(e),i=h.length?ad(c,d,h,b):c,j=g?[c]:void 0,k=[];return[_(e.map(function(e){var h,l,n=[];try{for(var o=v(e.actions),p=o.next();!p.done;p=o.next()){var q=p.value,r=function(e,h){var l;switch(h.type){case A:var n=aJ(h,i,d,a.options.delays);return f&&"number"==typeof n.delay&&f(n,i,d),n;case B:var o=aL(h,i,d,a.options.delays);return f&&o.to!==m.Internal&&("entry"===e?k.push(o):f(o,i,d)),o;case H:var p=aS(h,i,d);return null==f||f(p,i,d),p;case O:var q=null==(l=h.conds.find(function(c){var e=ai(c.cond,a.options.guards);return!e||ap(a,e,i,d,f?void 0:b)}))?void 0:l.actions;if(!q)return[];var r=w(a6(a,b,i,d,[{type:e,actions:aG(aa(q),a.options.actions)}],f,g),2),s=r[0];return i=r[1],null==j||j.push(i),s;case P:var q=h.get(i,d.data);if(!q)return[];var u=w(a6(a,b,i,d,[{type:e,actions:aG(aa(q),a.options.actions)}],f,g),2),v=u[0];return i=u[1],null==j||j.push(i),v;case z:var p=aW(h,i,d);return null==f||f(p,c,d),p;case E:i=ad(i,d,[h],f?void 0:b),null==j||j.push(i);break;default:var y=aF(h,a.options.actions),C=y.exec;if(f)f(y,i,d);else if(C&&j){var D=j.length-1;y=t(t({},y),{exec:function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];C.apply(void 0,x([j[D]],w(b),!1))}})}return y}}(e.type,q);r&&(n=n.concat(r))}}catch(a){h={error:a}}finally{try{p&&!p.done&&(l=o.return)&&l.call(o)}finally{if(h)throw h.error}}return k.forEach(function(a){f(a,i,d)}),k.length=0,n})),i]}a.s(["after",()=>aZ,"assign",()=>aX,"cancel",()=>aT,"choose",()=>a4,"done",()=>a$,"doneInvoke",()=>a_,"error",()=>a0,"escalate",()=>a3,"forwardTo",()=>a2,"getActionFunction",()=>aE,"initEvent",()=>aD,"isActionObject",()=>aY,"log",()=>aR,"pure",()=>a1,"raise",()=>aI,"resolveActions",()=>a6,"resolveLog",()=>aS,"resolveRaise",()=>aJ,"resolveSend",()=>aL,"resolveStop",()=>aW,"respond",()=>aP,"send",()=>aK,"sendParent",()=>aM,"sendTo",()=>aN,"sendUpdate",()=>aO,"start",()=>aU,"stop",()=>aV,"toActionObject",()=>aF,"toActionObjects",()=>aG,"toActivityDefinition",()=>aH],93096);var a7=function(){function a(a){var b,c,d=this;this.actions=[],this.activities=Q,this.meta={},this.events=[],this.value=a.value,this.context=a.context,this._event=a._event,this._sessionid=a._sessionid,this.event=this._event.data,this.historyValue=a.historyValue,this.history=a.history,this.actions=a.actions||[],this.activities=a.activities||Q,this.meta=(void 0===(b=a.configuration)&&(b=[]),b.reduce(function(a,b){return void 0!==b.meta&&(a[b.id]=b.meta),a},{})),this.events=a.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=a.configuration,this.transitions=a.transitions,this.children=a.children,this.done=!!a.done,this.tags=null!=(c=Array.isArray(a.tags)?new Set(a.tags):a.tags)?c:new Set,this.machine=a.machine,Object.defineProperty(this,"nextEvents",{get:function(){return x([],w(new Set(_(x([],w(d.configuration.map(function(a){return a.ownEvents})),!1)))),!1)}})}return a.from=function(b,c){return b instanceof a?b.context!==c?new a({value:b.value,context:c,_event:b._event,_sessionid:null,historyValue:b.historyValue,history:b.history,actions:[],activities:b.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):b:new a({value:b,context:c,_event:aD,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},a.create=function(b){return new a(b)},a.inert=function(b,c){return b instanceof a?b.actions.length?new a({value:b.value,context:c,_event:aD,_sessionid:null,historyValue:b.historyValue,history:b.history,activities:b.activities,configuration:b.configuration,transitions:[],children:{}}):b:a.from(b,c)},a.prototype.toStrings=function(a,b){var c=this;if(void 0===a&&(a=this.value),void 0===b&&(b="."),ah(a))return[a];var d=Object.keys(a);return d.concat.apply(d,x([],w(d.map(function(d){return c.toStrings(a[d],b).map(function(a){return d+b+a})})),!1))},a.prototype.toJSON=function(){this.configuration,this.transitions;var a=this.tags;this.machine;var b=u(this,["configuration","transitions","tags","machine"]);return t(t({},b),{tags:Array.from(a)})},a.prototype.matches=function(a){return S(a,this.value)},a.prototype.hasTag=function(a){return this.tags.has(a)},a.prototype.can=function(a){ae(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var b,c=null==(b=this.machine)?void 0:b.getTransitionData(this,a);return!!(null==c?void 0:c.transitions.length)&&c.transitions.some(function(a){return void 0!==a.target||a.actions.length})},a}(),a8=[],a9=function(a,b){a8.push(a);var c=b(a);return a8.pop(),c};function ba(a){var b;return(b={id:a,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:a}}})[aj]=function(){return this},b}function bb(a,b,c){var d=ba(b);if(d.deferred=!0,ak(a)){var e=d.state=a9(void 0,function(){return(c?a.withContext(c):a).initialState});d.getSnapshot=function(){return e}}return d}function bc(a){return t(t({type:J},a),{toJSON:function(){a.onDone,a.onError;var b=u(a,["onDone","onError"]);return t(t({},b),{type:J,src:function(a){if("string"==typeof a){var b={type:a};return b.toString=function(){return a},b}return a}(a.src)})}})}var bd={},be=function(a){return"#"===a[0]},bf=function(){function a(b,c,d,e){void 0===d&&(d="context"in b?b.context:void 0);var f,g=this;this.config=b,this._context=d,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},c),this.parent=null==e?void 0:e.parent,this.key=this.config.key||(null==e?void 0:e.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||x([this.machine.key],w(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!=(f=this.config.schema)?f:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?X(this.config.states,function(b,c){var d,e=new a(b,{},void 0,{parent:g,key:c});return Object.assign(g.idMap,t(((d={})[e.id]=e,d),e.idMap)),e}):bd;var h=0;!function a(b){var c,d;b.order=h++;try{for(var e=v(av(b)),f=e.next();!f.done;f=e.next()){var g=f.value;a(g)}}catch(a){c={error:a}}finally{try{f&&!f.done&&(d=e.return)&&d.call(e)}finally{if(c)throw c.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some(function(a){return""===a.event}):""in this.config.on),this.strict=!!this.config.strict,this.onEntry=aa(this.config.entry||this.config.onEntry).map(function(a){return aF(a)}),this.onExit=aa(this.config.exit||this.config.onExit).map(function(a){return aF(a)}),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=aa(this.config.invoke).map(function(a,b){if(ak(a)){var c,d,e=as(g.id,b);return g.machine.options.services=t(((c={})[e]=a,c),g.machine.options.services),bc({src:e,id:e})}if(ah(a.src)){var e=a.id||as(g.id,b);return bc(t(t({},a),{id:e,src:a.src}))}if(ak(a.src)||ag(a.src)){var e=a.id||as(g.id,b);return g.machine.options.services=t(((d={})[e]=a.src,d),g.machine.options.services),bc(t(t({id:e},a),{src:e}))}var f=a.src;return bc(t(t({id:as(g.id,b)},a),{src:f}))}),this.activities=aa(this.config.activities).concat(this.invoke).map(function(a){return aH(a)}),this.transition=this.transition.bind(this),this.tags=aa(this.config.tags)}return a.prototype._init=function(){this.__cache.transitions||(function a(b){var c=[b];return au(b)?c:c.concat(_(aw(b).map(a)))})(this).forEach(function(a){return a.on})},a.prototype.withConfig=function(b,c){var d=this.options,e=d.actions,f=d.activities,g=d.guards,h=d.services,i=d.delays;return new a(this.config,{actions:t(t({},e),b.actions),activities:t(t({},f),b.activities),guards:t(t({},g),b.guards),services:t(t({},h),b.services),delays:t(t({},i),b.delays)},null!=c?c:this.context)},a.prototype.withContext=function(b){return new a(this.config,this.options,b)},Object.defineProperty(a.prototype,"context",{get:function(){return ag(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:X(this.states,function(a){return a.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),a.prototype.toJSON=function(){return this.definition},Object.defineProperty(a.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var a=this.transitions;return this.__cache.on=a.reduce(function(a,b){return a[b.eventType]=a[b.eventType]||[],a[b.eventType].push(b),a},{})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),a.prototype.getCandidates=function(a){if(this.__cache.candidates[a])return this.__cache.candidates[a];var b=""===a,c=this.transitions.filter(function(c){var d=c.eventType===a;return b?d:d||"*"===c.eventType});return this.__cache.candidates[a]=c,c},a.prototype.getDelayedTransitions=function(){var a=this,b=this.config.after;if(!b)return[];var c=function(b,c){var d=aZ(ag(b)?"".concat(a.id,":delay[").concat(c,"]"):b,a.id);return a.onEntry.push(aK(d,{delay:b})),a.onExit.push(aT(d)),d};return(af(b)?b.map(function(a,b){var d=c(a.delay,b);return t(t({},a),{event:d})}):_(Object.keys(b).map(function(a,d){var e=b[a],f=ah(e)?{target:e}:e,g=isNaN(+a)?a:+a,h=c(g,d);return aa(f).map(function(a){return t(t({},a),{event:h,delay:g})})}))).map(function(b){var c=b.delay;return t(t({},a.formatTransition(b)),{delay:c})})},a.prototype.getStateNodes=function(a){var b,c=this;if(!a)return[];var d=a instanceof a7?a.value:V(a,this.delimiter);if(ah(d)){var e=this.getStateNode(d).initial;return void 0!==e?this.getStateNodes(((b={})[d]=e,b)):[this,this.states[d]]}var f=Object.keys(d),g=[this];return g.push.apply(g,x([],w(_(f.map(function(a){return c.getStateNode(a).getStateNodes(d[a])}))),!1)),g},a.prototype.handles=function(a){var b=T(a);return this.events.includes(b)},a.prototype.resolveState=function(a){var b=a instanceof a7?a:a7.create(a),c=Array.from(ax([],this.getStateNodes(b.value)));return new a7(t(t({},b),{value:this.resolve(b.value),configuration:c,done:aA(c,this),tags:aB(c),machine:this.machine}))},a.prototype.transitionLeafNode=function(a,b,c){var d=this.getStateNode(a).next(b,c);return d&&d.transitions.length?d:this.next(b,c)},a.prototype.transitionCompoundNode=function(a,b,c){var d=Object.keys(a),e=this.getStateNode(d[0])._transition(a[d[0]],b,c);return e&&e.transitions.length?e:this.next(b,c)},a.prototype.transitionParallelNode=function(a,b,c){var d,e,f={};try{for(var g=v(Object.keys(a)),h=g.next();!h.done;h=g.next()){var i=h.value,j=a[i];if(j){var k=this.getStateNode(i)._transition(j,b,c);k&&(f[i]=k)}}}catch(a){d={error:a}}finally{try{h&&!h.done&&(e=g.return)&&e.call(g)}finally{if(d)throw d.error}}var l=Object.keys(f).map(function(a){return f[a]}),m=_(l.map(function(a){return a.transitions}));if(!l.some(function(a){return a.transitions.length>0}))return this.next(b,c);var n=_(Object.keys(f).map(function(a){return f[a].configuration}));return{transitions:m,exitSet:_(l.map(function(a){return a.exitSet})),configuration:n,source:b,actions:_(Object.keys(f).map(function(a){return f[a].actions}))}},a.prototype._transition=function(a,b,c){return ah(a)?this.transitionLeafNode(a,b,c):1===Object.keys(a).length?this.transitionCompoundNode(a,b,c):this.transitionParallelNode(a,b,c)},a.prototype.getTransitionData=function(a,b){return this._transition(a.value,a,an(b))},a.prototype.next=function(a,b){var c,d,e,f=this,g=b.name,h=[],i=[];try{for(var j=v(this.getCandidates(g)),k=j.next();!k.done;k=j.next()){var l=k.value,m=l.cond,n=l.in,o=a.context,p=!n||(ah(n)&&be(n)?a.matches(V(this.getStateNodeById(n).path,this.delimiter)):S(V(n,this.delimiter),Z(this.path.slice(0,-2))(a.value))),q=!1;try{q=!m||ap(this.machine,m,o,b,a)}catch(a){throw Error("Unable to evaluate guard '".concat(m.name||m.type,"' in transition for event '").concat(g,"' in state node '").concat(this.id,"':\n").concat(a.message))}if(q&&p){void 0!==l.target&&(i=l.target),h.push.apply(h,x([],w(l.actions),!1)),e=l;break}}}catch(a){c={error:a}}finally{try{k&&!k.done&&(d=j.return)&&d.call(j)}finally{if(c)throw c.error}}if(e){if(!i.length)return{transitions:[e],exitSet:[],configuration:a.value?[this]:[],source:a,actions:h};var r=_(i.map(function(b){return f.getRelativeStateNodes(b,a.historyValue)})),s=!!e.internal;return{transitions:[e],exitSet:s?[]:_(i.map(function(a){return f.getPotentiallyReenteringNodes(a)})),configuration:r,source:a,actions:h}}},a.prototype.getPotentiallyReenteringNodes=function(a){if(this.order<a.order)return[this];for(var b=[],c=this;c&&c!==a;)b.push(c),c=c.parent;return c!==a?[]:(b.push(a),b)},a.prototype.getActions=function(a,b,c,d,e,f,g){var h,i,j,k,l=this,m=f?ax([],this.getStateNodes(f.value)):[],n=new Set;try{for(var o=v(Array.from(a).sort(function(a,b){return a.order-b.order})),p=o.next();!p.done;p=o.next()){var q=p.value;(!az(m,q)||az(c.exitSet,q)||q.parent&&n.has(q.parent))&&n.add(q)}}catch(a){h={error:a}}finally{try{p&&!p.done&&(i=o.return)&&i.call(o)}finally{if(h)throw h.error}}try{for(var r=v(m),s=r.next();!s.done;s=r.next()){var q=s.value;(!az(a,q)||az(c.exitSet,q.parent))&&c.exitSet.push(q)}}catch(a){j={error:a}}finally{try{s&&!s.done&&(k=r.return)&&k.call(r)}finally{if(j)throw j.error}}c.exitSet.sort(function(a,b){return b.order-a.order});var t=Array.from(n).sort(function(a,b){return a.order-b.order}),u=new Set(c.exitSet),y=_(t.map(function(a){var b=[];if("final"!==a.type)return b;var f=a.parent;if(!f.parent)return b;b.push(a$(a.id,a.doneData),a$(f.id,a.doneData?ab(a.doneData,d,e):void 0));var g=f.parent;return"parallel"===g.type&&aw(g).every(function(a){return aA(c.configuration,a)})&&b.push(a$(g.id)),b})),z=t.map(function(a){var b=a.onEntry,c=a.activities.map(function(a){return aU(a)});return{type:"entry",actions:aG(g?x(x([],w(b),!1),w(c),!1):x(x([],w(c),!1),w(b),!1),l.machine.options.actions)}}).concat({type:"state_done",actions:y.map(function(a){return aI(a)})}),A=Array.from(u).map(function(a){return{type:"exit",actions:aG(x(x([],w(a.onExit),!1),w(a.activities.map(function(a){return aV(a)})),!1),l.machine.options.actions)}}).concat({type:"transition",actions:aG(c.actions,this.machine.options.actions)}).concat(z);if(b){var B=aG(_(x([],w(a),!1).sort(function(a,b){return b.order-a.order}).map(function(a){return a.onExit})),this.machine.options.actions).filter(function(a){return!at(a)});return A.concat({type:"stop",actions:B})}return A},a.prototype.transition=function(a,b,c,d){void 0===a&&(a=this.initialState);var e,f,g=an(b);if(a instanceof a7)f=void 0===c?a:this.resolveState(a7.from(a,c));else{var h=ah(a)?this.resolve(W(this.getResolvedPath(a))):this.resolve(a),i=null!=c?c:this.machine.context;f=this.resolveState(a7.from(h,i))}if(this.strict&&!this.events.includes(g.name)&&(e=g.name,!/^(done|error)\./.test(e)))throw Error("Machine '".concat(this.id,"' does not accept event '").concat(g.name,"'"));var j=this._transition(f.value,f,g)||{transitions:[],configuration:[],exitSet:[],source:f,actions:[]},k=ax([],this.getStateNodes(f.value)),l=j.configuration.length?ax(k,j.configuration):k;return j.configuration=x([],w(l),!1),this.resolveTransition(j,f,f.context,d,g)},a.prototype.resolveRaisedTransition=function(a,b,c,d){var e,f=a.actions;return(a=this.transition(a,b,void 0,d))._event=c,a.event=c.data,(e=a.actions).unshift.apply(e,x([],w(f),!1)),a},a.prototype.resolveTransition=function(a,b,c,d,e){var f,g,h,i,j,k,l=this;void 0===e&&(e=aD);var m=a.configuration,n=!b||a.transitions.length>0,o=n?a.configuration:b?b.configuration:[],p=aA(o,this),q=n?(g=ax([f=this.machine],m),function a(b,c){var d=c.get(b);if(!d)return{};if("compound"===b.type){var e=d[0];if(!e)return{};if(au(e))return e.key}var f={};return d.forEach(function(b){f[b.key]=a(b,c)}),f}(f,ay(g))):void 0,r=b?b.historyValue?b.historyValue:a.source?this.machine.historyValue(b.value):void 0:void 0,s=this.getActions(new Set(o),p,a,c,e,b,d),u=b?t({},b.activities):{};try{for(var x=v(s),A=x.next();!A.done;A=x.next()){var B=A.value;try{for(var C=(j=void 0,v(B.actions)),E=C.next();!E.done;E=C.next()){var F=E.value;F.type===y?u[F.activity.id||F.activity.type]=F:F.type===z&&(u[F.activity.id||F.activity.type]=!1)}}catch(a){j={error:a}}finally{try{E&&!E.done&&(k=C.return)&&k.call(C)}finally{if(j)throw j.error}}}}catch(a){h={error:a}}finally{try{A&&!A.done&&(i=x.return)&&i.call(x)}finally{if(h)throw h.error}}var G=w(a6(this,b,c,e,s,d,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),H=G[0],I=G[1],K=w(function(a,b){var c,d,e=w([[],[]],2),f=e[0],g=e[1];try{for(var h=v(a),i=h.next();!i.done;i=h.next()){var j=i.value;b(j)?f.push(j):g.push(j)}}catch(a){c={error:a}}finally{try{i&&!i.done&&(d=h.return)&&d.call(h)}finally{if(c)throw c.error}}return[f,g]}(H,at),2),L=K[0],M=K[1],O=H.filter(function(a){var b;return a.type===y&&(null==(b=a.activity)?void 0:b.type)===J}).reduce(function(a,b){var c,d,f,g,h,i,j,k;return a[b.activity.id]=(c=b.activity,d=l.machine,f=e,h=aq(c.src),i=null==(g=null==d?void 0:d.options.services)?void 0:g[h.type],j=c.data?ab(c.data,I,f):void 0,(k=i?bb(i,c.id,j):ba(c.id)).meta=c,k),a},b?t({},b.children):{}),P=new a7({value:q||b.value,context:I,_event:e,_sessionid:b?b._sessionid:null,historyValue:q?r?{current:q,states:function a(b,c){return X(b.states,function(b,d){if(b){var e=(ah(c)?void 0:c[d])||(b?b.current:void 0);if(e)return{current:e,states:a(b,e)}}})}(r,q)}:void 0:b?b.historyValue:void 0,history:!q||a.source?b:void 0,actions:q?M:[],activities:q?u:b?b.activities:{},events:[],configuration:o,transitions:a.transitions,children:O,done:p,tags:aB(o),machine:this}),Q=c!==I;P.changed=e.name===N||Q;var R=P.history;R&&delete R.history;var S=!p&&(this._transient||m.some(function(a){return a._transient}));if(!n&&(!S||""===e.name))return P;var T=P;if(!p)for(S&&(T=this.resolveRaisedTransition(T,{type:D},e,d));L.length;){var U=L.shift();T=this.resolveRaisedTransition(T,U._event,e,d)}var V=T.changed||(R?!!T.actions.length||Q||typeof R.value!=typeof T.value||!function a(b,c){if(b===c)return!0;if(void 0===b||void 0===c)return!1;if(ah(b)||ah(c))return b===c;var d=Object.keys(b),e=Object.keys(c);return d.length===e.length&&d.every(function(d){return a(b[d],c[d])})}(T.value,R.value):void 0);return T.changed=V,T.history=R,T},a.prototype.getStateNode=function(a){if(be(a))return this.machine.getStateNodeById(a);if(!this.states)throw Error("Unable to retrieve child state '".concat(a,"' from '").concat(this.id,"'; no child states exist."));var b=this.states[a];if(!b)throw Error("Child state '".concat(a,"' does not exist on '").concat(this.id,"'"));return b},a.prototype.getStateNodeById=function(a){var b=be(a)?a.slice(1):a;if(b===this.id)return this;var c=this.machine.idMap[b];if(!c)throw Error("Child state node '#".concat(b,"' does not exist on machine '").concat(this.id,"'"));return c},a.prototype.getStateNodeByPath=function(a){if("string"==typeof a&&be(a))try{return this.getStateNodeById(a.slice(1))}catch(a){}for(var b=U(a,this.delimiter).slice(),c=this;b.length;){var d=b.shift();if(!d.length)break;c=c.getStateNode(d)}return c},a.prototype.resolve=function(a){var b,c=this;if(!a)return this.initialStateValue||bd;switch(this.type){case"parallel":return X(this.initialStateValue,function(b,d){return b?c.getStateNode(d).resolve(a[d]||b):bd});case"compound":if(ah(a)){var d=this.getStateNode(a);if("parallel"===d.type||"compound"===d.type)return(b={})[a]=d.initialStateValue,b;return a}if(!Object.keys(a).length)return this.initialStateValue||{};return X(a,function(a,b){return a?c.getStateNode(b).resolve(a):bd});default:return a||bd}},a.prototype.getResolvedPath=function(a){if(be(a)){var b=this.machine.idMap[a.slice(1)];if(!b)throw Error("Unable to find state node '".concat(a,"'"));return b.path}return U(a,this.delimiter)},Object.defineProperty(a.prototype,"initialStateValue",{get:function(){var a,b;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)b=Y(this.states,function(a){return a.initialStateValue||bd},function(a){return"history"!==a.type});else if(void 0!==this.initial){if(!this.states[this.initial])throw Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));b=au(this.states[this.initial])?this.initial:((a={})[this.initial]=this.states[this.initial].initialStateValue,a)}else b={};return this.__cache.initialStateValue=b,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),a.prototype.getInitialState=function(a,b){this._init();var c=this.getStateNodes(a);return this.resolveTransition({configuration:c,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=b?b:this.machine.context,void 0)},Object.defineProperty(a.prototype,"initialState",{get:function(){var a=this.initialStateValue;if(!a)throw Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(a)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"target",{get:function(){var a;if("history"===this.type){var b=this.config;a=ah(b.target)&&be(b.target)?W(this.machine.getStateNodeById(b.target).path.slice(this.path.length-1)):b.target}return a},enumerable:!1,configurable:!0}),a.prototype.getRelativeStateNodes=function(a,b,c){return void 0===c&&(c=!0),c?"history"===a.type?a.resolveHistory(b):a.initialStateNodes:[a]},Object.defineProperty(a.prototype,"initialStateNodes",{get:function(){var a=this;return au(this)?[this]:"compound"!==this.type||this.initial?_($(this.initialStateValue).map(function(b){return a.getFromRelativePath(b)})):[this]},enumerable:!1,configurable:!0}),a.prototype.getFromRelativePath=function(a){if(!a.length)return[this];var b=w(a),c=b[0],d=b.slice(1);if(!this.states)throw Error("Cannot retrieve subPath '".concat(c,"' from node with no states"));var e=this.getStateNode(c);if("history"===e.type)return e.resolveHistory();if(!this.states[c])throw Error("Child state '".concat(c,"' does not exist on '").concat(this.id,"'"));return this.states[c].getFromRelativePath(d)},a.prototype.historyValue=function(a){if(Object.keys(this.states).length)return{current:a||this.initialStateValue,states:Y(this.states,function(b,c){if(!a)return b.historyValue();var d=ah(a)?void 0:a[c];return b.historyValue(d||b.initialStateValue)},function(a){return!a.history})}},a.prototype.resolveHistory=function(a){var b,c=this;if("history"!==this.type)return[this];var d=this.parent;if(!a){var e=this.target;return e?_($(e).map(function(a){return d.getFromRelativePath(a)})):d.initialStateNodes}var f=(b=d.path,function(a){var c,d,e=a;try{for(var f=v(b),g=f.next();!g.done;g=f.next()){var h=g.value;e=e.states[h]}}catch(a){c={error:a}}finally{try{g&&!g.done&&(d=f.return)&&d.call(f)}finally{if(c)throw c.error}}return e})(a).current;return ah(f)?[d.getStateNode(f)]:_($(f).map(function(a){return"deep"===c.history?d.getFromRelativePath(a):[d.states[a[0]]]}))},Object.defineProperty(a.prototype,"stateIds",{get:function(){var a=this,b=_(Object.keys(this.states).map(function(b){return a.states[b].stateIds}));return[this.id].concat(b)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"events",{get:function(){if(this.__cache.events)return this.__cache.events;var a,b,c,d,e=this.states,f=new Set(this.ownEvents);if(e)try{for(var g=v(Object.keys(e)),h=g.next();!h.done;h=g.next()){var i=e[h.value];if(i.states)try{for(var j=(c=void 0,v(i.events)),k=j.next();!k.done;k=j.next()){var l=k.value;f.add("".concat(l))}}catch(a){c={error:a}}finally{try{k&&!k.done&&(d=j.return)&&d.call(j)}finally{if(c)throw c.error}}}}catch(b){a={error:b}}finally{try{h&&!h.done&&(b=g.return)&&b.call(g)}finally{if(a)throw a.error}}return this.__cache.events=Array.from(f)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"ownEvents",{get:function(){return Array.from(new Set(this.transitions.filter(function(a){return!(!a.target&&!a.actions.length&&a.internal)}).map(function(a){return a.eventType})))},enumerable:!1,configurable:!0}),a.prototype.resolveTarget=function(a){var b=this;if(void 0!==a)return a.map(function(a){if(!ah(a))return a;var c=a[0]===b.delimiter;if(c&&!b.parent)return b.getStateNodeByPath(a.slice(1));var d=c?b.key+a:a;if(!b.parent)return b.getStateNodeByPath(d);try{return b.parent.getStateNodeByPath(d)}catch(a){throw Error("Invalid transition definition for state node '".concat(b.id,"':\n").concat(a.message))}})},a.prototype.formatTransition=function(a){var b=this,c=function(a){if(void 0!==a&&""!==a)return aa(a)}(a.target),d="internal"in a?a.internal:!c||c.some(function(a){return ah(a)&&a[0]===b.delimiter}),e=this.machine.options.guards,f=this.resolveTarget(c),g=t(t({},a),{actions:aG(aa(a.actions)),cond:ai(a.cond,e),target:f,source:this,internal:d,eventType:a.event,toJSON:function(){return t(t({},g),{target:g.target?g.target.map(function(a){return"#".concat(a.id)}):void 0,source:"#".concat(b.id)})}});return g},a.prototype.formatTransitions=function(){var a,b,c,d=this;if(this.config.on)if(Array.isArray(this.config.on))c=this.config.on;else{var e=this.config.on,f=e["*"],g=u(e,["*"]);c=_(Object.keys(g).map(function(a){return ao(a,g[a])}).concat(ao("*",void 0===f?[]:f)))}else c=[];var h=this.config.always?ao("",this.config.always):[],i=this.config.onDone?ao(String(a$(this.id)),this.config.onDone):[],j=_(this.invoke.map(function(a){var b=[];return a.onDone&&b.push.apply(b,x([],w(ao(String(a_(a.id)),a.onDone)),!1)),a.onError&&b.push.apply(b,x([],w(ao(String(a0(a.id)),a.onError)),!1)),b})),k=this.after,l=_(x(x(x(x([],w(i),!1),w(j),!1),w(c),!1),w(h),!1).map(function(a){return aa(a).map(function(a){return d.formatTransition(a)})}));try{for(var m=v(k),n=m.next();!n.done;n=m.next()){var o=n.value;l.push(o)}}catch(b){a={error:b}}finally{try{n&&!n.done&&(b=m.return)&&b.call(m)}finally{if(a)throw a.error}}return l},a}();function bg(a,b){return new bf(a,b)}a.i(93096),a.s(["actionTypes",0,aC,"after",()=>aZ,"assign",()=>aX,"cancel",()=>aT,"choose",()=>a4,"done",()=>a$,"doneInvoke",()=>a_,"error",()=>a0,"escalate",()=>a3,"forwardTo",()=>a2,"getActionFunction",()=>aE,"initEvent",()=>aD,"isActionObject",()=>aY,"log",()=>aR,"pure",()=>a1,"raise",()=>aI,"resolveActions",()=>a6,"resolveLog",()=>aS,"resolveRaise",()=>aJ,"resolveSend",()=>aL,"resolveStop",()=>aW,"respond",()=>aP,"send",()=>aK,"sendParent",()=>aM,"sendTo",()=>aN,"sendUpdate",()=>aO,"start",()=>aU,"stop",()=>aV,"toActionObject",()=>aF,"toActionObjects",()=>aG,"toActivityDefinition",()=>aH],77133);var bh=a.i(77133),bi={deferEvents:!1},bj=function(){function a(a){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=t(t({},bi),a)}return a.prototype.initialize=function(a){if(this.initialized=!0,a){if(!this.options.deferEvents)return void this.schedule(a);this.process(a)}this.flushEvents()},a.prototype.schedule=function(a){if(!this.initialized||this.processingEvent)return void this.queue.push(a);if(0!==this.queue.length)throw Error("Event queue should be empty when it is not processing events");this.process(a),this.flushEvents()},a.prototype.clear=function(){this.queue=[]},a.prototype.flushEvents=function(){for(var a=this.queue.shift();a;)this.process(a),a=this.queue.shift()},a.prototype.process=function(a){this.processingEvent=!0;try{a()}catch(a){throw this.clear(),a}finally{this.processingEvent=!1}},a}(),bk=new Map,bl=0,bm=function(a){bk.delete(a)};function bn(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:a.g}var bo={sync:!1,autoForward:!1};(g=o||(o={}))[g.NotStarted=0]="NotStarted",g[g.Running=1]="Running",g[g.Stopped=2]="Stopped";var bp=function(){function a(b,c){void 0===c&&(c=a.defaultOptions);var d=this;this.machine=b,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=o.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(a,b){if(af(a))return d.batch(a),d.state;var c=an(am(a,b));if(d.status===o.Stopped)return d.state;if(d.status!==o.Running&&!d.options.deferEvents)throw Error('Event "'.concat(c.name,'" was sent to uninitialized service "').concat(d.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(c.data)));return d.scheduler.schedule(function(){d.forward(c);var a=d._nextState(c);d.update(a,c)}),d._state},this.sendTo=function(a,b,c){var e,f=d.parent&&(b===m.Parent||d.parent.id===b),g=f?d.parent:ah(b)?b===m.Internal?d:d.children.get(b)||(e=b,bk.get(e)):b&&"function"==typeof b.send?b:void 0;if(!g){if(!f)throw Error("Unable to send event to child '".concat(b,"' from service '").concat(d.id,"'."));return}if("machine"in g){if(d.status!==o.Stopped||d.parent!==g||d.state.done){var h=t(t({},a),{name:a.name===M?"".concat(a0(d.id)):a.name,origin:d.sessionId});!c&&d.machine.config.predictableActionArguments?d._outgoingQueue.push([g,h]):g.send(h)}}else!c&&d.machine.config.predictableActionArguments?d._outgoingQueue.push([g,a.data]):g.send(a.data)},this._exec=function(a,b,c,e){void 0===e&&(e=d.machine.options.actions);var f=a.exec||aE(a.type,e),g=ag(f)?f:f?f.exec:a.exec;if(g)try{return g(b,c.data,d.machine.config.predictableActionArguments?{action:a,_event:c}:{action:a,state:d.state,_event:c})}catch(a){throw d.parent&&d.parent.send({type:"xstate.error",data:a}),a}switch(a.type){case A:d.defer(a);break;case B:if("number"==typeof a.delay)return void d.defer(a);a.to?d.sendTo(a._event,a.to,c===aD):d.send(a._event);break;case C:d.cancel(a.sendId);break;case y:if(d.status!==o.Running)return;var h=a.activity;if(!d.machine.config.predictableActionArguments&&!d.state.activities[h.id||h.type])break;if(h.type===l.Invoke){var i=aq(h.src),j=d.machine.options.services?d.machine.options.services[i.type]:void 0,k=h.id,m=h.data,n="autoForward"in h?h.autoForward:!!h.forward;if(!j)return;var p=m?ab(m,b,c):void 0;if("string"==typeof j)return;var q=ag(j)?j(b,c.data,{data:p,src:i,meta:h.meta}):j;if(!q)return;var r=void 0;ak(q)&&(q=p?q.withContext(p):q,r={autoForward:n}),d.spawn(q,k,r)}else d.spawnActivity(h);break;case z:d.stopChild(a.activity.id);break;case H:var s=a.label,t=a.value;s?d.logger(s,t):d.logger(t)}};var e=t(t({},a.defaultOptions),c),f=e.clock,g=e.logger,h=e.parent,i=e.id,j=void 0!==i?i:b.id;this.id=j,this.logger=g,this.clock=f,this.parent=h,this.options=e,this.scheduler=new bj({deferEvents:this.options.deferEvents}),this.sessionId="x:".concat(bl++)}return Object.defineProperty(a.prototype,"initialState",{get:function(){var a=this;return this._initialState?this._initialState:a9(this,function(){return a._initialState=a.machine.initialState,a._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),a.prototype.execute=function(a,b){var c,d;try{for(var e=v(a.actions),f=e.next();!f.done;f=e.next()){var g=f.value;this.exec(g,a,b)}}catch(a){c={error:a}}finally{try{f&&!f.done&&(d=e.return)&&d.call(e)}finally{if(c)throw c.error}}},a.prototype.update=function(a,b){var c,d,e,f,g,h,i,j,k=this;if(a._sessionid=this.sessionId,this._state=a,(!this.machine.config.predictableActionArguments||b===aD)&&this.options.execute)this.execute(this.state);else for(var l=void 0;l=this._outgoingQueue.shift();)l[0].send(l[1]);if(this.children.forEach(function(a){k.state.children[a.id]=a}),this.devTools&&this.devTools.send(b.data,a),a.event)try{for(var m=v(this.eventListeners),n=m.next();!n.done;n=m.next()){var o=n.value;o(a.event)}}catch(a){c={error:a}}finally{try{n&&!n.done&&(d=m.return)&&d.call(m)}finally{if(c)throw c.error}}try{for(var p=v(this.listeners),q=p.next();!q.done;q=p.next()){var o=q.value;o(a,a.event)}}catch(a){e={error:a}}finally{try{q&&!q.done&&(f=p.return)&&f.call(p)}finally{if(e)throw e.error}}try{for(var r=v(this.contextListeners),s=r.next();!s.done;s=r.next())(0,s.value)(this.state.context,this.state.history?this.state.history.context:void 0)}catch(a){g={error:a}}finally{try{s&&!s.done&&(h=r.return)&&h.call(r)}finally{if(g)throw g.error}}if(this.state.done){var t=a.configuration.find(function(a){return"final"===a.type&&a.parent===k.machine}),u=t&&t.doneData?ab(t.doneData,a.context,b):void 0;this._doneEvent=a_(this.id,u);try{for(var w=v(this.doneListeners),x=w.next();!x.done;x=w.next()){var o=x.value;o(this._doneEvent)}}catch(a){i={error:a}}finally{try{x&&!x.done&&(j=w.return)&&j.call(w)}finally{if(i)throw i.error}}this._stop(),this._stopChildren(),bm(this.sessionId)}},a.prototype.onTransition=function(a){return this.listeners.add(a),this.status===o.Running&&a(this.state,this.state.event),this},a.prototype.subscribe=function(a,b,c){var d=this,e=ar(a,b,c);this.listeners.add(e.next),this.status!==o.NotStarted&&e.next(this.state);var f=function(){d.doneListeners.delete(f),d.stopListeners.delete(f),e.complete()};return this.status===o.Stopped?e.complete():(this.onDone(f),this.onStop(f)),{unsubscribe:function(){d.listeners.delete(e.next),d.doneListeners.delete(f),d.stopListeners.delete(f)}}},a.prototype.onEvent=function(a){return this.eventListeners.add(a),this},a.prototype.onSend=function(a){return this.sendListeners.add(a),this},a.prototype.onChange=function(a){return this.contextListeners.add(a),this},a.prototype.onStop=function(a){return this.stopListeners.add(a),this},a.prototype.onDone=function(a){return this.status===o.Stopped&&this._doneEvent?a(this._doneEvent):this.doneListeners.add(a),this},a.prototype.off=function(a){return this.listeners.delete(a),this.eventListeners.delete(a),this.sendListeners.delete(a),this.stopListeners.delete(a),this.doneListeners.delete(a),this.contextListeners.delete(a),this},a.prototype.start=function(a){var b,c,d=this;if(this.status===o.Running)return this;this.machine._init(),b=this.sessionId,c=this,bk.set(b,c),this.initialized=!0,this.status=o.Running;var e=void 0===a?this.initialState:a9(this,function(){return"object"==typeof a&&null!==a&&"value"in a&&"_event"in a?d.machine.resolveState(a):d.machine.resolveState(a7.from(a,d.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){d.update(e,aD)}),this},a.prototype._stopChildren=function(){this.children.forEach(function(a){ag(a.stop)&&a.stop()}),this.children.clear()},a.prototype._stop=function(){var a,b,c,d,e,f,g,h,i,j;try{for(var k=v(this.listeners),l=k.next();!l.done;l=k.next()){var m=l.value;this.listeners.delete(m)}}catch(b){a={error:b}}finally{try{l&&!l.done&&(b=k.return)&&b.call(k)}finally{if(a)throw a.error}}try{for(var n=v(this.stopListeners),p=n.next();!p.done;p=n.next()){var m=p.value;m(),this.stopListeners.delete(m)}}catch(a){c={error:a}}finally{try{p&&!p.done&&(d=n.return)&&d.call(n)}finally{if(c)throw c.error}}try{for(var q=v(this.contextListeners),r=q.next();!r.done;r=q.next()){var m=r.value;this.contextListeners.delete(m)}}catch(a){e={error:a}}finally{try{r&&!r.done&&(f=q.return)&&f.call(q)}finally{if(e)throw e.error}}try{for(var s=v(this.doneListeners),t=s.next();!t.done;t=s.next()){var m=t.value;this.doneListeners.delete(m)}}catch(a){g={error:a}}finally{try{t&&!t.done&&(h=s.return)&&h.call(s)}finally{if(g)throw g.error}}if(!this.initialized)return this;this.initialized=!1,this.status=o.Stopped,this._initialState=void 0;try{for(var u=v(Object.keys(this.delayedEventsMap)),w=u.next();!w.done;w=u.next()){var x=w.value;this.clock.clearTimeout(this.delayedEventsMap[x])}}catch(a){i={error:a}}finally{try{w&&!w.done&&(j=u.return)&&j.call(u)}finally{if(i)throw i.error}}this.scheduler.clear(),this.scheduler=new bj({deferEvents:this.options.deferEvents})},a.prototype.stop=function(){var a=this,b=this.scheduler;return this._stop(),b.schedule(function(){if(null==(b=a._state)||!b.done){var b,c=an({type:"xstate.stop"}),d=a9(a,function(){var b=_(x([],w(a.state.configuration),!1).sort(function(a,b){return b.order-a.order}).map(function(b){return aG(b.onExit,a.machine.options.actions)})),d=w(a6(a.machine,a.state,a.state.context,c,[{type:"exit",actions:b}],a.machine.config.predictableActionArguments?a._exec:void 0,a.machine.config.predictableActionArguments||a.machine.config.preserveActionOrder),2),e=d[0],f=d[1],g=new a7({value:a.state.value,context:f,_event:c,_sessionid:a.sessionId,historyValue:void 0,history:a.state,actions:e.filter(function(a){return!at(a)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:a.state.done,tags:a.state.tags,machine:a.machine});return g.changed=!0,g});a.update(d,c),a._stopChildren(),bm(a.sessionId)}}),this},a.prototype.batch=function(a){var b=this;if(this.status===o.NotStarted&&this.options.deferEvents);else if(this.status!==o.Running)throw Error("".concat(a.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(a.length){var c=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var d,e,f=b.state,g=!1,h=[];try{for(var i=v(a),j=i.next();!j.done;j=i.next()){var k=j.value;!function(a){var d=an(a);b.forward(d),f=a9(b,function(){return b.machine.transition(f,d,void 0,c||void 0)}),h.push.apply(h,x([],w(b.machine.config.predictableActionArguments?f.actions:f.actions.map(function(a){var b,c;return b=f,c=a.exec,t(t({},a),{exec:void 0!==c?function(){return c(b.context,b.event,{action:a,state:b,_event:b._event})}:void 0})})),!1)),g=g||!!f.changed}(k)}}catch(a){d={error:a}}finally{try{j&&!j.done&&(e=i.return)&&e.call(i)}finally{if(d)throw d.error}}f.changed=g,f.actions=h,b.update(f,an(a[a.length-1]))})}},a.prototype.sender=function(a){return this.send.bind(this,a)},a.prototype._nextState=function(a,b){var c=this;void 0===b&&(b=!!this.machine.config.predictableActionArguments&&this._exec);var d=an(a);if(0===d.name.indexOf(L)&&!this.state.nextEvents.some(function(a){return 0===a.indexOf(L)}))throw d.data.data;return a9(this,function(){return c.machine.transition(c.state,d,void 0,b||void 0)})},a.prototype.nextState=function(a){return this._nextState(a,!1)},a.prototype.forward=function(a){var b,c;try{for(var d=v(this.forwardTo),e=d.next();!e.done;e=d.next()){var f=e.value,g=this.children.get(f);if(!g)throw Error("Unable to forward event '".concat(a,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(f,"'."));g.send(a)}}catch(a){b={error:a}}finally{try{e&&!e.done&&(c=d.return)&&c.call(d)}finally{if(b)throw b.error}}},a.prototype.defer=function(a){var b=this,c=this.clock.setTimeout(function(){"to"in a&&a.to?b.sendTo(a._event,a.to,!0):b.send(a._event)},a.delay);a.id&&(this.delayedEventsMap[a.id]=c)},a.prototype.cancel=function(a){this.clock.clearTimeout(this.delayedEventsMap[a]),delete this.delayedEventsMap[a]},a.prototype.exec=function(a,b,c){void 0===c&&(c=this.machine.options.actions),this._exec(a,b.context,b._event,c)},a.prototype.removeChild=function(a){var b;this.children.delete(a),this.forwardTo.delete(a),null==(b=this.state)||delete b.children[a]},a.prototype.stopChild=function(a){var b=this.children.get(a);b&&(this.removeChild(a),ag(b.stop)&&b.stop())},a.prototype.spawn=function(a,b,c){if(this.status!==o.Running)return bb(a,b);if(ac(a))return this.spawnPromise(Promise.resolve(a),b);if(ag(a))return this.spawnCallback(a,b);if(function(a){try{return"function"==typeof a.send}catch(a){return!1}}(a)&&"id"in a)return this.spawnActor(a,b);if(function(a){try{return"subscribe"in a&&ag(a.subscribe)}catch(a){return!1}}(a))return this.spawnObservable(a,b);if(ak(a))return this.spawnMachine(a,t(t({},c),{id:b}));if(null!==a&&"object"==typeof a&&"transition"in a&&"function"==typeof a.transition)return this.spawnBehavior(a,b);throw Error('Unable to spawn entity "'.concat(b,'" of type "').concat(typeof a,'".'))},a.prototype.spawnMachine=function(b,c){var d=this;void 0===c&&(c={});var e=new a(b,t(t({},this.options),{parent:this,id:c.id||b.id})),f=t(t({},bo),c);return f.sync&&e.onTransition(function(a){d.send(N,{state:a,id:e.id})}),this.children.set(e.id,e),f.autoForward&&this.forwardTo.add(e.id),e.onDone(function(a){d.removeChild(e.id),d.send(an(a,{origin:e.id}))}).start(),e},a.prototype.spawnBehavior=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=(c={id:b,parent:this},d=a.initialState,e=new Set,f=[],g=!1,h=function(){if(!g){for(g=!0;f.length>0;){var b=f.shift();d=a.transition(d,b,l),e.forEach(function(a){return a.next(d)})}g=!1}},i={id:c.id,send:function(a){f.push(a),h()},getSnapshot:function(){return d},subscribe:function(a,b,c){var f=ar(a,b,c);return e.add(f),f.next(d),{unsubscribe:function(){e.delete(f)}}}},k=t(((j={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[aj]=function(){return this},j),i),l={parent:c.parent,self:k,id:c.id||"anonymous",observers:e},d=a.start?a.start(l):d,k);return this.children.set(b,m),m},a.prototype.spawnPromise=function(a,b){var c,d,e=this,f=!1;a.then(function(a){f||(d=a,e.removeChild(b),e.send(an(a_(b,a),{origin:b})))},function(a){if(!f){e.removeChild(b);var c=a0(b,a);try{e.send(an(c,{origin:b}))}catch(a){e.devTools&&e.devTools.send(c,e.state),e.machine.strict&&e.stop()}}});var g=((c={id:b,send:function(){},subscribe:function(b,c,d){var e=ar(b,c,d),f=!1;return a.then(function(a){f||(e.next(a),f||e.complete())},function(a){f||e.error(a)}),{unsubscribe:function(){return f=!0}}},stop:function(){f=!0},toJSON:function(){return{id:b}},getSnapshot:function(){return d}})[aj]=function(){return this},c);return this.children.set(b,g),g},a.prototype.spawnCallback=function(a,b){var c,d,e,f=this,g=!1,h=new Set,i=new Set;try{e=a(function(a){d=a,i.forEach(function(b){return b(a)}),g||f.send(an(a,{origin:b}))},function(a){h.add(a)})}catch(a){this.send(a0(b,a))}if(ac(e))return this.spawnPromise(e,b);var j=((c={id:b,send:function(a){return h.forEach(function(b){return b(a)})},subscribe:function(a){var b=ar(a);return i.add(b.next),{unsubscribe:function(){i.delete(b.next)}}},stop:function(){g=!0,ag(e)&&e()},toJSON:function(){return{id:b}},getSnapshot:function(){return d}})[aj]=function(){return this},c);return this.children.set(b,j),j},a.prototype.spawnObservable=function(a,b){var c,d,e=this,f=a.subscribe(function(a){d=a,e.send(an(a,{origin:b}))},function(a){e.removeChild(b),e.send(an(a0(b,a),{origin:b}))},function(){e.removeChild(b),e.send(an(a_(b),{origin:b}))}),g=((c={id:b,send:function(){},subscribe:function(b,c,d){return a.subscribe(b,c,d)},stop:function(){return f.unsubscribe()},getSnapshot:function(){return d},toJSON:function(){return{id:b}}})[aj]=function(){return this},c);return this.children.set(b,g),g},a.prototype.spawnActor=function(a,b){return this.children.set(b,a),a},a.prototype.spawnActivity=function(a){var b=this.machine.options&&this.machine.options.activities?this.machine.options.activities[a.type]:void 0;if(b){var c=b(this.state.context,a);this.spawnEffect(a.id,c)}},a.prototype.spawnEffect=function(a,b){var c;this.children.set(a,((c={id:a,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:b||void 0,getSnapshot:function(){},toJSON:function(){return{id:a}}})[aj]=function(){return this},c))},a.prototype.attachDev=function(){var a=bn();if(this.options.devTools&&a){if(a.__REDUX_DEVTOOLS_EXTENSION__){var b="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=a.__REDUX_DEVTOOLS_EXTENSION__.connect(t(t({name:this.id,autoPause:!0,stateSanitizer:function(a){return{value:a.value,context:a.context,actions:a.actions}}},b),{features:t({jump:!1,skip:!1},b?b.features:void 0)}),this.machine),this.devTools.init(this.state)}if(bn()){var c=function(){var a=bn();if(a&&"__xstate__"in a)return a.__xstate__}();c&&c.register(this)}}},a.prototype.toJSON=function(){return{id:this.id}},a.prototype[aj]=function(){return this},a.prototype.getSnapshot=function(){return this.status===o.NotStarted?this.initialState:this._state},a.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(a,b){return setTimeout(a,b)},clearTimeout:function(a){return clearTimeout(a)}},logger:console.log.bind(console),devTools:!1},a.interpret=bq,a}();function bq(a,b){return new bp(a,b)}function br(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]=c[d]}return a}var bs=function a(b,c){function d(a,d,e){if("undefined"!=typeof document){"number"==typeof(e=br({},c,e)).expires&&(e.expires=new Date(Date.now()+864e5*e.expires)),e.expires&&(e.expires=e.expires.toUTCString()),a=encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var f="";for(var g in e)e[g]&&(f+="; "+g,!0!==e[g]&&(f+="="+e[g].split(";")[0]));return document.cookie=a+"="+b.write(d,a)+f}}return Object.create({set:d,get:function(a){if("undefined"!=typeof document&&(!arguments.length||a)){for(var c=document.cookie?document.cookie.split("; "):[],d={},e=0;e<c.length;e++){var f=c[e].split("="),g=f.slice(1).join("=");try{var h=decodeURIComponent(f[0]);if(d[h]=b.read(g,h),a===h)break}catch(a){}}return a?d[a]:d}},remove:function(a,b){d(a,"",br({},b,{expires:-1}))},withAttributes:function(b){return a(this.converter,br({},this.attributes,b))},withConverter:function(b){return a(br({},this.converter,b),this.attributes)}},{attributes:{value:Object.freeze(c)},converter:{value:Object.freeze(b)}})}({read:function(a){return'"'===a[0]&&(a=a.slice(1,-1)),a.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(a){return encodeURIComponent(a).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});a.i(4812);let bt="nhostRefreshToken",bu="nhostRefreshTokenId",bv="nhostRefreshTokenExpiresAt";class bw extends Error{constructor(a){super(a.message),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),a instanceof Error?(this.name=a.name,this.error={error:a.name,status:1,message:a.message}):(this.name=a.error,this.error=a)}}let bx={status:10,error:"invalid-email",message:"Email is incorrectly formatted"},by={status:10,error:"invalid-mfa-type",message:"MFA type is invalid"},bz={status:10,error:"invalid-mfa-code",message:"MFA code is invalid"},bA={status:10,error:"invalid-password",message:"Password is incorrectly formatted"},bB={status:10,error:"invalid-phone-number",message:"Phone number is incorrectly formatted"},bC={status:10,error:"invalid-mfa-ticket",message:"MFA ticket is invalid"},bD={status:10,error:"no-mfa-ticket",message:"No MFA ticket has been provided"},bE={status:10,error:"no-refresh-token",message:"No refresh token has been provided"},bF={status:20,error:"refresher-already-running",message:"The token refresher is already running. You must wait until is has finished before submitting a new token."},bG={status:20,error:"already-signed-in",message:"User is already signed in"},bH={status:20,error:"unauthenticated-user",message:"User is not authenticated"},bI={status:20,error:"unverified-user",message:"Email needs verification"},bJ={status:10,error:"invalid-refresh-token",message:"Invalid or expired refresh token"},bK={status:1,error:"invalid-sign-in-method",message:"Invalid sign-in method"},bL={user:null,mfa:null,accessToken:{value:null,expiresAt:null,expiresInSeconds:15},refreshTimer:{startedAt:null,attempts:0,lastAttempt:null},refreshToken:{value:null},importTokenAttempts:0,errors:{}};function bM(a){let b=new Uint8Array(a),c="";for(let a of b)c+=String.fromCharCode(a);return btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function bN(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c=(4-b.length%4)%4,d=atob(b.padEnd(b.length+c,"=")),e=new ArrayBuffer(d.length),f=new Uint8Array(e);for(let a=0;a<d.length;a++)f[a]=d.charCodeAt(a);return e}function bO(){return(null==window?void 0:window.PublicKeyCredential)!==void 0&&"function"==typeof window.PublicKeyCredential}function bP(a){let{id:b}=a;return{...a,id:bN(b),transports:a.transports}}function bQ(a){return"localhost"===a||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}class bR extends Error{constructor({message:a,code:b,cause:c,name:d}){super(a,{cause:c}),this.name=null!=d?d:c.name,this.code=b}}let bS=new class{createNewAbortSignal(){if(this.controller){let a=Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}let a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){let a=Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}},bT=["cross-platform","platform"];function bU(a){if(a&&!(0>bT.indexOf(a)))return a}async function bV(a){var b,c;let d,e,f,g,h;if(!bO())throw Error("WebAuthn is not supported in this browser");let i={publicKey:{...a,challenge:bN(a.challenge),user:{...a.user,id:(c=a.user.id,new TextEncoder().encode(c))},excludeCredentials:null==(b=a.excludeCredentials)?void 0:b.map(bP)}};i.signal=bS.createNewAbortSignal();try{d=await navigator.credentials.create(i)}catch(a){throw function({error:a,options:b}){var c,d;let{publicKey:e}=b;if(!e)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new bR({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("ConstraintError"===a.name){if((null==(c=e.authenticatorSelection)?void 0:c.requireResidentKey)===!0)return new bR({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});if((null==(d=e.authenticatorSelection)?void 0:d.userVerification)==="required")return new bR({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else{if("InvalidStateError"===a.name)return new bR({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});if("NotAllowedError"===a.name)return new bR({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});if("NotSupportedError"===a.name)return new bR(0===e.pubKeyCredParams.filter(a=>"public-key"===a.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});if("SecurityError"===a.name){let b=window.location.hostname;if(!bQ(b))return new bR({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(e.rp.id!==b)return new bR({message:`The RP ID "${e.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("TypeError"===a.name){if(e.user.id.byteLength<1||e.user.id.byteLength>64)return new bR({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if("UnknownError"===a.name)return new bR({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a})}return a}({error:a,options:i})}if(!d)throw Error("Registration was not completed");let{id:j,rawId:k,response:l,type:m}=d;if("function"==typeof l.getTransports&&(e=l.getTransports()),"function"==typeof l.getPublicKeyAlgorithm)try{f=l.getPublicKeyAlgorithm()}catch(a){bW("getPublicKeyAlgorithm()",a)}if("function"==typeof l.getPublicKey)try{let a=l.getPublicKey();null!==a&&(g=bM(a))}catch(a){bW("getPublicKey()",a)}if("function"==typeof l.getAuthenticatorData)try{h=bM(l.getAuthenticatorData())}catch(a){bW("getAuthenticatorData()",a)}return{id:j,rawId:bM(k),response:{attestationObject:bM(l.attestationObject),clientDataJSON:bM(l.clientDataJSON),transports:e,publicKeyAlgorithm:f,publicKey:g,authenticatorData:h},type:m,clientExtensionResults:d.getClientExtensionResults(),authenticatorAttachment:bU(d.authenticatorAttachment)}}function bW(a,b){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${a}. You should report this error to them.
`,b)}async function bX(a,b=!1){var c,d,e;let f,g,h;if(!bO())throw Error("WebAuthn is not supported in this browser");(null==(c=a.allowCredentials)?void 0:c.length)!==0&&(f=null==(d=a.allowCredentials)?void 0:d.map(bP));let i={...a,challenge:bN(a.challenge),allowCredentials:f},j={};if(b){let a;if(!await (void 0===(a=window.PublicKeyCredential).isConditionalMediationAvailable?new Promise(a=>a(!1)):a.isConditionalMediationAvailable()))throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');j.mediation="conditional",i.allowCredentials=[]}j.publicKey=i,j.signal=bS.createNewAbortSignal();try{g=await navigator.credentials.get(j)}catch(a){throw function({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new bR({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else{if("NotAllowedError"===a.name)return new bR({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});if("SecurityError"===a.name){let b=window.location.hostname;if(!bQ(b))return new bR({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rpId!==b)return new bR({message:`The RP ID "${c.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("UnknownError"===a.name)return new bR({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a})}return a}({error:a,options:j})}if(!g)throw Error("Authentication was not completed");let{id:k,rawId:l,response:m,type:n}=g;return m.userHandle&&(e=m.userHandle,h=new TextDecoder("utf-8").decode(e)),{id:k,rawId:bM(l),response:{authenticatorData:bM(m.authenticatorData),clientDataJSON:bM(m.clientDataJSON),signature:bM(m.signature),userHandle:h},type:n,clientExtensionResults:g.getClientExtensionResults(),authenticatorAttachment:bU(g.authenticatorAttachment)}}let bY=new Map,bZ=a=>{var b;return null!=(b=bY.get(a))?b:null},b$=(a,b)=>{b?bY.set(a,b):bY.has(a)&&bY.delete(a)},b_=a=>a&&a.accessToken.value&&a.accessToken.expiresAt&&a.user?{accessToken:a.accessToken.value,accessTokenExpiresIn:(a.accessToken.expiresAt.getTime()-Date.now())/1e3,refreshToken:a.refreshToken.value,user:a.user}:null,b0=({accessToken:a,refreshToken:b,isError:c,user:d,error:e})=>c?{session:null,error:e}:d&&a?{session:{accessToken:a,accessTokenExpiresIn:0,refreshToken:b,user:d},error:null}:{session:null,error:null},b1=globalThis.fetch,b2=async(a,b,{token:c,body:d,extraHeaders:e}={})=>{let f={"Content-Type":"application/json",Accept:"*/*"};c&&(f.Authorization=`Bearer ${c}`);let g={method:b,headers:{...f,...e}};d&&(g.body=JSON.stringify(d));try{let b=await b1(a,g);if(!b.ok){let a=await b.json();return Promise.reject({error:a})}try{return{data:await b.json(),error:null}}catch{return console.warn(`Unexpected response: can't parse the response of the server at ${a}`),{data:"OK",error:null}}}catch{return Promise.reject({error:{message:"Network Error",status:0,error:"network"}})}},b3=async(a,b,c,d)=>b2(a,"POST",{token:c,body:b,extraHeaders:d}),b4=(a,b)=>{let c=b&&Object.entries(b).map(([a,b])=>{let c=Array.isArray(b)?b.join(","):"object"==typeof b?JSON.stringify(b):b;return`${a}=${encodeURIComponent(c)}`}).join("&");return c?`${a}?${c}`:a},b5=(a,b)=>{if(!(null!=b&&b.redirectTo))return b;let{redirectTo:c,...d}=b;if(!a)return c.startsWith("/")?d:b;let e=new URL(a),f=Object.fromEntries(new URLSearchParams(e.search)),g=new URL(c.startsWith("/")?e.origin+c:c),h=Object.fromEntries(new URLSearchParams(g.search));c.startsWith("/")&&(h={...f,...h});let i=e.pathname;return g.pathname.length>1&&(i+=g.pathname.slice(1)),{...d,redirectTo:b4(g.origin+i,h)}};function b6(a,b){if(!b)return;let c=RegExp("[?&#]"+(a=a.replace(/[\[\]]/g,"\\$&"))+"(=([^&#]*)|&|#|$)").exec(b);return c?c[2]?decodeURIComponent(c[2].replace(/\+/g," ")):"":null}function b7(a){}let b8=a=>!!a&&"string"==typeof a&&!!String(a).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),b9=a=>!!a&&"string"==typeof a&&a.length>=3,ca=a=>!!a&&"string"==typeof a,cb=({backendUrl:a,clientUrl:b,interpreter:c})=>bg({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:aX({error:a=>bx}),saveRequestError:aX({error:(a,{data:{error:b}})=>b}),reportError:aK(a=>({type:"ERROR",error:a.error})),reportSuccess:aK("SUCCESS")},guards:{invalidEmail:(a,{email:b})=>!b8(b)},services:{requestChange:async(d,{email:e,options:f})=>(await b3(`${a}/user/email/change`,{newEmail:e,options:b5(b,f)},null==c?void 0:c.getSnapshot().context.accessToken.value)).data}}),cc=({backendUrl:a,interpreter:b})=>bg({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:aX({error:a=>bA}),saveRequestError:aX({error:(a,{data:{error:b}})=>b}),reportError:aK(a=>({type:"ERROR",error:a.error})),reportSuccess:aK("SUCCESS")},guards:{invalidPassword:(a,{password:b})=>!b9(b)},services:{requestChange:(c,{password:d,ticket:e})=>b3(`${a}/user/password`,{newPassword:d,ticket:e},null==b?void 0:b.getSnapshot().context.accessToken.value)}}),cd=({backendUrl:a,clientUrl:b})=>bg({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:aX({error:a=>bx}),saveRequestError:aX({error:(a,{data:{error:b}})=>b}),reportError:aK(a=>({type:"ERROR",error:a.error})),reportSuccess:aK("SUCCESS")},guards:{invalidEmail:(a,{email:b})=>!b8(b)},services:{requestChange:(c,{email:d,options:e})=>b3(`${a}/user/password/reset`,{email:d,options:b5(b,e)})}}),ce=({backendUrl:a,clientUrl:b})=>bg({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"sendVerificationEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"request",id:"request",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:aX({error:a=>bx}),saveRequestError:aX({error:(a,{data:{error:b}})=>b}),reportError:aK(a=>({type:"ERROR",error:a.error})),reportSuccess:aK("SUCCESS")},guards:{invalidEmail:(a,{email:b})=>!b8(b)},services:{request:async(c,{email:d,options:e})=>(await b3(`${a}/user/email/send-verification-email`,{email:d,options:b5(b,e)})).data}});class cf{constructor({clientStorageType:a="web",autoSignIn:b=!0,autoRefreshToken:c=!0,start:d=!0,backendUrl:e,clientUrl:f,broadcastKey:g,devTools:h,...i}){this._started=!1,this._subscriptionsQueue=new Set,this._subscriptions=new Set,this.backendUrl=e,this.clientUrl=f,this._machine=(({backendUrl:a,clientUrl:b,broadcastKey:c,clientStorageType:d="web",clientStorage:e,refreshIntervalTime:f,autoRefreshToken:g=!0,autoSignIn:h=!0})=>{let i=((a,b)=>{if("localStorage"===a||"web"===a)return bZ;if("cookie"===a)return a=>null;if(!b)throw Error(`clientStorageType is set to '${a}' but no clientStorage has been given`);if("react-native"===a)return a=>{var c;return null==(c=b.getItem)?void 0:c.call(b,a)};if("capacitor"===a)return a=>{var c;return null==(c=b.get)?void 0:c.call(b,{key:a})};if("expo-secure-storage"===a)return a=>{var c;return null==(c=b.getItemAsync)?void 0:c.call(b,a)};if("custom"===a){if(b.getItem&&b.removeItem)return b.getItem;if(b.getItemAsync)return b.getItemAsync;throw Error('clientStorageType is set to \'custom\' but clientStorage is missing either "getItem" and "removeItem" properties or "getItemAsync" property')}throw Error(`Unknown storage type: ${a}`)})(d,e),j=((a,b)=>{if("localStorage"===a||"web"===a)return b$;if("cookie"===a)return(a,b)=>{};if(!b)throw Error(`clientStorageType is set to '${a}' but no clienStorage has been given`);if("react-native"===a)return(a,c)=>{var d,e;return c?null==(d=b.setItem)?void 0:d.call(b,a,c):null==(e=b.removeItem)?void 0:e.call(b,a)};if("capacitor"===a)return(a,c)=>{var d,e;return c?null==(d=b.set)?void 0:d.call(b,{key:a,value:c}):null==(e=b.remove)?void 0:e.call(b,{key:a})};if("expo-secure-storage"===a)return async(a,c)=>{var d,e;return c?null==(d=b.setItemAsync)?void 0:d.call(b,a,c):null==(e=b.deleteItemAsync)?void 0:e.call(b,a)};if("custom"===a){if(!b.removeItem)throw Error("clientStorageType is set to 'custom' but clientStorage is missing a removeItem property");if(b.setItem)return(a,c)=>{var d,e;return c?null==(d=b.setItem)?void 0:d.call(b,a,c):null==(e=b.removeItem)?void 0:e.call(b,a)};if(b.setItemAsync)return async(a,c)=>{var d,e;return c?null==(d=b.setItemAsync)?void 0:d.call(b,a,c):null==(e=b.removeItem)?void 0:e.call(b,a)};throw Error("clientStorageType is set to 'custom' but clientStorage is missing setItem or setItemAsync property")}throw Error(`Unknown storage type: ${a}`)})(d,e),k=async(b,c,d,e)=>(await b3(`${a}${b}`,c,d,e)).data;return bg({schema:{context:{},events:{},services:{}},tsTypes:{},context:bL,predictableActionArguments:!0,id:"nhost",type:"parallel",states:{authentication:{initial:"starting",on:{SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","resetTimer","reportTokenChanged"],target:".signedIn"}]},states:{starting:{tags:["loading"],always:{cond:"isSignedIn",target:"signedIn"},invoke:{id:"importRefreshToken",src:"importRefreshToken",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"signedIn"},{target:"signedOut"}],onError:[{cond:"shouldRetryImportToken",actions:"incrementTokenImportAttempts",target:"retryTokenImport"},{actions:["saveAuthenticationError"],target:"signedOut"}]}},retryTokenImport:{tags:["loading"],after:{RETRY_IMPORT_TOKEN_DELAY:"starting"}},signedOut:{initial:"noErrors",entry:"reportSignedOut",states:{noErrors:{},success:{},needsSmsOtp:{},needsMfa:{},failed:{},signingOut:{entry:["clearContextExceptTokens"],exit:["destroyAccessToken","destroyRefreshToken","reportTokenChanged"],invoke:{src:"signout",id:"signingOut",onDone:{target:"success"},onError:{target:"failed",actions:["saveAuthenticationError"]}}}},on:{SIGNIN_PASSWORD:"authenticating.password",SIGNIN_ANONYMOUS:"authenticating.anonymous",SIGNIN_SECURITY_KEY_EMAIL:"authenticating.securityKeyEmail",SIGNIN_SECURITY_KEY:"authenticating.securityKey",SIGNIN_MFA_TOTP:"authenticating.mfa.totp",SIGNIN_PAT:"authenticating.pat",SIGNIN_ID_TOKEN:"authenticating.idToken"}},authenticating:{entry:"resetErrors",states:{password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:[{cond:"hasMfaTicket",actions:["saveMfaTicket"],target:"#nhost.authentication.signedOut.needsMfa"},{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"}],onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},pat:{invoke:{src:"signInPAT",id:"authenticateWithPAT",onDone:{actions:["savePATSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},idToken:{invoke:{src:"signInIdToken",id:"authenticateWithIdToken",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},mfa:{states:{totp:{invoke:{src:"signInMfaTotp",id:"signInMfaTotp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:["saveAuthenticationError"],target:"#nhost.authentication.signedOut.failed"}}}}},securityKeyEmail:{invoke:{src:"signInSecurityKeyEmail",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},securityKey:{invoke:{src:"signInSecurityKey",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}}}},signedIn:{type:"parallel",entry:["reportSignedIn","cleanUrl","broadcastToken","resetErrors"],on:{SIGNOUT:"signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"isRefreshTokenPAT",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{1e3:{internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","resetTimer","reportTokenChanged","broadcastToken"],target:"pending"},onError:[{cond:"isUnauthorizedError",target:"#nhost.authentication.signedOut"},{actions:"saveRefreshAttempt",target:"pending"}]}}}}}}}}}},token:{initial:"idle",states:{idle:{on:{TRY_TOKEN:"running"},initial:"noErrors",states:{noErrors:{},error:{}}},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","reportTokenChanged","broadcastToken"],target:["#nhost.authentication.signedIn","idle.noErrors"]},onError:[{cond:"isSignedIn",target:"idle.error"},{actions:"saveAuthenticationError",target:["#nhost.authentication.signedOut.failed","idle.error"]}]}}}},registration:{initial:"incomplete",on:{SIGNED_IN:[{cond:"isAnonymous",target:".incomplete"},".complete"]},states:{incomplete:{on:{SIGNUP_EMAIL_PASSWORD:"emailPassword",SIGNUP_SECURITY_KEY:"securityKey",PASSWORDLESS_EMAIL:"passwordlessEmail",PASSWORDLESS_SMS:"passwordlessSms",PASSWORDLESS_SMS_OTP:"passwordlessSmsOtp",SIGNIN_EMAIL_OTP:"signInEmailOTP",VERIFY_EMAIL_OTP:"verifyEmailOTP"},initial:"noErrors",states:{noErrors:{},needsEmailVerification:{},needsOtp:{},failed:{}}},emailPassword:{entry:["resetErrors"],invoke:{src:"signUpEmailPassword",id:"signUpEmailPassword",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},securityKey:{entry:["resetErrors"],invoke:{src:"signUpSecurityKey",id:"signUpSecurityKey",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},passwordlessEmail:{entry:["resetErrors"],invoke:{src:"passwordlessEmail",id:"passwordlessEmail",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSms:{entry:["resetErrors"],invoke:{src:"passwordlessSms",id:"passwordlessSms",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSmsOtp:{entry:["resetErrors"],invoke:{src:"passwordlessSmsOtp",id:"passwordlessSmsOtp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},signInEmailOTP:{entry:["resetErrors"],invoke:{src:"signInEmailOTP",id:"signInEmailOTP",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},verifyEmailOTP:{entry:["resetErrors"],invoke:{src:"verifyEmailOTP",id:"verifyEmailOTP",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},complete:{on:{SIGNED_OUT:"incomplete"}}}}}},{actions:{reportSignedIn:aK("SIGNED_IN"),reportSignedOut:aK("SIGNED_OUT"),reportTokenChanged:aK("TOKEN_CHANGED"),incrementTokenImportAttempts:aX({importTokenAttempts:({importTokenAttempts:a})=>a+1}),clearContext:aX(()=>(j(bv,null),j(bt,null),j(bu,null),{...bL})),clearContextExceptTokens:aX(({accessToken:a,refreshToken:b})=>({...bL,accessToken:a,refreshToken:b})),saveSession:aX({user:(a,{data:b})=>{var c;return(null==(c=null==b?void 0:b.session)?void 0:c.user)||null},accessToken:(a,{data:b})=>{if(b.session){let{accessTokenExpiresIn:a,accessToken:c}=b.session,d=new Date(Date.now()+1e3*a);return j(bv,d.toISOString()),{value:c,expiresAt:d,expiresInSeconds:a}}return j(bv,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(a,{data:b})=>{var c,d;let e=(null==(c=b.session)?void 0:c.refreshToken)||null,f=(null==(d=b.session)?void 0:d.refreshTokenId)||null;return e&&j(bt,e),f&&j(bu,f),{value:e}}}),savePATSession:aX({user:(a,{data:b})=>{var c;return(null==(c=null==b?void 0:b.session)?void 0:c.user)||null},accessToken:(a,{data:b})=>{if(b.session){let{accessTokenExpiresIn:a,accessToken:c}=b.session,d=new Date(Date.now()+1e3*a);return j(bv,d.toISOString()),{value:c,expiresAt:d,expiresInSeconds:a}}return j(bv,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(a,{data:b})=>{var c,d;let e=(null==(c=b.session)?void 0:c.refreshToken)||null,f=(null==(d=b.session)?void 0:d.refreshTokenId)||null;return e&&j(bt,e),f&&j(bu,f),{value:e,isPAT:!0}}}),saveMfaTicket:aX({mfa:(a,b)=>{var c;return null==(c=b.data)?void 0:c.mfa}}),resetTimer:aX({refreshTimer:a=>({startedAt:new Date,attempts:0,lastAttempt:null})}),saveRefreshAttempt:aX({refreshTimer:(a,b)=>({startedAt:a.refreshTimer.startedAt,attempts:a.refreshTimer.attempts+1,lastAttempt:new Date})}),saveAuthenticationError:aX({errors:({errors:a},{data:{error:b}})=>({...a,authentication:b})}),resetErrors:aX({errors:a=>({}),importTokenAttempts:a=>0}),saveRegistrationError:aX({errors:({errors:a},{data:{error:b}})=>({...a,registration:b})}),destroyRefreshToken:aX({refreshToken:a=>(j(bt,null),j(bu,null),{value:null})}),destroyAccessToken:aX({accessToken:a=>(j(bv,null),{value:null,expiresAt:null,expiresInSeconds:null})}),cleanUrl:()=>{h&&b6("refreshToken")&&(b7("refreshToken"),b7("type"))},broadcastToken:a=>{}},guards:{isAnonymous:(a,b)=>{var c;return!!(null!=(c=a.user)&&c.isAnonymous)},isSignedIn:a=>!!a.user&&!!a.accessToken.value,noToken:a=>!a.refreshToken.value,isRefreshTokenPAT:a=>{var b;return!!(null!=(b=a.refreshToken)&&b.isPAT)},hasRefreshToken:a=>!!a.refreshToken.value,isAutoRefreshDisabled:()=>!g,refreshTimerShouldRefresh:a=>{let{expiresAt:b}=a.accessToken;if(!b)return!1;if(a.refreshTimer.lastAttempt)return!(a.refreshTimer.attempts>5)&&Date.now()-a.refreshTimer.lastAttempt.getTime()>5e3*Math.pow(2,a.refreshTimer.attempts-1);if(b.getTime()<Date.now()||f&&Date.now()-a.refreshTimer.startedAt.getTime()>1e3*f)return!0;if(!a.accessToken.expiresInSeconds)return!1;let c=b.getTime()-Date.now();return c<=3e4||c<=6e4&&.1>Math.random()},shouldRetryImportToken:(a,b)=>a.importTokenAttempts<5&&(0===b.data.error.status||b.data.error.status>=500),unverified:(a,{data:{error:b}})=>401===b.status&&("Email is not verified"===b.message||"unverified-user"===b.error),hasSession:(a,b)=>{var c;return!!(null!=(c=b.data)&&c.session)},hasMfaTicket:(a,b)=>{var c;return!!(null!=(c=b.data)&&c.mfa)},isUnauthorizedError:(a,{data:{error:b}})=>401===b.status},services:{signInPassword:(a,{email:b,password:c})=>b8(b)?b9(c)?k("/signin/email-password",{email:b,password:c}):Promise.reject({error:bA}):Promise.reject({error:bx}),signInPAT:(a,{pat:b})=>k("/signin/pat",{personalAccessToken:b}),signInIdToken:(a,{provider:b,idToken:c,nonce:d})=>k("/signin/idtoken",{provider:b,idToken:c,...d&&{nonce:d}}),passwordlessSms:(a,{phoneNumber:c,options:d})=>{var e;return ca(c)?null!=(e=a.user)&&e.isAnonymous?(console.warn("Deanonymisation from a phone number is not yet implemented in hasura-auth"),k("/user/deanonymize",{signInMethod:"passwordless",connection:"sms",phoneNumber:c,options:b5(b,d)},a.accessToken.value)):k("/signin/passwordless/sms",{phoneNumber:c,options:b5(b,d)}):Promise.reject({error:bB})},passwordlessSmsOtp:(a,{phoneNumber:b,otp:c})=>ca(b)?k("/signin/passwordless/sms/otp",{phoneNumber:b,otp:c}):Promise.reject({error:bB}),signInEmailOTP:(a,{email:c,options:d})=>b8(c)?k("/signin/otp/email",{email:c,options:b5(b,d)}):Promise.reject({error:bx}),verifyEmailOTP:(a,{email:b,otp:c})=>b8(b)?k("/signin/otp/email/verify",{email:b,otp:c}):Promise.reject({error:bx}),passwordlessEmail:(a,{email:c,options:d})=>{var e;return b8(c)?null!=(e=a.user)&&e.isAnonymous?k("/user/deanonymize",{signInMethod:"passwordless",connection:"email",email:c,options:b5(b,d)},a.accessToken.value):k("/signin/passwordless/email",{email:c,options:b5(b,d)}):Promise.reject({error:bx})},signInAnonymous:a=>k("/signin/anonymous"),signInMfaTotp:(a,b)=>{var c;let d=b.ticket||(null==(c=a.mfa)?void 0:c.ticket);return d?d&&"string"==typeof d&&d.match(/^mfaTotp:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)?k("/signin/mfa/totp",{ticket:d,otp:b.otp}):Promise.reject({error:bC}):Promise.reject({error:bD})},signInSecurityKeyEmail:async(a,{email:b})=>{let c;if(!b8(b))throw new bw(bx);let d=await k("/signin/webauthn",{email:b});try{c=await bX(d)}catch(a){throw new bw(a)}return k("/signin/webauthn/verify",{email:b,credential:c})},refreshToken:async(a,b)=>{let c="TRY_TOKEN"===b.type?b.token:a.refreshToken.value;return{session:await k("/token",{refreshToken:c}),error:null}},signInSecurityKey:async()=>{try{let a,b=await k("/signin/webauthn",{});try{a=await bX(b)}catch(a){throw new bw(a)}return k("/signin/webauthn/verify",{credential:a})}catch(a){throw new bw(a)}},signout:async(a,b)=>{let c=await k("/signout",{refreshToken:a.refreshToken.value,all:!!b.all},b.all?a.accessToken.value:void 0);return c},signUpEmailPassword:async(a,{email:c,password:d,options:e,requestOptions:f})=>{var g;return b8(c)?b9(d)?null!=(g=a.user)&&g.isAnonymous?k("/user/deanonymize",{signInMethod:"email-password",email:c,password:d,options:b5(b,e)},a.accessToken.value,null==f?void 0:f.headers):k("/signup/email-password",{email:c,password:d,options:b5(b,e)},null,null==f?void 0:f.headers):Promise.reject({error:bA}):Promise.reject({error:bx})},signUpSecurityKey:async(a,{email:b,options:c,requestOptions:d})=>{let e;if(!b8(b))return Promise.reject({error:bx});let f=null==c?void 0:c.nickname;f&&delete c.nickname;let g=await k("/signup/webauthn",{email:b,options:c},null,null==d?void 0:d.headers);try{e=await bV(g)}catch(a){throw new bw(a)}return k("/signup/webauthn/verify",{credential:e,options:{redirectTo:null==c?void 0:c.redirectTo,nickname:f,displayName:null==c?void 0:c.displayName,...(null==c?void 0:c.metadata)&&{metadata:null==c?void 0:c.metadata}}})},importRefreshToken:async a=>{if(a.user&&a.refreshToken.value&&a.accessToken.value&&a.accessToken.expiresAt)return{session:{accessToken:a.accessToken.value,accessTokenExpiresIn:a.accessToken.expiresAt.getTime()-Date.now(),refreshToken:a.refreshToken.value,user:a.user},error:null};let b=null;if(h){let a=b6("refreshToken")||null;if(a)try{return{session:await k("/token",{refreshToken:a}),error:null}}catch(a){b=a.error}else{let a=b6("error"),b=b6("errorDescription");if(a&&"social user already exists"!==b)return Promise.reject({session:null,error:{status:10,error:a,message:b||a}})}}let c=await i(bt);if(c)try{return{session:await k("/token",{refreshToken:c}),error:null}}catch(a){b=a.error}return b?Promise.reject({error:b,session:null}):{error:null,session:null}}},delays:{RETRY_IMPORT_TOKEN_DELAY:({importTokenAttempts:a})=>5e3*Math.pow(2,a-1)}})})({...i,backendUrl:e,clientUrl:f,broadcastKey:g,clientStorageType:a,autoSignIn:b,autoRefreshToken:c}),d&&this.start({devTools:h})}start({devTools:a=!1,initialSession:b,interpreter:c}={}){var d,e;let f={...this.machine.context,accessToken:{...this.machine.context.accessToken},refreshToken:{...this.machine.context.refreshToken}};b&&(f.user=b.user,f.refreshToken.value=null!=(d=b.refreshToken)?d:null,f.accessToken.value=null!=(e=b.accessToken)?e:null,f.accessToken.expiresAt=new Date(Date.now()+1e3*b.accessTokenExpiresIn));let g=this.machine.withContext(f);this._interpreter||(this._interpreter=c||bq(g,{devTools:a})),this._started,this._interpreter.initialized&&(this._interpreter.stop(),this._subscriptions.forEach(a=>a())),this._interpreter.start(g.initialState),this._subscriptionsQueue.forEach(a=>a(this)),this._started=!0}get machine(){return this._machine}get interpreter(){return this._interpreter}get started(){return this._started}subscribe(a){if(!this.started)return this._subscriptionsQueue.add(a),()=>{console.log("onTokenChanged was added before the interpreter started. Cannot unsubscribe listener.")};{let b=a(this);return this._subscriptions.add(b),b}}}let cg=async({backendUrl:a,interpreter:b},c)=>{try{let d,{data:e}=await b3(`${a}/user/webauthn/add`,{},null==b?void 0:b.getSnapshot().context.accessToken.value);try{d=await bV(e)}catch(a){throw new bw(a)}let{data:f}=await b3(`${a}/user/webauthn/verify`,{credential:d,nickname:c},null==b?void 0:b.getSnapshot().context.accessToken.value);return{key:f,isError:!1,error:null,isSuccess:!0}}catch(b){let{error:a}=b;return{isError:!0,error:a,isSuccess:!1}}},ch=async(a,b,c)=>new Promise(d=>{a.send("REQUEST",{email:b,options:c}),a.onTransition(a=>{a.matches({idle:"error"})?d({error:a.context.error,isError:!0,needsEmailVerification:!1}):a.matches({idle:"success"})&&d({error:null,isError:!1,needsEmailVerification:!0})})}),ci=async(a,b,c)=>new Promise(d=>{a.send("REQUEST",{password:b,ticket:c}),a.onTransition(a=>{a.matches({idle:"error"})?d({error:a.context.error,isError:!0,isSuccess:!1}):a.matches({idle:"success"})&&d({error:null,isError:!1,isSuccess:!0})})}),cj=async(a,b,c)=>new Promise(d=>{a.send("REQUEST",{email:b,options:c}),a.onTransition(a=>{a.matches({idle:"error"})?d({error:a.context.error,isError:!0,isSent:!1}):a.matches({idle:"success"})&&d({error:null,isError:!1,isSent:!0})})}),ck=(a,b,c)=>new Promise(d=>{a.send("REQUEST",{email:b,options:c}),a.onTransition(a=>{a.matches({idle:"error"})?d({error:a.context.error,isError:!0,isSent:!1}):a.matches({idle:"success"})&&d({error:null,isError:!1,isSent:!0})})}),cl=a=>new Promise(b=>{let{changed:c}=a.send("SIGNIN_ANONYMOUS");c||b({isSuccess:!1,isError:!0,error:bG,user:null,accessToken:null,refreshToken:null}),a.onTransition(a=>{a.matches({authentication:"signedIn"})&&b({isSuccess:!0,isError:!1,error:null,user:a.context.user,accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value}),a.matches({authentication:{signedOut:"failed"}})&&b({isSuccess:!1,isError:!0,error:a.context.errors.authentication||null,user:null,accessToken:null,refreshToken:null})})}),cm=(a,b,c)=>new Promise(d=>{let{changed:e,context:f}=a.send("SIGNIN_PASSWORD",{email:b,password:c});if(!e)return d({accessToken:f.accessToken.value,refreshToken:f.refreshToken.value,error:bG,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:f.user});a.onTransition(a=>{a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?d({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,needsMfaOtp:!1,mfa:null,user:null}):a.matches({authentication:{signedOut:"needsMfa"}})?d({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!0,mfa:a.context.mfa,user:null}):a.matches({authentication:{signedOut:"failed"}})?d({accessToken:null,refreshToken:null,error:a.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:null}):a.matches({authentication:"signedIn"})&&d({accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:a.context.user})})}),cn=(a,b,c)=>new Promise(d=>{let{changed:e}=a.send("PASSWORDLESS_EMAIL",{email:b,options:c});if(!e)return d({error:bG,isError:!0,isSuccess:!1});a.onTransition(a=>{a.matches("registration.incomplete.failed")?d({error:a.context.errors.registration||null,isError:!0,isSuccess:!1}):a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})&&d({error:null,isError:!1,isSuccess:!0})})}),co=(a,b)=>new Promise(c=>{let{changed:d,context:e}=a.send({type:"SIGNIN_SECURITY_KEY_EMAIL",email:b});if(!d)return c({accessToken:e.accessToken.value,refreshToken:e.refreshToken.value,error:bG,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:e.user});a.onTransition(a=>{a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?c({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):a.matches({authentication:{signedOut:"failed"}})?c({accessToken:null,refreshToken:null,error:a.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):a.matches({authentication:"signedIn"})&&c({accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:a.context.user})})});function cp(a){return{error:a.message||"Something went wrong!",status:a.status||1,message:a.message||"Something went wrong!"}}let cq=async(a,b)=>{var c,d;let e,f,g=null==(c=a.interpreter)?void 0:c.getSnapshot(),h=null==g?void 0:g.context.accessToken.value;try{e=(await b3(`${a.backendUrl}/elevate/webauthn`,{email:b},h)).data}catch(a){return{error:cp(a),isError:!0,isSuccess:!1,elevated:!1}}try{f=await bX(e)}catch(a){return{error:cp(a),isError:!0,isSuccess:!1,elevated:!1}}try{let{data:{session:c},error:e}=await b3(`${a.backendUrl}/elevate/webauthn/verify`,{email:b,credential:f},h);return c&&!e?(null==(d=a.interpreter)||d.send({type:"SESSION_UPDATE",data:{session:c}}),{error:null,isError:!1,isSuccess:!0,elevated:!0}):{error:e,isError:!0,isSuccess:!1,elevated:!1}}catch(b){let{error:a}=b;return{error:a,isError:!0,isSuccess:!1,elevated:!1}}},cr=(a,b,c)=>new Promise(d=>{let{changed:e,context:f}=a.send("SIGNIN_MFA_TOTP",{otp:b,ticket:c});if(!e)return d({accessToken:f.accessToken.value,refreshToken:f.refreshToken.value,error:bG,isError:!0,isSuccess:!1,user:f.user});a.onTransition(a=>{a.matches({authentication:{signedOut:"failed"}})?d({accessToken:null,refreshToken:null,error:a.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null}):a.matches({authentication:"signedIn"})&&d({accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,user:a.context.user})})}),cs=(a,b)=>new Promise(c=>{let{changed:d}=a.send("SIGNIN_PAT",{pat:b});d||c({isSuccess:!1,isError:!0,error:bG,user:null,accessToken:null,refreshToken:null}),a.onTransition(a=>a.matches({authentication:{signedOut:"failed"}})?c({accessToken:null,refreshToken:null,user:null,error:a.context.errors.authentication||null,isError:!0,isSuccess:!1}):a.matches({authentication:"signedIn"})?c({accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value,user:a.context.user,error:null,isError:!1,isSuccess:!0}):void 0)}),ct=(a,b,c)=>new Promise(d=>{let{changed:e}=a.send("PASSWORDLESS_SMS",{phoneNumber:b,options:c});if(!e)return d({error:bG,isError:!0,isSuccess:!1,needsOtp:!1});a.onTransition(a=>{a.matches("registration.incomplete.needsOtp")?d({error:null,isError:!1,isSuccess:!1,needsOtp:!0}):a.matches("registration.incomplete.failed")&&d({error:a.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),cu=(a,b,c)=>new Promise(d=>{let{changed:e}=a.send({type:"PASSWORDLESS_SMS_OTP",phoneNumber:b,otp:c});if(!e)return d({error:bG,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});a.onTransition(a=>{a.matches({authentication:"signedIn"})?d({error:null,isError:!1,isSuccess:!0,user:a.context.user,accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value}):a.matches({registration:{incomplete:"failed"}})&&d({error:a.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),cv=async(a,b)=>new Promise(c=>{let{event:d}=a.send("SIGNOUT",{all:b});if("SIGNED_OUT"!==d.type)return c({isSuccess:!1,isError:!0,error:bH});a.onTransition(a=>{a.matches({authentication:{signedOut:"success"}})?c({isSuccess:!0,isError:!1,error:null}):a.matches("authentication.signedOut.failed")&&c({isSuccess:!1,isError:!0,error:a.context.errors.signout||null})})}),cw=(a,b,c,d,e)=>new Promise(f=>{let{changed:g,context:h}=a.send("SIGNUP_EMAIL_PASSWORD",{email:b,password:c,options:d,requestOptions:e});if(!g)return f({error:bG,accessToken:h.accessToken.value,refreshToken:h.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:h.user});a.onTransition(a=>{a.matches("registration.incomplete.failed")?f({accessToken:null,refreshToken:null,error:a.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?f({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):a.matches({authentication:"signedIn",registration:"complete"})&&f({accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:a.context.user})})}),cx=(a,b,c,d)=>new Promise(e=>{let{changed:f,context:g}=a.send("SIGNUP_SECURITY_KEY",{email:b,options:c,requestOptions:d});if(!f)return e({error:bG,accessToken:g.accessToken.value,refreshToken:g.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:g.user});a.onTransition(a=>{a.matches("registration.incomplete.failed")?e({accessToken:null,refreshToken:null,error:a.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?e({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):a.matches({authentication:"signedIn",registration:"complete"})&&e({accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:a.context.user})})}),cy=(a,b,c)=>new Promise(d=>{let{changed:e}=a.send("SIGNIN_EMAIL_OTP",{email:b,options:c});if(!e)return d({error:bG,isError:!0,isSuccess:!1,needsOtp:!1});a.onTransition(a=>{a.matches("registration.incomplete.needsOtp")?d({error:null,isError:!1,isSuccess:!0,needsOtp:!0}):a.matches("registration.incomplete.failed")&&d({error:a.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),cz=(a,b,c)=>new Promise(d=>{let{changed:e}=a.send({type:"VERIFY_EMAIL_OTP",email:b,otp:c});if(!e)return d({error:bG,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});a.onTransition(a=>{a.matches({authentication:"signedIn"})?d({error:null,isError:!1,isSuccess:!0,user:a.context.user,accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value}):a.matches({registration:{incomplete:"failed"}})&&d({error:a.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),cA=(a,{provider:b,idToken:c,nonce:d})=>new Promise(e=>{let{changed:f}=a.send("SIGNIN_ID_TOKEN",{provider:b,idToken:c,...d&&{nonce:d}});f||e({isSuccess:!1,isError:!0,error:bG,user:null,accessToken:null,refreshToken:null}),a.onTransition(a=>a.matches({authentication:{signedOut:"failed"}})?e({accessToken:null,refreshToken:null,user:null,error:a.context.errors.authentication||null,isError:!0,isSuccess:!1}):a.matches({authentication:"signedIn"})?e({accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value,user:a.context.user,error:null,isError:!1,isSuccess:!0}):void 0)}),cB=async({backendUrl:a,interpreter:b},{provider:c,idToken:d,nonce:e})=>{try{return await b3(`${a}/link/idtoken`,{provider:c,idToken:d,...e&&{nonce:e}},null==b?void 0:b.getSnapshot().context.accessToken.value),{isError:!1,error:null,isSuccess:!0}}catch(b){let{error:a}=b;return{isError:!0,error:a,isSuccess:!1}}},cC=a=>new Promise(b=>{let{changed:c,context:d}=a.send({type:"SIGNIN_SECURITY_KEY"});if(!c)return b({accessToken:d.accessToken.value,refreshToken:d.refreshToken.value,error:bG,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:d.user});a.onTransition(a=>{a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?b({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):a.matches({authentication:{signedOut:"failed"}})?b({accessToken:null,refreshToken:null,error:a.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):a.matches({authentication:"signedIn"})&&b({accessToken:a.context.accessToken.value,refreshToken:a.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:a.context.user})})}),cD=async({backendUrl:a,interpreter:b},{expiresAt:c,metadata:d})=>{try{let{data:e}=await b3(`${a}/pat`,{expiresAt:c.toISOString(),metadata:d},null==b?void 0:b.getSnapshot().context.accessToken.value);return{data:e?{id:e.id||null,personalAccessToken:e.personalAccessToken||null}:null,isError:!1,error:null,isSuccess:!0}}catch(b){let{error:a}=b;return{isError:!0,error:a,isSuccess:!1,data:null}}};class cE{constructor({url:a,broadcastKey:b,autoRefreshToken:c=!0,autoSignIn:d=!0,clientStorage:e,clientStorageType:f,refreshIntervalTime:g,start:h=!0}){this.url=a,this._client=new cf({backendUrl:a,clientUrl:"",broadcastKey:b,autoRefreshToken:c,autoSignIn:d,start:h,clientStorage:e,clientStorageType:f,refreshIntervalTime:g})}async signUp(a,b){let c=await this.waitUntilReady();if("securityKey"in a){let{email:d,options:e}=a;return b0(await cx(c,d,e,b))}let{email:d,password:e,options:f}=a;return b0(await cw(c,d,e,f,b))}async connectProvider(a){let b=(await this.waitUntilReady()).getSnapshot().context.accessToken.value,{provider:c,options:d}=a;return{providerUrl:b4(`${this._client.backendUrl}/signin/provider/${c}`,b5(this._client.clientUrl,{...d,connect:b}))}}async signInIdToken(a){let b=await this.waitUntilReady();return{...b0(await cA(b,a)),mfa:null}}async linkIdToken(a){return cB(this._client,a)}async signIn(a){let b=await this.waitUntilReady();if(!a)return{...b0(await cl(b)),mfa:null};if("provider"in a){let{provider:b,options:c}=a;return{providerUrl:b4(`${this._client.backendUrl}/signin/provider/${b}`,b5(this._client.clientUrl,c)),provider:b,session:null,mfa:null,error:null}}if("email"in a&&"password"in a){let c=await cm(b,a.email,a.password);return c.needsEmailVerification?{session:null,mfa:null,error:bI}:c.needsMfaOtp?{session:null,mfa:c.mfa,error:null}:{...b0(c),mfa:null}}if("email"in a&&"securityKey"in a){if(!0!==a.securityKey)throw Error("securityKey must be true");return{...b0(await co(b,a.email)),mfa:null}}if("email"in a){let{email:c,options:d}=a,{error:e}=await cn(b,c,d);return{session:null,mfa:null,error:e}}if("phoneNumber"in a&&"otp"in a)return{...b0(await cu(b,a.phoneNumber,a.otp)),mfa:null};if("phoneNumber"in a){let{error:c}=await ct(b,a.phoneNumber,a.options);return{error:c,mfa:null,session:null}}return"otp"in a?{...b0(await cr(b,a.otp,a.ticket)),mfa:null}:{error:bK,mfa:null,session:null}}async signInPAT(a){let b=await this.waitUntilReady();return b0(await cs(b,a))}async signInEmailOTP(a,b){let c=await this.waitUntilReady(),{error:d}=await cy(c,a,b);return{error:d,session:null,mfa:null}}async verifyEmailOTP(a,b){let c=await this.waitUntilReady();return{...b0(await cz(c,a,b)),mfa:null}}async signInSecurityKey(){let a=await this.waitUntilReady();return{...b0(await cC(a)),mfa:null}}async signOut(a){let b=await this.waitUntilReady(),{error:c}=await cv(b,null==a?void 0:a.all);return{error:c}}async resetPassword({email:a,options:b}){let c=bq(cd(this._client)).start(),{error:d}=await cj(c,a,b);return{error:d}}async changePassword({newPassword:a,ticket:b}){let c=bq(cc(this._client)).start(),{error:d}=await ci(c,a,b);return{error:d}}async sendVerificationEmail({email:a,options:b}){let c=bq(ce(this._client)).start(),{error:d}=await ck(c,a,b);return{error:d}}async changeEmail({newEmail:a,options:b}){let c=bq(cb(this._client)).start(),{error:d}=await ch(c,a,b);return{error:d}}async deanonymize(a){let b=await this.waitUntilReady();if("passwordless"===a.signInMethod){if("email"===a.connection){let{error:c}=await cn(b,a.email,a.options);return{error:c}}if("sms"===a.connection){let{error:c}=await ct(b,a.phoneNumber,a.options);return{error:c}}}if("email-password"===a.signInMethod){let{error:c}=await cw(b,a.email,a.password,a.options);return{error:c}}throw Error("Unknown deanonymization method")}async addSecurityKey(a){let{error:b,key:c}=await cg(this._client,a);return{error:b,key:c}}async elevateEmailSecurityKey(a){if(!a)throw Error("A user email is required");return{...await cq(this._client,a),mfa:null}}async createPAT(a,b){return cD(this._client,{expiresAt:a,metadata:b})}onTokenChanged(a){return this._client.subscribe(()=>{var b;let c=null==(b=this._client.interpreter)?void 0:b.onTransition(({event:b,context:c})=>{"TOKEN_CHANGED"===b.type&&a(b_(c))});return()=>null==c?void 0:c.stop()})}onAuthStateChanged(a){return this._client.subscribe(()=>{var b;let c=null==(b=this._client.interpreter)?void 0:b.onTransition(({event:b,context:c})=>{("SIGNED_IN"===b.type||"SIGNED_OUT"===b.type)&&a(b.type,b_(c))});return()=>null==c?void 0:c.stop()})}isAuthenticated(){var a;return!!(null!=(a=this._client.interpreter)&&a.getSnapshot().matches({authentication:"signedIn"}))}async isAuthenticatedAsync(){return(await this.waitUntilReady()).getSnapshot().matches({authentication:"signedIn"})}getAuthenticationStatus(){var a;let b=(null==(a=this.client.interpreter)?void 0:a.getSnapshot().context.importTokenAttempts)||0;return this.isReady()?{isAuthenticated:this.isAuthenticated(),isLoading:!1,connectionAttempts:b}:{isAuthenticated:!1,isLoading:!0,connectionAttempts:b}}getAccessToken(){var a,b;return null!=(b=null==(a=this._client.interpreter)?void 0:a.getSnapshot().context.accessToken.value)?b:void 0}getDecodedAccessToken(){let a=this.getAccessToken();return a?c(a):null}getHasuraClaims(){var a;return(null==(a=this.getDecodedAccessToken())?void 0:a["https://hasura.io/jwt/claims"])||null}getHasuraClaim(a){var b;return(null==(b=this.getHasuraClaims())?void 0:b[a.startsWith("x-hasura-")?a:`x-hasura-${a}`])||null}async refreshSession(a){try{let b=await this.waitUntilReady();return new Promise(c=>{let d=a||b.getSnapshot().context.refreshToken.value;if(!d)return c({session:null,error:bE});let{changed:e}=b.send("TRY_TOKEN",{token:d});if(!e)return c({session:null,error:bF});b.onTransition(a=>{a.matches({token:{idle:"error"}})?c({session:null,error:bJ}):"TOKEN_CHANGED"===a.event.type&&c({session:b_(a.context),error:null})})})}catch(a){return{session:null,error:a.message}}}getSession(){var a,b;return b_(null==(b=null==(a=this._client.interpreter)?void 0:a.getSnapshot())?void 0:b.context)}async initWithSession({session:a}){this.client.start({initialSession:a}),await this.waitUntilReady()}getUser(){var a,b,c;return(null==(c=null==(b=null==(a=this._client.interpreter)?void 0:a.getSnapshot())?void 0:b.context)?void 0:c.user)||null}waitUntilReady(){let a=this._client.interpreter;if(!a)throw Error("Auth interpreter not set");return a.getSnapshot().hasTag("loading")?new Promise((b,c)=>{let d=setTimeout(()=>c("The state machine is not yet ready after 15 seconds."),15e3);a.onTransition(c=>{if(!c.hasTag("loading"))return clearTimeout(d),b(a)})}):Promise.resolve(a)}isReady(){var a,b;return!(null!=(b=null==(a=this._client.interpreter)?void 0:a.getSnapshot())&&b.hasTag("loading"))}get client(){return this._client}}var cF=Object.defineProperty,cG=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?cF(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};let cH=async(a,b,{accessToken:c,name:d,fileId:e,bucketId:f,adminSecret:g,onUploadProgress:h,headers:i={}}={})=>{var j;let k={...i};if(f&&b.append("bucket-id",f),g&&(k["x-hasura-admin-secret"]=g),c&&(k.Authorization=`Bearer ${c}`),(d||e)&&!b.has("metadata[]")){let a={};d&&(a.name=d),e&&(a.id=e),b.append("metadata[]",new Blob([JSON.stringify(a)],{type:"application/json"}),"")}let l=`${a}/files`;if("undefined"==typeof XMLHttpRequest)try{let a=await fetch(l,{method:"POST",headers:k,body:b}),c=await a.json();return a.ok?{fileMetadata:c,error:null}:{error:{status:a.status,message:(null==(j=null==c?void 0:c.error)?void 0:j.message)||a.statusText,error:a.statusText},fileMetadata:null}}catch(a){return{error:{status:0,message:a.message,error:a.message},fileMetadata:null}}return new Promise(a=>{let c=new XMLHttpRequest;c.responseType="json",c.onload=()=>{var b,d,e,f,g,h,i,j;return c.status<200||c.status>=300?a({fileMetadata:null,error:{error:null!=(g=null!=(f=null==(d=null==(b=c.response)?void 0:b.error)?void 0:d.message)?f:null==(e=c.response)?void 0:e.error)?g:c.response,message:null!=(j=null==(i=null==(h=c.response)?void 0:h.error)?void 0:i.message)?j:c.response,status:c.status}}):a({fileMetadata:c.response,error:null})},c.onerror=()=>a({fileMetadata:null,error:{error:c.statusText,message:c.statusText,status:c.status}}),h&&c.upload.addEventListener("progress",h,!1),c.open("POST",l,!0),Object.entries(k).forEach(([a,b])=>{c.setRequestHeader(a,b)}),c.send(b)})};function cI(a,b){if(!b||0===Object.keys(b).length)return a;let c=new URL(a);return Object.entries(Object.entries(b).reduce((a,[b,c])=>({...a,[b.charAt(0)]:c}),{})).forEach(([a,b])=>{b&&c.searchParams.set(a,b)}),c.toString()}class cJ{constructor({url:a}){cG(this,"url"),cG(this,"accessToken"),cG(this,"adminSecret"),cG(this,"headers",{}),this.url=a}async uploadFormData({formData:a,bucketId:b,headers:c}){let{error:d,fileMetadata:e}=await cH(this.url,a,{bucketId:b,headers:{...this.headers,...c},accessToken:this.accessToken,adminSecret:this.adminSecret});return d?{fileMetadata:null,error:d}:!e||"processedFiles"in e?{fileMetadata:e,error:null}:{fileMetadata:{processedFiles:[e]},error:null}}async uploadFile({file:a,bucketId:b,id:c,name:d,headers:e}){let f=new FormData;f.append("file[]",a),f.append("metadata[]",new Blob([JSON.stringify({id:c,name:d})],{type:"application/json"}),"");let{error:g,fileMetadata:h}=await cH(this.url,f,{accessToken:this.accessToken,adminSecret:this.adminSecret,bucketId:b,headers:{...this.headers,...e}});return g?{fileMetadata:null,error:g}:h&&"processedFiles"in h?{fileMetadata:h.processedFiles[0],error:null}:{fileMetadata:h,error:null}}async downloadFile(a){try{let{fileId:b,headers:c,...d}=a,e=cI(`${this.url}/files/${b}`,d),f=await fetch(e,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...c}});if(!f.ok)throw Error(await f.text());return{file:await f.blob(),error:null}}catch(a){return{file:null,error:a}}}async getPresignedUrl(a){try{let{fileId:b,headers:c}=a,d=await fetch(`${this.url}/files/${b}/presignedurl`,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...c}});if(!d.ok)throw Error(await d.text());return{presignedUrl:await d.json(),error:null}}catch(a){return{presignedUrl:null,error:a}}}async delete(a){try{let{fileId:b,headers:c}=a,d=await fetch(`${this.url}/files/${b}`,{method:"DELETE",headers:{...this.generateAuthHeaders(),...this.headers,...c}});if(!d.ok)throw Error(await d.text());return{error:null}}catch(a){return{error:a}}}setAccessToken(a){return this.accessToken=a,this}setAdminSecret(a){return this.adminSecret=a,this}getHeaders(){return this.headers}setHeaders(a){return a&&(this.headers={...this.headers,...a}),this}unsetHeaders(){let a=this.headers["x-hasura-role"];return this.headers=a?{"x-hasura-role":a}:{},this}generateAuthHeaders(){if(!(!this.adminSecret&&!this.accessToken))return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:{Authorization:`Bearer ${this.accessToken}`}}}class cK{constructor({url:a,adminSecret:b}){cG(this,"url"),cG(this,"api"),this.url=a,this.api=new cJ({url:a}),this.setAdminSecret(b)}async upload(a){return"file"in a?this.api.uploadFile(a):this.api.uploadFormData(a)}getPublicUrl(a){let{fileId:b,...c}=a;return cI(`${this.url}/files/${b}`,c)}async getPresignedUrl(a){let{fileId:b,headers:c,...d}=a,{presignedUrl:e,error:f}=await this.api.getPresignedUrl(a);if(f)return{presignedUrl:null,error:f};if(!e)return{presignedUrl:null,error:Error("Invalid file id")};let g=cI(e.url,d);return{presignedUrl:{...e,url:g},error:null}}async download(a){let{file:b,error:c}=await this.api.downloadFile(a);return c?{file:null,error:c}:b?{file:b,error:null}:{file:null,error:Error("File does not exist")}}async delete(a){let{error:b}=await this.api.delete(a);return b?{error:b}:{error:null}}setAccessToken(a){return this.api.setAccessToken(a),this}setAdminSecret(a){return this.api.setAdminSecret(a),this}getHeaders(){return this.api.getHeaders()}setHeaders(a){return this.api.setHeaders(a),this}unsetHeaders(){return this.api.unsetHeaders(),this}}let cL={progress:null,loaded:0,error:null,bucketId:void 0,file:void 0,id:void 0},cM=()=>bg({predictableActionArguments:!0,schema:{context:{},events:{}},tsTypes:{},context:{...cL},initial:"idle",on:{DESTROY:{actions:"sendDestroy",target:"stopped"}},states:{idle:{on:{ADD:{actions:"addFile"},UPLOAD:{cond:"hasFile",target:"uploading"}}},uploading:{entry:"resetProgress",on:{UPLOAD_PROGRESS:{actions:["incrementProgress","sendProgress"]},UPLOAD_DONE:"uploaded",UPLOAD_ERROR:"error",CANCEL:"idle"},invoke:{src:"uploadFile"}},uploaded:{entry:["setFileMetadata","sendDone"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},error:{entry:["setError","sendError"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},stopped:{type:"final"}}},{guards:{hasFile:(a,b)=>!!a.file||!!b.file},actions:{incrementProgress:aX({loaded:(a,{loaded:b})=>b,progress:(a,{progress:b})=>b}),setFileMetadata:aX({id:(a,{id:b})=>b,bucketId:(a,{bucketId:b})=>b,progress:a=>100}),setError:aX({error:(a,{error:b})=>b}),sendProgress:()=>{},sendError:()=>{},sendDestroy:()=>{},sendDone:()=>{},resetProgress:aX({progress:a=>null,loaded:a=>0}),resetContext:aX(a=>cL),addFile:aX({file:(a,{file:b})=>b,bucketId:(a,{bucketId:b})=>b,id:(a,{id:b})=>b})},services:{uploadFile:(a,b)=>c=>{let d=b.file||a.file,e=new FormData;e.append("file[]",d);let f=0;return cH(b.url,e,{fileId:b.id||a.id,bucketId:b.bucketId||a.bucketId,accessToken:b.accessToken,adminSecret:b.adminSecret,name:b.name||d.name,onUploadProgress:a=>{let b=a.total?Math.round(a.loaded*d.size/a.total):0,e=b-f;f=b,c({type:"UPLOAD_PROGRESS",progress:a.total?Math.round(100*b/a.total):0,loaded:b,additions:e})}}).then(({fileMetadata:a,error:b})=>{if(b&&c({type:"UPLOAD_ERROR",error:b}),a&&!("processedFiles"in a)){let{id:b,bucketId:d}=a;c({type:"UPLOAD_DONE",id:b,bucketId:d})}if(a&&"processedFiles"in a){let{id:b,bucketId:d}=a.processedFiles[0];c({type:"UPLOAD_DONE",id:b,bucketId:d})}}),()=>{}}}}),{pure:cN,sendParent:cO}=bh,cP=()=>bg({id:"files-list",schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,context:{progress:null,files:[],loaded:0,total:0},initial:"idle",on:{UPLOAD:{cond:"hasFileToDownload",actions:"addItem",target:"uploading"},ADD:{actions:"addItem"},REMOVE:{actions:"removeItem"}},states:{idle:{entry:["resetProgress","resetLoaded","resetTotal"],on:{CLEAR:{actions:"clearList",target:"idle"}}},uploading:{entry:["upload","startProgress","resetLoaded","resetTotal"],on:{UPLOAD_PROGRESS:{actions:["incrementProgress"]},UPLOAD_DONE:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],UPLOAD_ERROR:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],CANCEL:{actions:"cancel",target:"idle"}}},uploaded:{entry:"setUploaded",on:{CLEAR:{actions:"clearList",target:"idle"}}},error:{on:{CLEAR:{actions:"clearList",target:"idle"}}}}},{guards:{hasFileToDownload:(a,b)=>a.files.some(a=>a.getSnapshot().matches("idle"))||!!b.files,isAllUploaded:a=>a.files.every(a=>{var b;return null==(b=a.getSnapshot())?void 0:b.matches("uploaded")}),isAllUploadedOrError:a=>a.files.every(a=>{let b=a.getSnapshot();return(null==b?void 0:b.matches("error"))||(null==b?void 0:b.matches("uploaded"))})},actions:{incrementProgress:aX((a,b)=>{let c=a.loaded+b.additions,d=Math.round(100*c/a.total);return{...a,loaded:c,progress:d}}),setUploaded:aX({progress:a=>100,loaded:({files:a})=>a.map(a=>a.getSnapshot()).filter(a=>a.matches("uploaded")).reduce((a,b)=>{var c;return a+(null==(c=b.context.file)?void 0:c.size)},0)}),resetTotal:aX({total:({files:a})=>a.map(a=>a.getSnapshot()).filter(a=>!a.matches("uploaded")).reduce((a,b)=>{var c;return a+(null==(c=b.context.file)?void 0:c.size)},0)}),resetLoaded:aX({loaded:a=>0}),startProgress:aX({progress:a=>0}),resetProgress:aX({progress:a=>null}),addItem:aX((a,{files:b,bucketId:c})=>{let d=b?Array.isArray(b)?b:"item"in b?Array.from(b):[b]:[],e=a.total+d.reduce((a,b)=>a+b.size,0),f=Math.round(100*a.loaded/e);return{files:[...a.files,...d.map(a=>(function(a,b){var c=ah(b)?t(t({},bo),{name:b}):t(t(t({},bo),{name:al()}),b),d=a8[a8.length-1];return d?d.spawn(a,c.name,c):bb(a,c.name)})(cM().withConfig({actions:{sendProgress:cO((a,{additions:b})=>({type:"UPLOAD_PROGRESS",additions:b})),sendDone:cO("UPLOAD_DONE"),sendError:cO("UPLOAD_ERROR"),sendDestroy:cO("REMOVE")}}).withContext({...cL,file:a,bucketId:c}),{sync:!0}))],total:e,loaded:a.loaded,progress:f}}),removeItem:aX({files:a=>a.files.filter(a=>{var b,c;let d=null==(b=a.getSnapshot())?void 0:b.matches("stopped");return d&&(null==(c=a.stop)||c.call(a)),!d})}),clearList:cN(a=>a.files.map(a=>aK({type:"DESTROY"},{to:a.id}))),upload:cN((a,b)=>a.files.map(a=>aK(b,{to:a.id}))),cancel:cN(a=>a.files.map(a=>aK({type:"CANCEL"},{to:a.id})))}}),cQ=async(a,b)=>new Promise(c=>{b.send({type:"UPLOAD",...a}),b.subscribe(a=>{var b;a.matches("error")?c({error:a.context.error,isError:!0,isUploaded:!1}):a.matches("uploaded")&&c({error:null,isError:!1,isUploaded:!0,id:a.context.id,bucketId:a.context.id,name:null==(b=a.context.file)?void 0:b.name})})}),cR=async(a,b)=>new Promise(c=>{b.send({type:"UPLOAD",...a,files:a.files}),b.onTransition(a=>{a.matches("error")?c({errors:a.context.files.filter(a=>{var b;return null==(b=a.getSnapshot())?void 0:b.context.error}),isError:!0,files:[]}):a.matches("uploaded")&&c({errors:[],isError:!1,files:a.context.files})})});var cS=a.i(86936);let cT=/\r\n|[\n\r]/g;function cU(a,b){let c=0,d=1;for(let e of a.body.matchAll(cT)){if("number"==typeof e.index||function(a,b){if(!a)throw Error("Unexpected invariant triggered.")}(!1),e.index>=b)break;c=e.index+e[0].length,d+=1}return{line:d,column:b+1-c}}function cV(a,b){let c=a.locationOffset.column-1,d="".padStart(c)+a.body,e=b.line-1,f=a.locationOffset.line-1,g=b.line+f,h=1===b.line?c:0,i=b.column+h,j=`${a.name}:${g}:${i}
`,k=d.split(/\r\n|[\n\r]/g),l=k[e];if(l.length>120){let a=Math.floor(i/80),b=[];for(let a=0;a<l.length;a+=80)b.push(l.slice(a,a+80));return j+cW([[`${g} |`,b[0]],...b.slice(1,a+1).map(a=>["|",a]),["|","^".padStart(i%80)],["|",b[a+1]]])}return j+cW([[`${g-1} |`,k[e-1]],[`${g} |`,l],["|","^".padStart(i)],[`${g+1} |`,k[e+1]]])}function cW(a){let b=a.filter(([a,b])=>void 0!==b),c=Math.max(...b.map(([a])=>a.length));return b.map(([a,b])=>a.padStart(c)+(b?" "+b:"")).join("\n")}class cX extends Error{constructor(a,...b){var c,d,e;const{nodes:f,source:g,positions:h,path:i,originalError:j,extensions:k}=function(a){let b=a[0];return null==b||"kind"in b||"length"in b?{nodes:b,source:a[1],positions:a[2],path:a[3],originalError:a[4],extensions:a[5]}:b}(b);super(a),this.name="GraphQLError",this.path=null!=i?i:void 0,this.originalError=null!=j?j:void 0,this.nodes=cY(Array.isArray(f)?f:f?[f]:void 0);const l=cY(null==(c=this.nodes)?void 0:c.map(a=>a.loc).filter(a=>null!=a));this.source=null!=g?g:null==l||null==(d=l[0])?void 0:d.source,this.positions=null!=h?h:null==l?void 0:l.map(a=>a.start),this.locations=h&&g?h.map(a=>cU(g,a)):null==l?void 0:l.map(a=>cU(a.source,a.start));const m=!function(a){return"object"==typeof a&&null!==a}(null==j?void 0:j.extensions)||null==j?void 0:j.extensions;this.extensions=null!=(e=null!=k?k:m)?e:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!=j&&j.stack?Object.defineProperty(this,"stack",{value:j.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,cX):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let a=this.message;if(this.nodes)for(let c of this.nodes){var b;c.loc&&(a+="\n\n"+cV((b=c.loc).source,cU(b.source,b.start)))}else if(this.source&&this.locations)for(let b of this.locations)a+="\n\n"+cV(this.source,b);return a}toJSON(){let a={message:this.message};return null!=this.locations&&(a.locations=this.locations),null!=this.path&&(a.path=this.path),null!=this.extensions&&Object.keys(this.extensions).length>0&&(a.extensions=this.extensions),a}}function cY(a){return void 0===a||0===a.length?void 0:a}function cZ(a,b,c){return new cX(`Syntax Error: ${c}`,{source:a,positions:[b]})}class c${constructor(a,b,c){this.start=a.start,this.end=b.end,this.startToken=a,this.endToken=b,this.source=c}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class c_{constructor(a,b,c,d,e,f){this.kind=a,this.start=b,this.end=c,this.line=d,this.column=e,this.value=f,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}let c0={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},c1=new Set(Object.keys(c0));function c2(a){let b=null==a?void 0:a.kind;return"string"==typeof b&&c1.has(b)}function c3(a){return 9===a||32===a}function c4(a){return a>=48&&a<=57}function c5(a){return a>=97&&a<=122||a>=65&&a<=90}function c6(a){return c5(a)||95===a}(h=p||(p={})).QUERY="query",h.MUTATION="mutation",h.SUBSCRIPTION="subscription",(i=q||(q={})).QUERY="QUERY",i.MUTATION="MUTATION",i.SUBSCRIPTION="SUBSCRIPTION",i.FIELD="FIELD",i.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",i.FRAGMENT_SPREAD="FRAGMENT_SPREAD",i.INLINE_FRAGMENT="INLINE_FRAGMENT",i.VARIABLE_DEFINITION="VARIABLE_DEFINITION",i.SCHEMA="SCHEMA",i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.FIELD_DEFINITION="FIELD_DEFINITION",i.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.ENUM_VALUE="ENUM_VALUE",i.INPUT_OBJECT="INPUT_OBJECT",i.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION",(j=r||(r={})).NAME="Name",j.DOCUMENT="Document",j.OPERATION_DEFINITION="OperationDefinition",j.VARIABLE_DEFINITION="VariableDefinition",j.SELECTION_SET="SelectionSet",j.FIELD="Field",j.ARGUMENT="Argument",j.FRAGMENT_SPREAD="FragmentSpread",j.INLINE_FRAGMENT="InlineFragment",j.FRAGMENT_DEFINITION="FragmentDefinition",j.VARIABLE="Variable",j.INT="IntValue",j.FLOAT="FloatValue",j.STRING="StringValue",j.BOOLEAN="BooleanValue",j.NULL="NullValue",j.ENUM="EnumValue",j.LIST="ListValue",j.OBJECT="ObjectValue",j.OBJECT_FIELD="ObjectField",j.DIRECTIVE="Directive",j.NAMED_TYPE="NamedType",j.LIST_TYPE="ListType",j.NON_NULL_TYPE="NonNullType",j.SCHEMA_DEFINITION="SchemaDefinition",j.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",j.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",j.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",j.FIELD_DEFINITION="FieldDefinition",j.INPUT_VALUE_DEFINITION="InputValueDefinition",j.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",j.UNION_TYPE_DEFINITION="UnionTypeDefinition",j.ENUM_TYPE_DEFINITION="EnumTypeDefinition",j.ENUM_VALUE_DEFINITION="EnumValueDefinition",j.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",j.DIRECTIVE_DEFINITION="DirectiveDefinition",j.SCHEMA_EXTENSION="SchemaExtension",j.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",j.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",j.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",j.UNION_TYPE_EXTENSION="UnionTypeExtension",j.ENUM_TYPE_EXTENSION="EnumTypeExtension",j.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension",(k=s||(s={})).SOF="<SOF>",k.EOF="<EOF>",k.BANG="!",k.DOLLAR="$",k.AMP="&",k.PAREN_L="(",k.PAREN_R=")",k.SPREAD="...",k.COLON=":",k.EQUALS="=",k.AT="@",k.BRACKET_L="[",k.BRACKET_R="]",k.BRACE_L="{",k.PIPE="|",k.BRACE_R="}",k.NAME="Name",k.INT="Int",k.FLOAT="Float",k.STRING="String",k.BLOCK_STRING="BlockString",k.COMMENT="Comment";class c7{constructor(a){const b=new c_(s.SOF,0,0,0,0);this.source=a,this.lastToken=b,this.token=b,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let a=this.token;if(a.kind!==s.EOF)do if(a.next)a=a.next;else{let b=function(a,b){let c=a.source.body,d=c.length,e=b;for(;e<d;){let b=c.charCodeAt(e);switch(b){case 65279:case 9:case 32:case 44:++e;continue;case 10:++e,++a.line,a.lineStart=e;continue;case 13:10===c.charCodeAt(e+1)?e+=2:++e,++a.line,a.lineStart=e;continue;case 35:return function(a,b){let c=a.source.body,d=c.length,e=b+1;for(;e<d;){let a=c.charCodeAt(e);if(10===a||13===a)break;if(c8(a))++e;else if(c9(c,e))e+=2;else break}return dd(a,s.COMMENT,b,e,c.slice(b+1,e))}(a,e);case 33:return dd(a,s.BANG,e,e+1);case 36:return dd(a,s.DOLLAR,e,e+1);case 38:return dd(a,s.AMP,e,e+1);case 40:return dd(a,s.PAREN_L,e,e+1);case 41:return dd(a,s.PAREN_R,e,e+1);case 46:if(46===c.charCodeAt(e+1)&&46===c.charCodeAt(e+2))return dd(a,s.SPREAD,e,e+3);break;case 58:return dd(a,s.COLON,e,e+1);case 61:return dd(a,s.EQUALS,e,e+1);case 64:return dd(a,s.AT,e,e+1);case 91:return dd(a,s.BRACKET_L,e,e+1);case 93:return dd(a,s.BRACKET_R,e,e+1);case 123:return dd(a,s.BRACE_L,e,e+1);case 124:return dd(a,s.PIPE,e,e+1);case 125:return dd(a,s.BRACE_R,e,e+1);case 34:if(34===c.charCodeAt(e+1)&&34===c.charCodeAt(e+2))return function(a,b){let c=a.source.body,d=c.length,e=a.lineStart,f=b+3,g=f,h="",i=[];for(;f<d;){let d=c.charCodeAt(f);if(34===d&&34===c.charCodeAt(f+1)&&34===c.charCodeAt(f+2)){h+=c.slice(g,f),i.push(h);let d=dd(a,s.BLOCK_STRING,b,f+3,(function(a){var b,c;let d=Number.MAX_SAFE_INTEGER,e=null,f=-1;for(let b=0;b<a.length;++b){let g=a[b],h=function(a){let b=0;for(;b<a.length&&c3(a.charCodeAt(b));)++b;return b}(g);h!==g.length&&(e=null!=(c=e)?c:b,f=b,0!==b&&h<d&&(d=h))}return a.map((a,b)=>0===b?a:a.slice(d)).slice(null!=(b=e)?b:0,f+1)})(i).join("\n"));return a.line+=i.length-1,a.lineStart=e,d}if(92===d&&34===c.charCodeAt(f+1)&&34===c.charCodeAt(f+2)&&34===c.charCodeAt(f+3)){h+=c.slice(g,f),g=f+1,f+=4;continue}if(10===d||13===d){h+=c.slice(g,f),i.push(h),13===d&&10===c.charCodeAt(f+1)?f+=2:++f,h="",g=f,e=f;continue}if(c8(d))++f;else if(c9(c,f))f+=2;else throw cZ(a.source,f,`Invalid character within String: ${dc(a,f)}.`)}throw cZ(a.source,f,"Unterminated string.")}(a,e);return function(a,b){let c=a.source.body,d=c.length,e=b+1,f=e,g="";for(;e<d;){let d=c.charCodeAt(e);if(34===d)return g+=c.slice(f,e),dd(a,s.STRING,b,e+1,g);if(92===d){g+=c.slice(f,e);let b=117===c.charCodeAt(e+1)?123===c.charCodeAt(e+2)?function(a,b){let c=a.source.body,d=0,e=3;for(;e<12;){let a=c.charCodeAt(b+e++);if(125===a){if(e<5||!c8(d))break;return{value:String.fromCodePoint(d),size:e}}if((d=d<<4|dg(a))<0)break}throw cZ(a.source,b,`Invalid Unicode escape sequence: "${c.slice(b,b+e)}".`)}(a,e):function(a,b){let c=a.source.body,d=df(c,b+2);if(c8(d))return{value:String.fromCodePoint(d),size:6};if(da(d)&&92===c.charCodeAt(b+6)&&117===c.charCodeAt(b+7)){let a=df(c,b+8);if(db(a))return{value:String.fromCodePoint(d,a),size:12}}throw cZ(a.source,b,`Invalid Unicode escape sequence: "${c.slice(b,b+6)}".`)}(a,e):function(a,b){let c=a.source.body;switch(c.charCodeAt(b+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:"\n",size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw cZ(a.source,b,`Invalid character escape sequence: "${c.slice(b,b+2)}".`)}(a,e);g+=b.value,e+=b.size,f=e;continue}if(10===d||13===d)break;if(c8(d))++e;else if(c9(c,e))e+=2;else throw cZ(a.source,e,`Invalid character within String: ${dc(a,e)}.`)}throw cZ(a.source,e,"Unterminated string.")}(a,e)}if(c4(b)||45===b)return function(a,b,c){let d=a.source.body,e=b,f=c,g=!1;if(45===f&&(f=d.charCodeAt(++e)),48===f){if(c4(f=d.charCodeAt(++e)))throw cZ(a.source,e,`Invalid number, unexpected digit after 0: ${dc(a,e)}.`)}else e=de(a,e,f),f=d.charCodeAt(e);if(46===f&&(g=!0,f=d.charCodeAt(++e),e=de(a,e,f),f=d.charCodeAt(e)),(69===f||101===f)&&(g=!0,(43===(f=d.charCodeAt(++e))||45===f)&&(f=d.charCodeAt(++e)),e=de(a,e,f),f=d.charCodeAt(e)),46===f||c6(f))throw cZ(a.source,e,`Invalid number, expected digit but got: ${dc(a,e)}.`);return dd(a,g?s.FLOAT:s.INT,b,e,d.slice(b,e))}(a,e,b);if(c6(b))return function(a,b){let c=a.source.body,d=c.length,e=b+1;for(;e<d;){var f;if(c5(f=c.charCodeAt(e))||c4(f)||95===f)++e;else break}return dd(a,s.NAME,b,e,c.slice(b,e))}(a,e);throw cZ(a.source,e,39===b?"Unexpected single quote character ('), did you mean to use a double quote (\")?":c8(b)||c9(c,e)?`Unexpected character: ${dc(a,e)}.`:`Invalid character: ${dc(a,e)}.`)}return dd(a,s.EOF,d,d)}(this,a.end);a.next=b,b.prev=a,a=b}while(a.kind===s.COMMENT)return a}}function c8(a){return a>=0&&a<=55295||a>=57344&&a<=1114111}function c9(a,b){return da(a.charCodeAt(b))&&db(a.charCodeAt(b+1))}function da(a){return a>=55296&&a<=56319}function db(a){return a>=56320&&a<=57343}function dc(a,b){let c=a.source.body.codePointAt(b);if(void 0===c)return s.EOF;if(c>=32&&c<=126){let a=String.fromCodePoint(c);return'"'===a?"'\"'":`"${a}"`}return"U+"+c.toString(16).toUpperCase().padStart(4,"0")}function dd(a,b,c,d,e){let f=a.line,g=1+c-a.lineStart;return new c_(b,c,d,f,g,e)}function de(a,b,c){if(!c4(c))throw cZ(a.source,b,`Invalid number, expected digit but got: ${dc(a,b)}.`);let d=a.source.body,e=b+1;for(;c4(d.charCodeAt(e));)++e;return e}function df(a,b){return dg(a.charCodeAt(b))<<12|dg(a.charCodeAt(b+1))<<8|dg(a.charCodeAt(b+2))<<4|dg(a.charCodeAt(b+3))}function dg(a){return a>=48&&a<=57?a-48:a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:-1}function dh(a,b){if(!a)throw Error(b)}function di(a,b){switch(typeof a){case"string":return JSON.stringify(a);case"function":return a.name?`[function ${a.name}]`:"[function]";case"object":return function(a,b){let c;if(null===a)return"null";if(b.includes(a))return"[Circular]";let d=[...b,a];if("function"==typeof a.toJSON){let b=a.toJSON();if(b!==a)return"string"==typeof b?b:di(b,d)}else if(Array.isArray(a)){var e,f,g=a,h=d;if(0===g.length)return"[]";if(h.length>2)return"[Array]";let b=Math.min(10,g.length),c=g.length-b,i=[];for(let a=0;a<b;++a)i.push(di(g[a],h));return 1===c?i.push("... 1 more item"):c>1&&i.push(`... ${c} more items`),"["+i.join(", ")+"]"}return e=a,f=d,0===(c=Object.entries(e)).length?"{}":f.length>2?"["+function(a){let b=Object.prototype.toString.call(a).replace(/^\[object /,"").replace(/]$/,"");if("Object"===b&&"function"==typeof a.constructor){let b=a.constructor.name;if("string"==typeof b&&""!==b)return b}return b}(e)+"]":"{ "+c.map(([a,b])=>a+": "+di(b,f)).join(", ")+" }"}(a,b);default:return String(a)}}let dj=globalThis.process&&"production"===globalThis.process.env.NODE_ENV?function(a,b){return a instanceof b}:function(a,b){if(a instanceof b)return!0;if("object"==typeof a&&null!==a){var c;let d=b.prototype[Symbol.toStringTag];if(d===(Symbol.toStringTag in a?a[Symbol.toStringTag]:null==(c=a.constructor)?void 0:c.name)){let b=di(a,[]);throw Error(`Cannot use ${d} "${b}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class dk{constructor(a,b="GraphQL request",c={line:1,column:1}){"string"==typeof a||dh(!1,`Body must be a string. Received: ${di(a,[])}.`),this.body=a,this.name=b,this.locationOffset=c,this.locationOffset.line>0||dh(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||dh(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}class dl{constructor(a,b={}){const c=dj(a,dk)?a:new dk(a);this._lexer=new c7(c),this._options=b,this._tokenCounter=0}parseName(){let a=this.expectToken(s.NAME);return this.node(a,{kind:r.NAME,value:a.value})}parseDocument(){return this.node(this._lexer.token,{kind:r.DOCUMENT,definitions:this.many(s.SOF,this.parseDefinition,s.EOF)})}parseDefinition(){if(this.peek(s.BRACE_L))return this.parseOperationDefinition();let a=this.peekDescription(),b=a?this._lexer.lookahead():this._lexer.token;if(b.kind===s.NAME){switch(b.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(a)throw cZ(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(b.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(b)}parseOperationDefinition(){let a,b=this._lexer.token;if(this.peek(s.BRACE_L))return this.node(b,{kind:r.OPERATION_DEFINITION,operation:p.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});let c=this.parseOperationType();return this.peek(s.NAME)&&(a=this.parseName()),this.node(b,{kind:r.OPERATION_DEFINITION,operation:c,name:a,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){let a=this.expectToken(s.NAME);switch(a.value){case"query":return p.QUERY;case"mutation":return p.MUTATION;case"subscription":return p.SUBSCRIPTION}throw this.unexpected(a)}parseVariableDefinitions(){return this.optionalMany(s.PAREN_L,this.parseVariableDefinition,s.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:r.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(s.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(s.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){let a=this._lexer.token;return this.expectToken(s.DOLLAR),this.node(a,{kind:r.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:r.SELECTION_SET,selections:this.many(s.BRACE_L,this.parseSelection,s.BRACE_R)})}parseSelection(){return this.peek(s.SPREAD)?this.parseFragment():this.parseField()}parseField(){let a,b,c=this._lexer.token,d=this.parseName();return this.expectOptionalToken(s.COLON)?(a=d,b=this.parseName()):b=d,this.node(c,{kind:r.FIELD,alias:a,name:b,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(s.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(a){let b=a?this.parseConstArgument:this.parseArgument;return this.optionalMany(s.PAREN_L,b,s.PAREN_R)}parseArgument(a=!1){let b=this._lexer.token,c=this.parseName();return this.expectToken(s.COLON),this.node(b,{kind:r.ARGUMENT,name:c,value:this.parseValueLiteral(a)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){let a=this._lexer.token;this.expectToken(s.SPREAD);let b=this.expectOptionalKeyword("on");return!b&&this.peek(s.NAME)?this.node(a,{kind:r.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(a,{kind:r.INLINE_FRAGMENT,typeCondition:b?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){let a=this._lexer.token;return(this.expectKeyword("fragment"),!0===this._options.allowLegacyFragmentVariables)?this.node(a,{kind:r.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(a,{kind:r.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()}parseValueLiteral(a){let b=this._lexer.token;switch(b.kind){case s.BRACKET_L:return this.parseList(a);case s.BRACE_L:return this.parseObject(a);case s.INT:return this.advanceLexer(),this.node(b,{kind:r.INT,value:b.value});case s.FLOAT:return this.advanceLexer(),this.node(b,{kind:r.FLOAT,value:b.value});case s.STRING:case s.BLOCK_STRING:return this.parseStringLiteral();case s.NAME:switch(this.advanceLexer(),b.value){case"true":return this.node(b,{kind:r.BOOLEAN,value:!0});case"false":return this.node(b,{kind:r.BOOLEAN,value:!1});case"null":return this.node(b,{kind:r.NULL});default:return this.node(b,{kind:r.ENUM,value:b.value})}case s.DOLLAR:if(a){if(this.expectToken(s.DOLLAR),this._lexer.token.kind===s.NAME){let a=this._lexer.token.value;throw cZ(this._lexer.source,b.start,`Unexpected variable "$${a}" in constant value.`)}throw this.unexpected(b)}return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){let a=this._lexer.token;return this.advanceLexer(),this.node(a,{kind:r.STRING,value:a.value,block:a.kind===s.BLOCK_STRING})}parseList(a){let b=()=>this.parseValueLiteral(a);return this.node(this._lexer.token,{kind:r.LIST,values:this.any(s.BRACKET_L,b,s.BRACKET_R)})}parseObject(a){let b=()=>this.parseObjectField(a);return this.node(this._lexer.token,{kind:r.OBJECT,fields:this.any(s.BRACE_L,b,s.BRACE_R)})}parseObjectField(a){let b=this._lexer.token,c=this.parseName();return this.expectToken(s.COLON),this.node(b,{kind:r.OBJECT_FIELD,name:c,value:this.parseValueLiteral(a)})}parseDirectives(a){let b=[];for(;this.peek(s.AT);)b.push(this.parseDirective(a));return b}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(a){let b=this._lexer.token;return this.expectToken(s.AT),this.node(b,{kind:r.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(a)})}parseTypeReference(){let a,b=this._lexer.token;if(this.expectOptionalToken(s.BRACKET_L)){let c=this.parseTypeReference();this.expectToken(s.BRACKET_R),a=this.node(b,{kind:r.LIST_TYPE,type:c})}else a=this.parseNamedType();return this.expectOptionalToken(s.BANG)?this.node(b,{kind:r.NON_NULL_TYPE,type:a}):a}parseNamedType(){return this.node(this._lexer.token,{kind:r.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(s.STRING)||this.peek(s.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){let a=this._lexer.token,b=this.parseDescription();this.expectKeyword("schema");let c=this.parseConstDirectives(),d=this.many(s.BRACE_L,this.parseOperationTypeDefinition,s.BRACE_R);return this.node(a,{kind:r.SCHEMA_DEFINITION,description:b,directives:c,operationTypes:d})}parseOperationTypeDefinition(){let a=this._lexer.token,b=this.parseOperationType();this.expectToken(s.COLON);let c=this.parseNamedType();return this.node(a,{kind:r.OPERATION_TYPE_DEFINITION,operation:b,type:c})}parseScalarTypeDefinition(){let a=this._lexer.token,b=this.parseDescription();this.expectKeyword("scalar");let c=this.parseName(),d=this.parseConstDirectives();return this.node(a,{kind:r.SCALAR_TYPE_DEFINITION,description:b,name:c,directives:d})}parseObjectTypeDefinition(){let a=this._lexer.token,b=this.parseDescription();this.expectKeyword("type");let c=this.parseName(),d=this.parseImplementsInterfaces(),e=this.parseConstDirectives(),f=this.parseFieldsDefinition();return this.node(a,{kind:r.OBJECT_TYPE_DEFINITION,description:b,name:c,interfaces:d,directives:e,fields:f})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(s.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(s.BRACE_L,this.parseFieldDefinition,s.BRACE_R)}parseFieldDefinition(){let a=this._lexer.token,b=this.parseDescription(),c=this.parseName(),d=this.parseArgumentDefs();this.expectToken(s.COLON);let e=this.parseTypeReference(),f=this.parseConstDirectives();return this.node(a,{kind:r.FIELD_DEFINITION,description:b,name:c,arguments:d,type:e,directives:f})}parseArgumentDefs(){return this.optionalMany(s.PAREN_L,this.parseInputValueDef,s.PAREN_R)}parseInputValueDef(){let a,b=this._lexer.token,c=this.parseDescription(),d=this.parseName();this.expectToken(s.COLON);let e=this.parseTypeReference();this.expectOptionalToken(s.EQUALS)&&(a=this.parseConstValueLiteral());let f=this.parseConstDirectives();return this.node(b,{kind:r.INPUT_VALUE_DEFINITION,description:c,name:d,type:e,defaultValue:a,directives:f})}parseInterfaceTypeDefinition(){let a=this._lexer.token,b=this.parseDescription();this.expectKeyword("interface");let c=this.parseName(),d=this.parseImplementsInterfaces(),e=this.parseConstDirectives(),f=this.parseFieldsDefinition();return this.node(a,{kind:r.INTERFACE_TYPE_DEFINITION,description:b,name:c,interfaces:d,directives:e,fields:f})}parseUnionTypeDefinition(){let a=this._lexer.token,b=this.parseDescription();this.expectKeyword("union");let c=this.parseName(),d=this.parseConstDirectives(),e=this.parseUnionMemberTypes();return this.node(a,{kind:r.UNION_TYPE_DEFINITION,description:b,name:c,directives:d,types:e})}parseUnionMemberTypes(){return this.expectOptionalToken(s.EQUALS)?this.delimitedMany(s.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){let a=this._lexer.token,b=this.parseDescription();this.expectKeyword("enum");let c=this.parseName(),d=this.parseConstDirectives(),e=this.parseEnumValuesDefinition();return this.node(a,{kind:r.ENUM_TYPE_DEFINITION,description:b,name:c,directives:d,values:e})}parseEnumValuesDefinition(){return this.optionalMany(s.BRACE_L,this.parseEnumValueDefinition,s.BRACE_R)}parseEnumValueDefinition(){let a=this._lexer.token,b=this.parseDescription(),c=this.parseEnumValueName(),d=this.parseConstDirectives();return this.node(a,{kind:r.ENUM_VALUE_DEFINITION,description:b,name:c,directives:d})}parseEnumValueName(){if("true"===this._lexer.token.value||"false"===this._lexer.token.value||"null"===this._lexer.token.value)throw cZ(this._lexer.source,this._lexer.token.start,`${dm(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){let a=this._lexer.token,b=this.parseDescription();this.expectKeyword("input");let c=this.parseName(),d=this.parseConstDirectives(),e=this.parseInputFieldsDefinition();return this.node(a,{kind:r.INPUT_OBJECT_TYPE_DEFINITION,description:b,name:c,directives:d,fields:e})}parseInputFieldsDefinition(){return this.optionalMany(s.BRACE_L,this.parseInputValueDef,s.BRACE_R)}parseTypeSystemExtension(){let a=this._lexer.lookahead();if(a.kind===s.NAME)switch(a.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(a)}parseSchemaExtension(){let a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");let b=this.parseConstDirectives(),c=this.optionalMany(s.BRACE_L,this.parseOperationTypeDefinition,s.BRACE_R);if(0===b.length&&0===c.length)throw this.unexpected();return this.node(a,{kind:r.SCHEMA_EXTENSION,directives:b,operationTypes:c})}parseScalarTypeExtension(){let a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");let b=this.parseName(),c=this.parseConstDirectives();if(0===c.length)throw this.unexpected();return this.node(a,{kind:r.SCALAR_TYPE_EXTENSION,name:b,directives:c})}parseObjectTypeExtension(){let a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");let b=this.parseName(),c=this.parseImplementsInterfaces(),d=this.parseConstDirectives(),e=this.parseFieldsDefinition();if(0===c.length&&0===d.length&&0===e.length)throw this.unexpected();return this.node(a,{kind:r.OBJECT_TYPE_EXTENSION,name:b,interfaces:c,directives:d,fields:e})}parseInterfaceTypeExtension(){let a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");let b=this.parseName(),c=this.parseImplementsInterfaces(),d=this.parseConstDirectives(),e=this.parseFieldsDefinition();if(0===c.length&&0===d.length&&0===e.length)throw this.unexpected();return this.node(a,{kind:r.INTERFACE_TYPE_EXTENSION,name:b,interfaces:c,directives:d,fields:e})}parseUnionTypeExtension(){let a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");let b=this.parseName(),c=this.parseConstDirectives(),d=this.parseUnionMemberTypes();if(0===c.length&&0===d.length)throw this.unexpected();return this.node(a,{kind:r.UNION_TYPE_EXTENSION,name:b,directives:c,types:d})}parseEnumTypeExtension(){let a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");let b=this.parseName(),c=this.parseConstDirectives(),d=this.parseEnumValuesDefinition();if(0===c.length&&0===d.length)throw this.unexpected();return this.node(a,{kind:r.ENUM_TYPE_EXTENSION,name:b,directives:c,values:d})}parseInputObjectTypeExtension(){let a=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");let b=this.parseName(),c=this.parseConstDirectives(),d=this.parseInputFieldsDefinition();if(0===c.length&&0===d.length)throw this.unexpected();return this.node(a,{kind:r.INPUT_OBJECT_TYPE_EXTENSION,name:b,directives:c,fields:d})}parseDirectiveDefinition(){let a=this._lexer.token,b=this.parseDescription();this.expectKeyword("directive"),this.expectToken(s.AT);let c=this.parseName(),d=this.parseArgumentDefs(),e=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");let f=this.parseDirectiveLocations();return this.node(a,{kind:r.DIRECTIVE_DEFINITION,description:b,name:c,arguments:d,repeatable:e,locations:f})}parseDirectiveLocations(){return this.delimitedMany(s.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){let a=this._lexer.token,b=this.parseName();if(Object.prototype.hasOwnProperty.call(q,b.value))return b;throw this.unexpected(a)}node(a,b){return!0!==this._options.noLocation&&(b.loc=new c$(a,this._lexer.lastToken,this._lexer.source)),b}peek(a){return this._lexer.token.kind===a}expectToken(a){let b=this._lexer.token;if(b.kind===a)return this.advanceLexer(),b;throw cZ(this._lexer.source,b.start,`Expected ${dn(a)}, found ${dm(b)}.`)}expectOptionalToken(a){return this._lexer.token.kind===a&&(this.advanceLexer(),!0)}expectKeyword(a){let b=this._lexer.token;if(b.kind===s.NAME&&b.value===a)this.advanceLexer();else throw cZ(this._lexer.source,b.start,`Expected "${a}", found ${dm(b)}.`)}expectOptionalKeyword(a){let b=this._lexer.token;return b.kind===s.NAME&&b.value===a&&(this.advanceLexer(),!0)}unexpected(a){let b=null!=a?a:this._lexer.token;return cZ(this._lexer.source,b.start,`Unexpected ${dm(b)}.`)}any(a,b,c){this.expectToken(a);let d=[];for(;!this.expectOptionalToken(c);)d.push(b.call(this));return d}optionalMany(a,b,c){if(this.expectOptionalToken(a)){let a=[];do a.push(b.call(this));while(!this.expectOptionalToken(c))return a}return[]}many(a,b,c){this.expectToken(a);let d=[];do d.push(b.call(this));while(!this.expectOptionalToken(c))return d}delimitedMany(a,b){this.expectOptionalToken(a);let c=[];do c.push(b.call(this));while(this.expectOptionalToken(a))return c}advanceLexer(){let{maxTokens:a}=this._options,b=this._lexer.advance();if(void 0!==a&&b.kind!==s.EOF&&(++this._tokenCounter,this._tokenCounter>a))throw cZ(this._lexer.source,b.start,`Document contains more that ${a} tokens. Parsing aborted.`)}}function dm(a){let b=a.value;return dn(a.kind)+(null!=b?` "${b}"`:"")}function dn(a){return a===s.BANG||a===s.DOLLAR||a===s.AMP||a===s.PAREN_L||a===s.PAREN_R||a===s.SPREAD||a===s.COLON||a===s.EQUALS||a===s.AT||a===s.BRACKET_L||a===s.BRACKET_R||a===s.BRACE_L||a===s.PIPE||a===s.BRACE_R?`"${a}"`:a}let dp=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function dq(a){return dr[a.charCodeAt(0)]}let dr=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],ds=Object.freeze({}),dt={Name:{leave:a=>a.value},Variable:{leave:a=>"$"+a.name},Document:{leave:a=>du(a.definitions,"\n\n")},OperationDefinition:{leave(a){let b=dw("(",du(a.variableDefinitions,", "),")"),c=du([a.operation,du([a.name,b]),du(a.directives," ")]," ");return("query"===c?"":c+" ")+a.selectionSet}},VariableDefinition:{leave:({variable:a,type:b,defaultValue:c,directives:d})=>a+": "+b+dw(" = ",c)+dw(" ",du(d," "))},SelectionSet:{leave:({selections:a})=>dv(a)},Field:{leave({alias:a,name:b,arguments:c,directives:d,selectionSet:e}){let f=dw("",a,": ")+b,g=f+dw("(",du(c,", "),")");return g.length>80&&(g=f+dw("(\n",dx(du(c,"\n")),"\n)")),du([g,du(d," "),e]," ")}},Argument:{leave:({name:a,value:b})=>a+": "+b},FragmentSpread:{leave:({name:a,directives:b})=>"..."+a+dw(" ",du(b," "))},InlineFragment:{leave:({typeCondition:a,directives:b,selectionSet:c})=>du(["...",dw("on ",a),du(b," "),c]," ")},FragmentDefinition:{leave:({name:a,typeCondition:b,variableDefinitions:c,directives:d,selectionSet:e})=>`fragment ${a}${dw("(",du(c,", "),")")} on ${b} ${dw("",du(d," ")," ")}`+e},IntValue:{leave:({value:a})=>a},FloatValue:{leave:({value:a})=>a},StringValue:{leave:({value:a,block:b})=>{let c,d,e,f,g,h,i,j,k,l,m;return b?(e=1===(d=(c=a.replace(/"""/g,'\\"""')).split(/\r\n|[\n\r]/g)).length,f=d.length>1&&d.slice(1).every(a=>0===a.length||c3(a.charCodeAt(0))),g=c.endsWith('\\"""'),h=a.endsWith('"')&&!g,i=a.endsWith("\\"),j=h||i,k=!e||a.length>70||j||f||g,l="",m=e&&c3(a.charCodeAt(0)),(k&&!m||f)&&(l+="\n"),l+=c,(k||j)&&(l+="\n"),'"""'+l+'"""'):`"${a.replace(dp,dq)}"`}},BooleanValue:{leave:({value:a})=>a?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:a})=>a},ListValue:{leave:({values:a})=>"["+du(a,", ")+"]"},ObjectValue:{leave:({fields:a})=>"{"+du(a,", ")+"}"},ObjectField:{leave:({name:a,value:b})=>a+": "+b},Directive:{leave:({name:a,arguments:b})=>"@"+a+dw("(",du(b,", "),")")},NamedType:{leave:({name:a})=>a},ListType:{leave:({type:a})=>"["+a+"]"},NonNullType:{leave:({type:a})=>a+"!"},SchemaDefinition:{leave:({description:a,directives:b,operationTypes:c})=>dw("",a,"\n")+du(["schema",du(b," "),dv(c)]," ")},OperationTypeDefinition:{leave:({operation:a,type:b})=>a+": "+b},ScalarTypeDefinition:{leave:({description:a,name:b,directives:c})=>dw("",a,"\n")+du(["scalar",b,du(c," ")]," ")},ObjectTypeDefinition:{leave:({description:a,name:b,interfaces:c,directives:d,fields:e})=>dw("",a,"\n")+du(["type",b,dw("implements ",du(c," & ")),du(d," "),dv(e)]," ")},FieldDefinition:{leave:({description:a,name:b,arguments:c,type:d,directives:e})=>dw("",a,"\n")+b+(dy(c)?dw("(\n",dx(du(c,"\n")),"\n)"):dw("(",du(c,", "),")"))+": "+d+dw(" ",du(e," "))},InputValueDefinition:{leave:({description:a,name:b,type:c,defaultValue:d,directives:e})=>dw("",a,"\n")+du([b+": "+c,dw("= ",d),du(e," ")]," ")},InterfaceTypeDefinition:{leave:({description:a,name:b,interfaces:c,directives:d,fields:e})=>dw("",a,"\n")+du(["interface",b,dw("implements ",du(c," & ")),du(d," "),dv(e)]," ")},UnionTypeDefinition:{leave:({description:a,name:b,directives:c,types:d})=>dw("",a,"\n")+du(["union",b,du(c," "),dw("= ",du(d," | "))]," ")},EnumTypeDefinition:{leave:({description:a,name:b,directives:c,values:d})=>dw("",a,"\n")+du(["enum",b,du(c," "),dv(d)]," ")},EnumValueDefinition:{leave:({description:a,name:b,directives:c})=>dw("",a,"\n")+du([b,du(c," ")]," ")},InputObjectTypeDefinition:{leave:({description:a,name:b,directives:c,fields:d})=>dw("",a,"\n")+du(["input",b,du(c," "),dv(d)]," ")},DirectiveDefinition:{leave:({description:a,name:b,arguments:c,repeatable:d,locations:e})=>dw("",a,"\n")+"directive @"+b+(dy(c)?dw("(\n",dx(du(c,"\n")),"\n)"):dw("(",du(c,", "),")"))+(d?" repeatable":"")+" on "+du(e," | ")},SchemaExtension:{leave:({directives:a,operationTypes:b})=>du(["extend schema",du(a," "),dv(b)]," ")},ScalarTypeExtension:{leave:({name:a,directives:b})=>du(["extend scalar",a,du(b," ")]," ")},ObjectTypeExtension:{leave:({name:a,interfaces:b,directives:c,fields:d})=>du(["extend type",a,dw("implements ",du(b," & ")),du(c," "),dv(d)]," ")},InterfaceTypeExtension:{leave:({name:a,interfaces:b,directives:c,fields:d})=>du(["extend interface",a,dw("implements ",du(b," & ")),du(c," "),dv(d)]," ")},UnionTypeExtension:{leave:({name:a,directives:b,types:c})=>du(["extend union",a,du(b," "),dw("= ",du(c," | "))]," ")},EnumTypeExtension:{leave:({name:a,directives:b,values:c})=>du(["extend enum",a,du(b," "),dv(c)]," ")},InputObjectTypeExtension:{leave:({name:a,directives:b,fields:c})=>du(["extend input",a,du(b," "),dv(c)]," ")}};function du(a,b=""){var c;return null!=(c=null==a?void 0:a.filter(a=>a).join(b))?c:""}function dv(a){return dw("{\n",dx(du(a,"\n")),"\n}")}function dw(a,b,c=""){return null!=b&&""!==b?a+b+c:""}function dx(a){return dw("  ",a.replace(/\n/g,"\n  "))}function dy(a){var b;return null!=(b=null==a?void 0:a.some(a=>a.includes("\n")))&&b}function dz(a){var b;let c,d=a.definitions.filter(a=>"OperationDefinition"===a.kind);return 1===d.length&&(c=null==(b=d[0].name)?void 0:b.value),c}class dA{constructor(a){this.headers={},this.isAccessTokenValidOrNull=()=>{if(!this.accessToken)return!0;try{let a=c(this.accessToken);return null!=a.exp&&1e3*a.exp>Date.now()}catch(a){return console.error("Error decoding token:",a),!1}},this.awaitForValidAccessTokenOrNull=async()=>{if(this.isAccessTokenValidOrNull())return!0;let a=()=>this.isAccessTokenValidOrNull()?Promise.resolve(!0):new Promise(b=>{setTimeout(()=>a().then(b),100)});return a()};const{url:b,adminSecret:d}=a;this._url=b,this.accessToken=null,this.adminSecret=d}async request(a,...b){let[c,d]=b,e=a.document?a:{document:a,variables:c,config:d},{headers:f,...g}=d||{},{query:h,operationName:i}=function(a){if("string"==typeof a){let b;try{let c=new dl(a,void 0).parseDocument();b=dz(c)}catch{}return{query:a,operationName:b}}let b=dz(a);return{query:function(a,b,c=c0){let d,e,f,g=new Map;for(let a of Object.values(r))g.set(a,function(a,b){let c=a[b];return"object"==typeof c?c:"function"==typeof c?{enter:c,leave:void 0}:{enter:a.enter,leave:a.leave}}(b,a));let h=Array.isArray(a),i=[a],j=-1,k=[],l=a,m=[],n=[];do{var o,p,q;let a,r=++j===i.length,s=r&&0!==k.length;if(r){if(e=0===n.length?void 0:m[m.length-1],l=f,f=n.pop(),s)if(h){l=l.slice();let a=0;for(let[b,c]of k){let d=b-a;null===c?(l.splice(d,1),a++):l[d]=c}}else for(let[a,b]of(l=Object.defineProperties({},Object.getOwnPropertyDescriptors(l)),k))l[a]=b;j=d.index,i=d.keys,k=d.edits,h=d.inArray,d=d.prev}else if(f){if(null==(l=f[e=h?j:i[j]]))continue;m.push(e)}if(!Array.isArray(l)){c2(l)||dh(!1,`Invalid AST Node: ${di(l,[])}.`);let c=r?null==(o=g.get(l.kind))?void 0:o.leave:null==(p=g.get(l.kind))?void 0:p.enter;if((a=null==c?void 0:c.call(b,l,e,f,m,n))===ds)break;if(!1===a){if(!r){m.pop();continue}}else if(void 0!==a&&(k.push([e,a]),!r))if(c2(a))l=a;else{m.pop();continue}}void 0===a&&s&&k.push([e,l]),r?m.pop():(d={inArray:h,index:j,keys:i,edits:k,prev:d},i=(h=Array.isArray(l))?l:null!=(q=c[l.kind])?q:[],j=-1,k=[],f&&n.push(f),f=l)}while(void 0!==d)return 0!==k.length?k[k.length-1][1]:a}(a,dt),operationName:b}}(e.document);"undefined"==typeof process||process.env.TEST_MODE||await this.awaitForValidAccessTokenOrNull();try{let a=await (0,cS.default)(this.httpUrl,{method:"POST",body:JSON.stringify({operationName:i,query:h,variables:c}),headers:{"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...this.headers,...f},...g});if(!a.ok)return{data:null,error:{error:a.statusText,message:a.statusText,status:a.status}};let{data:b,errors:d}=await a.json();return d?{data:null,error:d}:"object"!=typeof b||Array.isArray(b)||null===b?{data:null,error:{error:"invalid-response",message:"incorrect response data from GraphQL server",status:0}}:{data:b,error:null}}catch(a){return{data:null,error:{message:a.message,status:500*("AbortError"!==a.name),error:"AbortError"===a.name?"abort-error":"unknown"}}}}get httpUrl(){return this._url}get wsUrl(){return this._url.replace(/^(http)(s?):\/\//,"ws$2://")}get url(){return this._url}getUrl(){return this._url}setAccessToken(a){if(!a){this.accessToken=null;return}this.accessToken=a}getHeaders(){return this.headers}setHeaders(a){a&&(this.headers={...this.headers,...a})}unsetHeaders(){let a=this.headers["x-hasura-role"];this.headers=a?{"x-hasura-role":a}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}var dB=Object.defineProperty,dC=(a,b,c)=>{let d;return(d="symbol"!=typeof b?b+"":b)in a?dB(a,d,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[d]=c};let dD=/^((?<protocol>http[s]?):\/\/)?(?<host>(localhost|local))(:(?<port>(\d+|__\w+__)))?$/;function dE(a,b){let{subdomain:c,region:d}=a;if(!c)throw Error("A `subdomain` must be set.");let e=c.match(dD);if(null!=e&&e.groups){var f;let{protocol:a,host:c,port:d}=e.groups;return f=b,("undefined"!=typeof process&&process.env?process.env[`NHOST_${f.toUpperCase()}_URL`]:null)||("localhost"===c?(console.warn('The `subdomain` is set to "localhost". Support for this will be removed in a future release. Please use "local" instead.'),`${a||"http"}://localhost:${d||1337}/v1/${b}`):d?`${a||"https"}://local.${b}.local.nhost.run:${d}/v1`:`${a||"https"}://local.${b}.local.nhost.run/v1`)}if(!d)throw Error('`region` must be set when using a `subdomain` other than "local".');return`https://${c}.${b}.${d}.nhost.run/v1`}class dF{constructor(a){dC(this,"url"),dC(this,"accessToken"),dC(this,"adminSecret"),dC(this,"headers",{});const{url:b,adminSecret:c}=a;this.url=b,this.accessToken=null,this.adminSecret=c}async call(a,b,c){var d,e;let f={"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...null==c?void 0:c.headers,...this.headers},g=this.url+(a.startsWith("/")?a:`/${a}`);try{let a=await (0,cS.default)(g,{body:b?JSON.stringify(b):null,headers:f,method:"POST"});if(!a.ok){let b;return b=null!=(d=a.headers.get("content-type"))&&d.includes("application/json")?await a.json():await a.text(),{res:null,error:{message:b,error:a.statusText,status:a.status}}}return{res:{data:null!=(e=a.headers.get("content-type"))&&e.includes("application/json")?await a.json():await a.text(),status:a.status,statusText:a.statusText},error:null}}catch(a){return{res:null,error:{message:a.message,status:500*("AbortError"!==a.name),error:"AbortError"===a.name?"abort-error":"unknown"}}}}setAccessToken(a){if(!a){this.accessToken=null;return}this.accessToken=a}getHeaders(){return this.headers}setHeaders(a){a&&(this.headers={...this.headers,...a})}unsetHeaders(){let a=this.headers["x-hasura-role"];this.headers=a?{"x-hasura-role":a}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}var dG=a.i(61088),dH=dG.useLayoutEffect;function dI(a){var b=dG.useRef();return b.current||(b.current={v:a()}),b.current.v}var dJ=function(){return(dJ=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},dK=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c},dL=function(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g};function dM(a){for(var b,c,d,e,f,g,h,i,j,k=[],l=1;l<arguments.length;l++)k[l-1]=arguments[l];var m=dL(k,2),n=m[0],p=void 0===n?{}:n,q=m[1],r=(b=dI(function(){return"function"==typeof a?a():a}),c=p.context,d=p.guards,e=p.actions,f=p.activities,g=p.services,h=p.delays,p.state,i=dK(p,["context","guards","actions","activities","services","delays","state"]),j=dI(function(){return bq(b.withConfig({context:c,guards:d,actions:e,activities:f,services:g,delays:h},function(){return dJ(dJ({},b.context),c)}),i)}),dH(function(){Object.assign(j.machine.options.actions,e),Object.assign(j.machine.options.guards,d),Object.assign(j.machine.options.activities,f),Object.assign(j.machine.options.services,g),Object.assign(j.machine.options.delays,h)},[e,d,f,g,h]),j);return(0,dG.useEffect)(function(){if(q){var a=r.subscribe(ar(q));return function(){a.unsubscribe()}}},[q]),(0,dG.useEffect)(function(){var a=p.state;return r.start(a?a7.create(a):void 0),function(){r.stop(),r.status=o.NotStarted}},[]),r}var dN=a.i(28081),dO=function(a,b){return a===b},dP=function(a,b){if("state"in a&&"machine"in a){if(0===a.status&&b.current)return b.current;var c=0!==a.status?a.getSnapshot():a.machine.initialState;return b.current=0===a.status?c:null,c}return"state"in a?a.state:void 0};function dQ(a,b,c,d){void 0===c&&(c=dO);var e=(0,dG.useRef)(null),f=(0,dG.useCallback)(function(b){return a.subscribe(b).unsubscribe},[a]),g=(0,dG.useCallback)(function(){return d?d(a):dP(a,e)},[a,d]);return(0,dN.useSyncExternalStoreWithSelector)(f,g,g,b,c)}let dR=class{constructor({refreshIntervalTime:a,clientStorage:b,clientStorageType:c,autoRefreshToken:d,autoSignIn:e,adminSecret:f,devTools:g,start:h=!0,...i}){dC(this,"auth"),dC(this,"storage"),dC(this,"functions"),dC(this,"graphql"),dC(this,"_adminSecret"),dC(this,"devTools"),this.auth=function(a){let b="subdomain"in a?dE(a,"auth"):a.authUrl,{subdomain:c,region:d}=a;if(!b)throw Error("Please provide `subdomain` or `authUrl`.");return new cE({url:b,broadcastKey:`${c}${null!=d?d:"local"}`,...a})}({refreshIntervalTime:a,clientStorage:b,clientStorageType:c,autoRefreshToken:d,autoSignIn:e,start:h,...i}),this.storage=function(a){let b="subdomain"in a?dE(a,"storage"):a.storageUrl;if(!b)throw Error("Please provide `subdomain` or `storageUrl`.");return new cK({url:b,...a})}({adminSecret:f,...i}),this.functions=function(a){let b="subdomain"in a?dE(a,"functions"):a.functionsUrl;if(!b)throw Error("Please provide `subdomain` or `functionsUrl`.");return new dF({url:b,...a})}({adminSecret:f,...i}),this.graphql=function(a){let b="subdomain"in a?dE(a,"graphql"):a.graphqlUrl;if(!b)throw Error("Please provide `subdomain` or `graphqlUrl`.");return new dA({url:b,...a})}({adminSecret:f,...i}),this.auth.onAuthStateChanged((a,b)=>{if("SIGNED_OUT"===a){this.storage.setAccessToken(void 0),this.functions.setAccessToken(void 0),this.graphql.setAccessToken(void 0);return}let c=null==b?void 0:b.accessToken;this.storage.setAccessToken(c),this.functions.setAccessToken(c),this.graphql.setAccessToken(c)}),this.auth.onTokenChanged(a=>{let b=null==a?void 0:a.accessToken;this.storage.setAccessToken(b),this.functions.setAccessToken(b),this.graphql.setAccessToken(b)}),this._adminSecret=f,this.devTools=g}get adminSecret(){return this._adminSecret}set adminSecret(a){this._adminSecret=a,this.storage.setAdminSecret(a)}setRole(a){this.graphql.setHeaders({"x-hasura-role":a}),this.storage.setHeaders({"x-hasura-role":a}),this.functions.setHeaders({"x-hasura-role":a})}unsetRole(){this.graphql.setHeaders((({"x-hasura-role":a,...b})=>b)(this.graphql.getHeaders())),this.storage.setHeaders((({"x-hasura-role":a,...b})=>b)(this.storage.getHeaders())),this.functions.setHeaders((({"x-hasura-role":a,...b})=>b)(this.functions.getHeaders()))}};class dS extends dR{constructor(a){super({...a,start:!1})}}let dT=(0,dG.createContext)({}),dU=({nhost:a,initial:b,...c})=>{let d=dM(a.auth.client.machine,{devTools:a.devTools});a.auth.client.start({interpreter:d,initialSession:b,devTools:a.devTools});let e=(0,dG.useRef)(!0);return(0,dG.useEffect)(()=>{e.current?e.current=!1:b&&d.send("SESSION_UPDATE",{data:{session:b}})},[b,d]),dG.default.createElement(dT.Provider,{value:a},c.children)},dV=()=>{var a;let b=null==(a=(0,dG.useContext)(dT).auth)?void 0:a.client.interpreter;if(!b)throw Error("Could not find the Nhost auth client. Did you wrap your app in <NhostProvider />?");return b},dW=()=>dQ(dV(),a=>({isAuthenticated:a.matches({authentication:"signedIn"}),isLoading:a.hasTag("loading"),error:a.context.errors.authentication||null,isError:a.matches({authentication:{signedOut:"failed"}}),connectionAttempts:a.context.importTokenAttempts}),(a,b)=>a.isAuthenticated===b.isAuthenticated&&a.isLoading===b.isLoading&&a.connectionAttempts===b.connectionAttempts);function dX({children:a}){let{isAuthenticated:b}=dW();return b?(0,dG.createElement)(dG.Fragment,null,a):null}function dY({children:a}){let{isAuthenticated:b}=dW();return b?null:(0,dG.createElement)(dG.Fragment,null,a)}let dZ=()=>dQ(dV(),a=>a.context.accessToken.value),d$=()=>(0,dG.useContext)(dT),d_=()=>{let a=d$(),[b,c]=(0,dG.useState)(null),[d,e]=(0,dG.useState)(!1);return{add:async b=>{e(!0);let d=await cg(a.auth.client,b),{error:f}=d;return f&&c(f),e(!1),d},isLoading:d,isSuccess:!b,isError:!!b,error:b}},d0=()=>{let a=dV(),[b,c]=(0,dG.useState)(!!a.status&&a.getSnapshot().matches({authentication:"signedIn"}));return(0,dG.useEffect)(()=>a.subscribe(a=>{c(a.matches({authentication:"signedIn"}))}).unsubscribe,[a]),b};function d1(a){let b=d$(),c=dM((0,dG.useMemo)(()=>cb(b.auth.client),[b])),d=dQ(c,a=>a.matches("requesting")),e=dQ(c,a=>a.context.error),f=dQ(c,a=>a.matches("idle.error")),g=dQ(c,a=>a.matches("idle.success"));return{changeEmail:(0,dG.useCallback)(async(b,d=a)=>ch(c,b,d),[c,a]),isLoading:d,needsEmailVerification:g,isError:f,error:e}}let d2=()=>{let a=d$(),b=dM((0,dG.useMemo)(()=>cc(a.auth.client),[a])),c=dQ(b,a=>a.matches({idle:"error"})),d=dQ(b,a=>a.matches({idle:"success"})),e=dQ(b,a=>a.context.error);return{changePassword:a=>ci(b,a),isLoading:dQ(b,a=>a.matches("requesting")),isSuccess:d,isError:c,error:e}},d3=()=>{let a=d$(),b=dM((0,dG.useMemo)(()=>(({backendUrl:a,interpreter:b})=>bg({schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,id:"enableMfa",initial:"idle",context:{error:null,imageUrl:null,secret:null},states:{idle:{initial:"initial",on:{GENERATE:"generating",DISABLE:"disabling"},states:{initial:{},error:{},disabled:{}}},generating:{invoke:{src:"generate",id:"generate",onDone:{target:"generated",actions:["reportGeneratedSuccess","saveGeneration"]},onError:{actions:["saveError","reportGeneratedError"],target:"idle.error"}}},generated:{initial:"idle",states:{idle:{initial:"idle",on:{ACTIVATE:[{cond:"invalidMfaType",actions:"saveInvalidMfaTypeError",target:".error"},{cond:"invalidMfaCode",actions:"saveInvalidMfaCodeError",target:".error"},{target:"activating"}],DISABLE:"#enableMfa.disabling"},states:{idle:{},error:{}}},activating:{invoke:{src:"activate",id:"activate",onDone:{target:"activated",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}},activated:{type:"final"}}},disabling:{invoke:{src:"disable",id:"disable",onDone:{target:"idle.disabled",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidMfaTypeError:aX({error:a=>by}),saveInvalidMfaCodeError:aX({error:a=>bz}),saveError:aX({error:(a,{data:{error:b}})=>b}),saveGeneration:aX({imageUrl:(a,{data:{imageUrl:b}})=>b,secret:(a,{data:{totpSecret:b}})=>b}),reportError:aK((a,b)=>({type:"ERROR",error:a.error})),reportSuccess:aK("SUCCESS"),reportGeneratedSuccess:aK("GENERATED"),reportGeneratedError:aK(a=>({type:"GENERATED_ERROR",error:a.error}))},guards:{invalidMfaCode:(a,{code:b})=>!b,invalidMfaType:(a,{activeMfaType:b})=>!b||"totp"!==b},services:{generate:async c=>{let{data:d}=await b2(`${a}/mfa/totp/generate`,"GET",{token:null==b?void 0:b.getSnapshot().context.accessToken.value});return d},activate:(c,{code:d,activeMfaType:e})=>b3(`${a}/user/mfa`,{code:d,activeMfaType:e},null==b?void 0:b.getSnapshot().context.accessToken.value),disable:(c,{code:d})=>b3(`${a}/user/mfa`,{code:d,activeMfaType:""},null==b?void 0:b.getSnapshot().context.accessToken.value)}}))(a.auth.client),[a])),c=dQ(b,a=>a.matches({idle:"error"})||a.matches({generated:{idle:"error"}})),d=dQ(b,a=>a.matches("generating")),e=dQ(b,a=>a.matches("generated")),f=dQ(b,a=>a.matches({generated:"activating"})),g=dQ(b,a=>a.matches({generated:"activated"})),h=dQ(b,a=>a.matches("disabling")),i=dQ(b,a=>a.context.error);return{generateQrCode:()=>new Promise(a=>{b.send("GENERATE"),b.onTransition(b=>{b.matches("generated")?a({error:null,isError:!1,isGenerated:!0,qrCodeDataUrl:b.context.imageUrl||"",totpSecret:b.context.secret}):b.matches({idle:"error"})&&a({error:b.context.error||null,isError:!0,isGenerated:!1,qrCodeDataUrl:"",totpSecret:b.context.secret})})}),isGenerating:d,qrCodeDataUrl:dQ(b,a=>a.context.imageUrl||""),isGenerated:e,activateMfa:a=>new Promise(c=>{b.send("ACTIVATE",{activeMfaType:"totp",code:a}),b.onTransition(a=>{a.matches({generated:"activated"})?c({error:null,isActivated:!0,isError:!1}):a.matches({generated:{idle:"error"}})&&c({error:a.context.error,isActivated:!1,isError:!0})})}),isActivating:f,isActivated:g,isDisabling:h,isError:c,error:i,disableMfa:a=>new Promise(c=>{b.send("DISABLE",{code:a}),b.onTransition(a=>{a.matches({idle:"disabled"})?c({error:null,isDisabled:!0,isError:!1}):a.matches({idle:"error"})&&c({error:a.context.error,isDisabled:!1,isError:!0})})}),totpSecret:dQ(b,a=>a.context.secret||"")}},d4=()=>{let a=dZ();return a?c(a):null},d5=a=>{let b=d$(),c=dQ(a,a=>a.matches("uploading")),d=dQ(a,a=>a.matches("uploaded")),e=dQ(a,a=>a.matches("error")),f=dQ(a,a=>a.context.error||null),g=dQ(a,a=>a.context.progress),h=dQ(a,a=>a.context.id),i=dQ(a,a=>a.context.bucketId);return{add:b=>{a.send({type:"ADD",file:b.file,bucketId:b.bucketId||i})},upload:c=>cQ({url:b.storage.url,accessToken:b.auth.getAccessToken(),adminSecret:b.adminSecret,...c},a),cancel:()=>{a.send("CANCEL")},destroy:()=>{a.send("DESTROY")},isUploaded:d,isUploading:c,isError:e,error:f,progress:g,id:h,bucketId:i,name:dQ(a,a=>{var b;return null==(b=a.context.file)?void 0:b.name})}},d6=()=>d5(dM(cM)),d7=()=>{let a=d4();return(null==a?void 0:a["https://hasura.io/jwt/claims"])||null},d8=a=>{let b=d7();return(null==b?void 0:b[a.startsWith("x-hasura-")?a:`x-hasura-${a}`])||null},d9=()=>{let a=d$(),[b,c]=(0,dG.useState)([]),d=dM(cP,{},a=>{"UPLOAD_ERROR"===a.event.type?c(a.context.files.filter(a=>{var b;return null==(b=a.getSnapshot())?void 0:b.context.error})):(a.matches("uploaded")||"CLEAR"===a.event.type)&&b.length>0&&c([])}),e=dQ(d,a=>a.matches("uploading")),f=dQ(d,a=>a.matches("uploaded")),g=dQ(d,a=>a.matches("error"));return{upload:b=>cR({url:a.storage.url,accessToken:a.auth.getAccessToken(),adminSecret:a.adminSecret,...b},d),add:a=>{d.send({type:"ADD",...a})},clear:()=>{d.send("CLEAR")},cancel:()=>{d.send("CANCEL")},progress:dQ(d,a=>a.context.progress),isUploaded:f,isUploading:e,files:dQ(d,a=>a.context.files),isError:g,errors:b}},ea=a=>{let[b,c]=(0,dG.useState)(!0),d=dZ();(0,dG.useEffect)(()=>{c(!1)},[]);let e=(0,dG.useContext)(dT);return new Proxy({},{get(c,f){let g=`${e.auth.client.backendUrl}/signin/provider/${f}`,h=null!=a&&a.connect?{connect:d}:{};return b4(g,b5(b?void 0:e.auth.client.clientUrl,{...a,...h}))}})},eb=a=>{let b=d$(),c=dM((0,dG.useMemo)(()=>cd(b.auth.client),[b])),d=dQ(c,a=>a.matches("requesting")),e=dQ(c,a=>a.context.error),f=dQ(c,a=>a.matches("idle.error"));return{resetPassword:(b,d=a)=>cj(c,b,d),isLoading:d,isSent:dQ(c,a=>a.matches("idle.success")),isError:f,error:e}},ec=a=>{let b=d$(),c=dM((0,dG.useMemo)(()=>ce(b.auth.client),[b])),d=dQ(c,a=>a.matches({idle:"error"})),e=dQ(c,a=>a.matches({idle:"success"})),f=dQ(c,a=>a.context.error);return{sendEmail:(b,d=a)=>ck(c,b,d),isLoading:dQ(c,a=>a.matches("requesting")),isSent:e,isError:d,error:f}},ed=()=>{let a=dV(),b=dQ(a,a=>a.context.errors.authentication||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error)),c=dQ(a,a=>a.matches({authentication:{authenticating:"anonymous"}})),d=dQ(a,a=>a.matches({authentication:"signedIn"})),e=dQ(a,a=>a.matches({authentication:{signedOut:"failed"}})),f=dQ(a,a=>a.context.user,(a,b)=>(null==a?void 0:a.id)===(null==b?void 0:b.id));return{accessToken:dQ(a,a=>a.context.accessToken.value),error:b,isError:e,isLoading:c,isSuccess:d,signInAnonymous:()=>cl(a),user:f}},ee=()=>{let a=dV(),b=dQ(a,a=>a.context.user,(a,b)=>(null==a?void 0:a.id)===(null==b?void 0:b.id)),c=dQ(a,a=>a.context.accessToken.value),d=dQ(a,a=>a.context.refreshToken.value),e=dQ(a,a=>a.context.errors.authentication||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error)),f=dQ(a,a=>a.matches({authentication:"signedIn"})),g=dQ(a,a=>a.matches({authentication:{authenticating:"password"}}),(a,b)=>a===b),h=dQ(a,a=>a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(a,b)=>a===b),i=dQ(a,a=>null!==a.context.mfa);return{accessToken:c,refreshToken:d,error:e,isError:dQ(a,a=>a.matches({authentication:{signedOut:"failed"}}),(a,b)=>a===b),isLoading:g,isSuccess:f,needsEmailVerification:h,needsMfaOtp:i,mfa:dQ(a,a=>a.context.mfa),sendMfaOtp:b=>cr(a,b),signInEmailPassword:(b,c)=>cm(a,b,c),user:b}};function ef(a){let b=dV(),c=dQ(b,a=>a.context.errors.registration||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error));return{signInEmailPasswordless:(c,d=a)=>cn(b,c,d),isLoading:dQ(b,a=>a.matches("registration.passwordlessEmail")),isSuccess:dQ(b,a=>a.matches("registration.incomplete.needsEmailVerification")),isError:dQ(b,a=>a.matches("registration.incomplete.failed")),error:c}}let eg=()=>{let a=dV(),b=dQ(a,a=>a.context.user,(a,b)=>(null==a?void 0:a.id)===(null==b?void 0:b.id)),c=dQ(a,a=>a.context.accessToken.value),d=dQ(a,a=>a.context.refreshToken.value),e=dQ(a,a=>a.context.errors.authentication||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error)),f=dQ(a,a=>a.matches({authentication:"signedIn"})),g=dQ(a,a=>a.matches({authentication:{authenticating:"securityKeyEmail"}}),(a,b)=>a===b),h=dQ(a,a=>a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(a,b)=>a===b);return{accessToken:c,refreshToken:d,error:e,isError:dQ(a,a=>a.matches({authentication:{signedOut:"failed"}}),(a,b)=>a===b),isLoading:g,isSuccess:f,needsEmailVerification:h,signInEmailSecurityKey:b=>co(a,b),user:b}},eh=()=>dQ(dV(),a=>a.context.user,(a,b)=>(a&&JSON.stringify(a))===(b&&JSON.stringify(b))),ei=()=>{let a=eh(),b=d$(),c=d7(),d=!!a&&(null==c?void 0:c["x-hasura-auth-elevated"])===(null==a?void 0:a.id),[e,f]=(0,dG.useState)(!!d);return(0,dG.useEffect)(()=>{f(!!d)},[d]),{elevated:e,elevateEmailSecurityKey:a=>cq(b.auth.client,a)}},ej=()=>{let a=dV(),b=dQ(a,a=>a.context.user,(a,b)=>(null==a?void 0:a.id)===(null==b?void 0:b.id)),c=dQ(a,a=>a.context.accessToken.value),d=dQ(a,a=>a.context.refreshToken.value),e=dQ(a,a=>a.context.errors.authentication||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error)),f=dQ(a,a=>a.matches({authentication:"signedIn"})),g=dQ(a,a=>a.matches({authentication:{authenticating:"password"}}),(a,b)=>a===b);return{accessToken:c,refreshToken:d,error:e,isError:dQ(a,a=>a.matches({authentication:{signedOut:"failed"}}),(a,b)=>a===b),isLoading:g,isSuccess:f,signInPAT:b=>cs(a,b),user:b}};function ek(a){let b=dV(),[c,d]=(0,dG.useState)(""),e=async(...a)=>{if(2===a.length){let[c,d]=a;return cu(b,c,d)}let[d]=a;return cu(b,c,d)},f=dQ(b,a=>a.context.errors.registration||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error));return{signInSmsPasswordless:(c,e=a)=>(d(c),ct(b,c,e)),sendOtp:e,isLoading:dQ(b,a=>a.matches("registration.passwordlessSms")||a.matches("registration.passwordlessSmsOtp")),isSuccess:dQ(b,a=>a.matches("authentication.signedIn")),needsOtp:dQ(b,a=>a.matches("registration.incomplete.needsOtp")),isError:dQ(b,a=>a.matches("registration.incomplete.failed")),error:f}}let el=(a=!1)=>{let b=dV();return{signOut:c=>cv(b,"boolean"==typeof c?c:a),isSuccess:dQ(b,a=>a.matches({authentication:{signedOut:"success"}}),(a,b)=>a===b),error:dQ(b,a=>a.context.errors.signout||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error))}},em=a=>{let b=dV(),c=dQ(b,a=>!!a.context.errors.registration),d=dQ(b,a=>a.context.errors.registration||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error)),e=dQ(b,a=>a.matches("registration.emailPassword")),f=dQ(b,a=>a.matches("registration.incomplete.needsEmailVerification")),g=dQ(b,a=>a.matches({authentication:"signedIn",registration:"complete"})),h=dQ(b,a=>a.context.user,(a,b)=>(null==a?void 0:a.id)===(null==b?void 0:b.id));return{accessToken:dQ(b,a=>a.context.accessToken.value),refreshToken:dQ(b,a=>a.context.refreshToken.value),error:d,isError:c,isLoading:e,isSuccess:g,needsEmailVerification:f,signUpEmailPassword:(c,d,e=a,f)=>cw(b,c,d,e,f),user:h}},en=a=>{let b=dV(),c=dQ(b,a=>!!a.context.errors.registration),d=dQ(b,a=>a.context.errors.registration||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error)),e=dQ(b,a=>a.matches("registration.securityKey")),f=dQ(b,a=>a.matches("registration.incomplete.needsEmailVerification")),g=dQ(b,a=>a.matches({authentication:"signedIn",registration:"complete"})),h=dQ(b,a=>a.context.user,(a,b)=>(null==a?void 0:a.id)===(null==b?void 0:b.id));return{accessToken:dQ(b,a=>a.context.accessToken.value),refreshToken:dQ(b,a=>a.context.refreshToken.value),error:d,isError:c,isLoading:e,isSuccess:g,needsEmailVerification:f,signUpEmailSecurityKey:(c,d=a,e)=>cx(b,c,d,e),user:h}},eo=()=>dQ(dV(),a=>{var b;return null==(b=a.context.user)?void 0:b.avatarUrl},(a,b)=>a===b),ep=()=>dQ(dV(),a=>{var b;return null==(b=a.context.user)?void 0:b.defaultRole},(a,b)=>a===b),eq=()=>dQ(dV(),a=>{var b;return null==(b=a.context.user)?void 0:b.displayName},(a,b)=>a===b),er=()=>dQ(dV(),a=>{var b;return null==(b=a.context.user)?void 0:b.email},(a,b)=>a===b),es=()=>dQ(dV(),a=>{var b;return null==(b=a.context.user)?void 0:b.id},(a,b)=>a===b),et=()=>dQ(dV(),a=>{var b;return null==(b=a.context.user)?void 0:b.isAnonymous},(a,b)=>a===b),eu=()=>dQ(dV(),a=>{var b;return null==(b=a.context.user)?void 0:b.locale},(a,b)=>a===b),ev=()=>dQ(dV(),a=>{var b;return a.matches("authentication.signedIn")&&(null==(b=a.context.user)?void 0:b.roles)||[]});function ew(a){let b=dV(),c=async(a,c)=>cz(b,a,c),d=dQ(b,a=>a.context.errors.registration||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error)),e=dQ(b,a=>a.matches("registration.signInEmailOTP")||a.matches("registration.verifyEmailOTP")),f=dQ(b,a=>a.matches("authentication.signedIn")),g=dQ(b,a=>a.matches("registration.incomplete.needsOtp"));return{signInEmailOTP:(c,d=a)=>cy(b,c,d),verifyEmailOTP:c,isLoading:e,isSuccess:f,isError:dQ(b,a=>a.matches("registration.incomplete.failed")),error:d,needsOtp:g}}let ex=()=>{let a=dV(),b=dQ(a,a=>a.context.user,(a,b)=>(null==a?void 0:a.id)===(null==b?void 0:b.id)),c=dQ(a,a=>a.context.accessToken.value),d=dQ(a,a=>a.context.refreshToken.value),e=dQ(a,a=>a.context.errors.authentication||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error)),f=dQ(a,a=>a.matches({authentication:"signedIn"})),g=dQ(a,a=>a.matches({authentication:{authenticating:"idToken"}}),(a,b)=>a===b);return{accessToken:c,refreshToken:d,error:e,isError:dQ(a,a=>a.matches({authentication:{signedOut:"failed"}}),(a,b)=>a===b),isLoading:g,isSuccess:f,signInIdToken:(b,c,d)=>cA(a,{provider:b,idToken:c,nonce:d}),user:b}},ey=()=>{let a=d$(),[b,c]=(0,dG.useState)(null),[d,e]=(0,dG.useState)(!1);return{linkIdToken:async({provider:b,idToken:d,nonce:f})=>{e(!0);let g=await cB(a.auth.client,{provider:b,idToken:d,...f&&{nonce:f}}),{error:h}=g;return h&&c(h),e(!1),g},isLoading:d,isSuccess:!b,isError:!!b,error:b}},ez=()=>{let a=dV(),b=dQ(a,a=>a.context.user,(a,b)=>(null==a?void 0:a.id)===(null==b?void 0:b.id)),c=dQ(a,a=>a.context.accessToken.value),d=dQ(a,a=>a.context.refreshToken.value),e=dQ(a,a=>a.context.errors.authentication||null,(a,b)=>(null==a?void 0:a.error)===(null==b?void 0:b.error)),f=dQ(a,a=>a.matches({authentication:"signedIn"})),g=dQ(a,a=>a.matches({authentication:{authenticating:"securityKeyEmail"}}),(a,b)=>a===b),h=dQ(a,a=>a.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(a,b)=>a===b);return{accessToken:c,refreshToken:d,error:e,isError:dQ(a,a=>a.matches({authentication:{signedOut:"failed"}}),(a,b)=>a===b),isLoading:g,isSuccess:f,needsEmailVerification:h,signInSecurityKey:()=>cC(a),user:b}};a.s(["NhostClient",()=>dS,"NhostProvider",()=>dU,"NhostReactContext",()=>dT,"NhostReactProvider",()=>dU,"SignedIn",()=>dX,"SignedOut",()=>dY,"VanillaNhostClient",()=>dR,"useAccessToken",()=>dZ,"useAddSecurityKey",()=>d_,"useAuthInterpreter",()=>dV,"useAuthenticated",()=>d0,"useAuthenticationStatus",()=>dW,"useChangeEmail",()=>d1,"useChangePassword",()=>d2,"useConfigMfa",()=>d3,"useDecodedAccessToken",()=>d4,"useElevateSecurityKeyEmail",()=>ei,"useFileUpload",()=>d6,"useFileUploadItem",()=>d5,"useHasuraClaim",()=>d8,"useHasuraClaims",()=>d7,"useLinkIdToken",()=>ey,"useMultipleFilesUpload",()=>d9,"useNhostClient",()=>d$,"useProviderLink",()=>ea,"useResetPassword",()=>eb,"useSendVerificationEmail",()=>ec,"useSignInAnonymous",()=>ed,"useSignInEmailOTP",()=>ew,"useSignInEmailPassword",()=>ee,"useSignInEmailPasswordless",()=>ef,"useSignInEmailSecurityKey",()=>eg,"useSignInIdToken",()=>ex,"useSignInPAT",()=>ej,"useSignInSecurityKey",()=>ez,"useSignInSmsPasswordless",()=>ek,"useSignOut",()=>el,"useSignUpEmailPassword",()=>em,"useSignUpEmailSecurityKeyEmail",()=>en,"useUserAvatarUrl",()=>eo,"useUserData",()=>eh,"useUserDefaultRole",()=>ep,"useUserDisplayName",()=>eq,"useUserEmail",()=>er,"useUserId",()=>es,"useUserIsAnonymous",()=>et,"useUserLocale",()=>eu,"useUserRoles",()=>ev],10587),a.i(79436);let eA="nhostSession",eB=a=>{let b=a&&"auth"in a?a.auth.getSession():a;if(!b)return void bs.remove(eA);let{refreshToken:c,...d}=b,e=new Date;e.setSeconds(e.getSeconds()+b.accessTokenExpiresIn-60),bs.set(eA,JSON.stringify(d),{sameSite:"strict",expires:e})};class eC extends dS{constructor(a){super({...a,autoSignIn:!1,autoRefreshToken:!1,clientStorageType:"cookie"}),this.auth.onAuthStateChanged(()=>{eB(this)}),this.auth.onTokenChanged(eB)}}a.s(["NhostClient",()=>eC],81307),a.i(10587),a.s(["NhostProvider",()=>dU,"useAuthenticationStatus",()=>dW],50693)}]);

//# sourceMappingURL=node_modules__pnpm_b2e1a990._.js.map