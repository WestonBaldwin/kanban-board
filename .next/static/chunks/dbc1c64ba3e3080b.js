(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77013,(e,t,r)=>{!function(n){"use strict";function i(e){var t,i=e&&e.Promise||n.Promise,s=e&&e.XMLHttpRequest||n.XMLHttpRequest;return t=Object.create(n,{fetch:{value:void 0,writable:!0}}),function(e){var r=void 0!==t&&t||"undefined"!=typeof self&&self||void 0!==r&&r,n={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};if(n.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n.iterable&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function h(e){if(e.bodyUsed)return i.reject(TypeError("Already read"));e.bodyUsed=!0}function p(e){return new i(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function f(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){if(this.bodyUsed=this.bodyUsed,this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(n.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(n.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else{var t;n.arrayBuffer&&n.blob&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||a(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e)}else this._bodyText="";!this.headers.get("content-type")&&("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return i.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return i.resolve(new Blob([this._bodyArrayBuffer]));if(!this._bodyFormData)return i.resolve(new Blob([this._bodyText]));throw Error("could not read FormData body as blob")},this.arrayBuffer=function(){if(!this._bodyArrayBuffer)return this.blob().then(f);var e=h(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?i.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):i.resolve(this._bodyArrayBuffer))}),this.text=function(){var e,t,r,n=h(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,r=p(t=new FileReader),t.readAsText(e),r;if(this._bodyArrayBuffer)return i.resolve(function(e){for(var t=new Uint8Array(e),r=Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(!this._bodyFormData)return i.resolve(this._bodyText);throw Error("could not read FormData body as text")},n.formData&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=c(e),t=l(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},d.prototype.delete=function(e){delete this.map[c(e)]},d.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},d.prototype.set=function(e,t){this.map[c(e)]=l(t)},d.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},d.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),u(e)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},d.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),u(e)},n.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function g(e,t){if(!(this instanceof g))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,n,i=(t=t||{}).body;if(e instanceof g){if(e.bodyUsed)throw TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",(t.headers||!this.headers)&&(this.headers=new d(t.headers)),this.method=(n=(r=t.method||this.method||"GET").toUpperCase(),y.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(i),("GET"===this.method||"HEAD"===this.method)&&("no-store"===t.cache||"no-cache"===t.cache)){var s=/([?&])_=[^&]*/;s.test(this.url)?this.url=this.url.replace(s,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime()}}function E(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function T(e,t){if(!(this instanceof T))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},m.call(g.prototype),m.call(T.prototype),T.prototype.clone=function(){return new T(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},T.error=function(){var e=new T(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];T.redirect=function(e,t){if(-1===S.indexOf(t))throw RangeError("Invalid status code");return new T(null,{status:t,headers:{location:e}})},e.DOMException=r.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function k(t,o){return new i(function(i,a){var c=new g(t,o);if(c.signal&&c.signal.aborted)return a(new e.DOMException("Aborted","AbortError"));var u=new s;function h(){u.abort()}u.onload=function(){var e,t,r={status:u.status,statusText:u.statusText,headers:(e=u.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}}),t)};r.url="responseURL"in u?u.responseURL:r.headers.get("X-Request-URL");var n="response"in u?u.response:u.responseText;setTimeout(function(){i(new T(n,r))},0)},u.onerror=function(){setTimeout(function(){a(TypeError("Network request failed"))},0)},u.ontimeout=function(){setTimeout(function(){a(TypeError("Network request failed"))},0)},u.onabort=function(){setTimeout(function(){a(new e.DOMException("Aborted","AbortError"))},0)},u.open(c.method,function(e){try{return""===e&&r.location.href?r.location.href:e}catch(t){return e}}(c.url),!0),"include"===c.credentials?u.withCredentials=!0:"omit"===c.credentials&&(u.withCredentials=!1),"responseType"in u&&(n.blob?u.responseType="blob":n.arrayBuffer&&c.headers.get("Content-Type")&&-1!==c.headers.get("Content-Type").indexOf("application/octet-stream")&&(u.responseType="arraybuffer")),!o||"object"!=typeof o.headers||o.headers instanceof d?c.headers.forEach(function(e,t){u.setRequestHeader(t,e)}):Object.getOwnPropertyNames(o.headers).forEach(function(e){u.setRequestHeader(e,l(o.headers[e]))}),c.signal&&(c.signal.addEventListener("abort",h),u.onreadystatechange=function(){4===u.readyState&&c.signal.removeEventListener("abort",h)}),u.send(void 0===c._bodyInit?null:c._bodyInit)})}k.polyfill=!0,r.fetch||(r.fetch=k,r.Headers=d,r.Request=g,r.Response=T),e.Headers=d,e.Request=g,e.Response=T,e.fetch=k,Object.defineProperty(e,"__esModule",{value:!0})}(r),{fetch:t.fetch,Headers:t.Headers,Request:t.Request,Response:t.Response,DOMException:t.DOMException}}if("function"==typeof define&&define.amd)e.r,void 0!==i&&e.v(i);else t.exports=i}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:e.g)},90452,(e,t,r)=>{"use strict";t.exports=self.fetch.bind(self),t.exports.default=t.exports},7983,(e,t,r)=>{"use strict";var n=e.r(778),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=n.useState,o=n.useEffect,a=n.useLayoutEffect,c=n.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!i(e,r)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=s({inst:{value:r,getSnapshot:t}}),i=n[0].inst,u=n[1];return a(function(){i.value=r,i.getSnapshot=t,l(i)&&u({inst:i})},[e,r,t]),o(function(){return l(i)&&u({inst:i}),e(function(){l(i)&&u({inst:i})})},[e]),c(r),r};r.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:u},33347,(e,t,r)=>{"use strict";t.exports=e.r(7983)},83842,(e,t,r)=>{"use strict";var n=e.r(778),i=e.r(33347),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=i.useSyncExternalStore,a=n.useRef,c=n.useEffect,l=n.useMemo,u=n.useDebugValue;r.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var d=a(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;var p=o(e,(d=l(function(){function e(e){if(!c){if(c=!0,o=e,e=n(e),void 0!==i&&h.hasValue){var t=h.value;if(i(t,e))return a=t}return a=e}if(t=a,s(o,e))return t;var r=n(e);return void 0!==i&&i(t,r)?(o=e,t):(o=e,a=r)}var o,a,c=!1,l=void 0===r?null:r;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,r,n,i]))[0],d[1]);return c(function(){h.hasValue=!0,h.value=p},[p]),u(p),p}},51165,(e,t,r)=>{"use strict";t.exports=e.r(83842)},14929,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.__assign=function(){return r.__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.__assign.apply(this,arguments)},r.__read=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},r.__rest=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r},r.__spreadArray=function(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},r.__values=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}},20831,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e.r(14929),i={timeout:1e4};r.waitFor=function(e,t,r){var s=n.__assign(n.__assign({},i),r);return new Promise(function(r,n){var i=!1,o=s.timeout===1/0?void 0:setTimeout(function(){c.unsubscribe(),n(Error("Timeout of ".concat(s.timeout," ms exceeded")))},s.timeout),a=function(){clearTimeout(o),i=!0,null==c||c.unsubscribe()},c=e.subscribe({next:function(e){t(e)&&(a(),r(e))},error:function(e){a(),n(e)},complete:function(){a(),n(Error("Actor terminated without satisfying predicate"))}});i&&c.unsubscribe()})}},36446,73893,e=>{"use strict";var t,r,n,i,s,o,a,c,l,u,d,h,p,f,v,m,y=e.i(27171);class g extends Error{}function E(e,t){let r;if("string"!=typeof e)throw new g("Invalid token specified: must be a string");t||(t={});let n=+(!0!==t.header),i=e.split(".")[n];if("string"!=typeof i)throw new g(`Invalid token specified: missing part #${n+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(i)}catch(e){throw new g(`Invalid token specified: invalid base64 for part #${n+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new g(`Invalid token specified: invalid json for part #${n+1} (${e.message})`)}}g.prototype.name="InvalidTokenError";var T=function(){return(T=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function S(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function k(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function x(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function b(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}(t=l||(l={})).Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose",(r=u||(u={})).Parent="#_parent",r.Internal="#_internal";var w=l.Start,A=l.Stop,_=l.Raise,I=l.Send,O=l.Cancel,N=l.NullEvent,D=l.Assign,R=l.After,P=l.DoneState,C=l.Log,U=l.Init,L=l.Invoke,M=l.ErrorExecution,j=l.ErrorPlatform,F=l.ErrorCustom,V=l.Update,B=l.Choose,$=l.Pure;e.s(["after",()=>R,"assign",()=>D,"cancel",()=>O,"choose",()=>B,"doneState",()=>P,"error",()=>F,"errorExecution",()=>M,"errorPlatform",()=>j,"init",()=>U,"invoke",()=>L,"log",()=>C,"nullEvent",()=>N,"pure",()=>$,"raise",()=>_,"send",()=>I,"start",()=>w,"stop",()=>A,"update",()=>V],58847);var K={},G="xstate.guard";function q(e,t,r){void 0===r&&(r=".");var n=z(e,r),i=z(t,r);return ec(i)?!!ec(n)&&i===n:ec(n)?n in i:Object.keys(n).every(function(e){return e in i&&q(n[e],i[e])})}function H(e){try{return ec(e)||"number"==typeof e?"".concat(e):e.type}catch(e){throw Error("Events must be strings or objects with a string event.type property.")}}function Y(e,t){try{if(eo(e))return e;return e.toString().split(t)}catch(t){throw Error("'".concat(e,"' is not a valid state path."))}}function z(e,t){return"object"==typeof e&&"value"in e&&"context"in e&&"event"in e&&"_event"in e?e.value:eo(e)?J(e):"string"!=typeof e?e:J(Y(e,t))}function J(e){if(1===e.length)return e[0];for(var t={},r=t,n=0;n<e.length-1;n++)n===e.length-2?r[e[n]]=e[n+1]:(r[e[n]]={},r=r[e[n]]);return t}function W(e,t){for(var r={},n=Object.keys(e),i=0;i<n.length;i++){var s=n[i];r[s]=t(e[s],s,e,i)}return r}function Q(e,t,r){var n,i,s={};try{for(var o=k(Object.keys(e)),a=o.next();!a.done;a=o.next()){var c=a.value,l=e[c];r(l)&&(s[c]=t(l,c,e))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}var X=function(e){return function(t){var r,n,i=t;try{for(var s=k(e),o=s.next();!o.done;o=s.next())i=i[o.value]}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}};function Z(e){return e?ec(e)?[[e]]:ee(Object.keys(e).map(function(t){var r=e[t];return"string"==typeof r||r&&Object.keys(r).length?Z(e[t]).map(function(e){return[t].concat(e)}):[[t]]})):[[]]}function ee(e){var t;return(t=[]).concat.apply(t,b([],x(e),!1))}function et(e){var t;return void 0===e?[]:eo(t=e)?t:[t]}function er(e,t,r){if(ea(e))return e(t,r.data);var n,i,s={};try{for(var o=k(Object.keys(e)),a=o.next();!a.done;a=o.next()){var c=a.value,l=e[c];ea(l)?s[c]=l(t,r.data):s[c]=l}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}function en(e){return!!(e instanceof Promise||null!==e&&(ea(e)||"object"==typeof e)&&ea(e.then))}function ei(e,t,r,n){return e?r.reduce(function(e,r){var i,s,o=r.assignment,a={state:n,action:r,_event:t},c={};if(ea(o))c=o(e,t.data,a);else try{for(var l=k(Object.keys(o)),u=l.next();!u.done;u=l.next()){var d=u.value,h=o[d];c[d]=ea(h)?h(e,t.data,a):h}}catch(e){i={error:e}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}return Object.assign({},e,c)},e):e}var es=function(){};function eo(e){return Array.isArray(e)}function ea(e){return"function"==typeof e}function ec(e){return"string"==typeof e}function el(e,t){if(e)return ec(e)?{type:G,name:e,predicate:t?t[e]:void 0}:ea(e)?{type:G,name:e.name,predicate:e}:e}var eu="function"==typeof Symbol&&Symbol.observable||"@@observable";function ed(e){return!!e&&"__xstatenode"in e}(d={})[eu]=function(){return this},d[Symbol.observable]=function(){return this};var eh=(n=0,function(){return n++,n.toString(16)});function ep(e,t){return ec(e)||"number"==typeof e?T({type:e},t):e}function ef(e,t){if(!ec(e)&&"$$type"in e&&"scxml"===e.$$type)return e;var r=ep(e);return T({name:r.type,data:r,$$type:"scxml",type:"external"},t)}function ev(e,t){var r;return(eo(r=t)?r:[r]).map(function(t){return void 0===t||"string"==typeof t||ed(t)?{target:t,event:e}:T(T({},t),{event:e})})}function em(e,t,r,n,i){var s=e.options.guards,o={state:i,cond:t,_event:n};if(t.type===G)return((null==s?void 0:s[t.name])||t.predicate)(r,n.data,o);var a=null==s?void 0:s[t.type];if(!a)throw Error("Guard '".concat(t.type,"' is not implemented on machine '").concat(e.id,"'."));return a(r,n.data,o)}function ey(e){return"string"==typeof e?{type:e}:e}function eg(e,t,r){var n=function(){},i="object"==typeof e,s=i?e:null;return{next:((i?e.next:e)||n).bind(s),error:((i?e.error:t)||n).bind(s),complete:((i?e.complete:r)||n).bind(s)}}function eE(e,t){return"".concat(e,":invocation[").concat(t,"]")}function eT(e){return(e.type===_||e.type===I&&e.to===u.Internal)&&"number"!=typeof e.delay}var eS=function(e){return"atomic"===e.type||"final"===e.type};function ek(e){return Object.keys(e.states).map(function(t){return e.states[t]})}function ex(e){return ek(e).filter(function(e){return"history"!==e.type})}function eb(e,t){var r,n,i,s,o,a,c,l,u=ew(new Set(e)),d=new Set(t);try{for(var h=k(d),p=h.next();!p.done;p=h.next())for(var f=p.value,v=f.parent;v&&!d.has(v);)d.add(v),v=v.parent}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}var m=ew(d);try{for(var y=k(d),g=y.next();!g.done;g=y.next()){var f=g.value;if("compound"!==f.type||m.get(f)&&m.get(f).length){if("parallel"===f.type)try{for(var E=(o=void 0,k(ex(f))),T=E.next();!T.done;T=E.next()){var S=T.value;d.has(S)||(d.add(S),u.get(S)?u.get(S).forEach(function(e){return d.add(e)}):S.initialStateNodes.forEach(function(e){return d.add(e)}))}}catch(e){o={error:e}}finally{try{T&&!T.done&&(a=E.return)&&a.call(E)}finally{if(o)throw o.error}}}else u.get(f)?u.get(f).forEach(function(e){return d.add(e)}):f.initialStateNodes.forEach(function(e){return d.add(e)})}}catch(e){i={error:e}}finally{try{g&&!g.done&&(s=y.return)&&s.call(y)}finally{if(i)throw i.error}}try{for(var x=k(d),b=x.next();!b.done;b=x.next())for(var f=b.value,v=f.parent;v&&!d.has(v);)d.add(v),v=v.parent}catch(e){c={error:e}}finally{try{b&&!b.done&&(l=x.return)&&l.call(x)}finally{if(c)throw c.error}}return d}function ew(e){var t,r,n=new Map;try{for(var i=k(e),s=i.next();!s.done;s=i.next()){var o=s.value;n.has(o)||n.set(o,[]),o.parent&&(n.has(o.parent)||n.set(o.parent,[]),n.get(o.parent).push(o))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n}function eA(e,t){return Array.isArray(e)?e.some(function(e){return e===t}):e instanceof Set&&e.has(t)}function e_(e,t){return"compound"===t.type?ex(t).some(function(t){return"final"===t.type&&eA(e,t)}):"parallel"===t.type&&ex(t).every(function(t){return e_(e,t)})}function eI(e){return new Set(ee(e.map(function(e){return e.tags})))}var eO=e.i(58847),eN=ef({type:U});function eD(e,t){return t&&t[e]||void 0}function eR(e,t){var r;if(ec(e)||"number"==typeof e){var n=eD(e,t);r=ea(n)?{type:e,exec:n}:n||{type:e,exec:void 0}}else if(ea(e))r={type:e.name||e.toString(),exec:e};else{var n=eD(e.type,t);if(ea(n))r=T(T({},e),{exec:n});else if(n){var i=n.type||e.type;r=T(T(T({},n),e),{type:i})}else r=e}return r}var eP=function(e,t){return e?(eo(e)?e:[e]).map(function(e){return eR(e,t)}):[]};function eC(e){var t=eR(e);return T(T({id:ec(e)?e:t.id},t),{type:t.type})}function eU(e,t){return{type:_,event:"function"==typeof e?e:ep(e),delay:t?t.delay:void 0,id:null==t?void 0:t.id}}function eL(e,t,r,n){var i,s={_event:r},o=ef(ea(e.event)?e.event(t,r.data,s):e.event);if(ec(e.delay)){var a=n&&n[e.delay];i=ea(a)?a(t,r.data,s):a}else i=ea(e.delay)?e.delay(t,r.data,s):e.delay;return T(T({},e),{type:_,_event:o,delay:i})}function eM(e,t){return{to:t?t.to:void 0,type:I,event:ea(e)?e:ep(e),delay:t?t.delay:void 0,id:t&&void 0!==t.id?t.id:ea(e)?e.name:H(e)}}function ej(e,t,r,n){var i,s={_event:r},o=ef(ea(e.event)?e.event(t,r.data,s):e.event);if(ec(e.delay)){var a=n&&n[e.delay];i=ea(a)?a(t,r.data,s):a}else i=ea(e.delay)?e.delay(t,r.data,s):e.delay;var c=ea(e.to)?e.to(t,r.data,s):e.to;return T(T({},e),{to:c,_event:o,event:o.data,delay:i})}function eF(e,t){return eM(e,T(T({},t),{to:u.Parent}))}function eV(e,t,r){return eM(t,T(T({},r),{to:e}))}function eB(){return eF(V)}function e$(e,t){return eM(e,T(T({},t),{to:function(e,t,r){return r._event.origin}}))}var eK=function(e,t){return{context:e,event:t}};function eG(e,t){return void 0===e&&(e=eK),{type:C,label:t,expr:e}}var eq=function(e,t,r){return T(T({},e),{value:ec(e.expr)?e.expr:e.expr(t,r.data,{_event:r})})},eH=function(e){return{type:O,sendId:e}};function eY(e){var t=eC(e);return{type:l.Start,activity:t,exec:void 0}}function ez(e){var t=ea(e)?e:eC(e);return{type:l.Stop,activity:t,exec:void 0}}function eJ(e,t,r){var n=ea(e.activity)?e.activity(t,r.data):e.activity;return{type:l.Stop,activity:"string"==typeof n?{id:n}:n}}var eW=function(e){return{type:D,assignment:e}};function eQ(e){return"object"==typeof e&&"type"in e}function eX(e,t){return"".concat(l.After,"(").concat(e,")").concat(t?"#".concat(t):"")}function eZ(e,t){var r="".concat(l.DoneState,".").concat(e),n={type:r,data:t};return n.toString=function(){return r},n}function e0(e,t){var r="".concat(l.DoneInvoke,".").concat(e),n={type:r,data:t};return n.toString=function(){return r},n}function e1(e,t){var r="".concat(l.ErrorPlatform,".").concat(e),n={type:r,data:t};return n.toString=function(){return r},n}function e2(e){return{type:l.Pure,get:e}}function e3(e,t){return eM(function(e,t){return t},T(T({},t),{to:e}))}function e4(e,t){return eF(function(t,r,n){return{type:F,data:ea(e)?e(t,r,n):e}},T(T({},t),{to:u.Parent}))}function e8(e){return{type:l.Choose,conds:e}}var e9=function(e){var t,r,n=[];try{for(var i=k(e),s=i.next();!s.done;s=i.next())for(var o=s.value,a=0;a<o.actions.length;){if(o.actions[a].type===D){n.push(o.actions[a]),o.actions.splice(a,1);continue}a++}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n};function e5(e,t,r,n,i,s,o){void 0===o&&(o=!1);var a=o?[]:e9(i),c=a.length?ei(r,n,a,t):r,l=o?[r]:void 0,d=[];return[ee(i.map(function(i){var a,h,p=[];try{for(var f=k(i.actions),v=f.next();!v.done;v=f.next()){var m=v.value,y=function(i,a){var h;switch(a.type){case _:var p=eL(a,c,n,e.options.delays);return s&&"number"==typeof p.delay&&s(p,c,n),p;case I:var f=ej(a,c,n,e.options.delays);return s&&f.to!==u.Internal&&("entry"===i?d.push(f):s(f,c,n)),f;case C:var v=eq(a,c,n);return null==s||s(v,c,n),v;case B:var m=null==(h=a.conds.find(function(r){var i=el(r.cond,e.options.guards);return!i||em(e,i,c,n,s?void 0:t)}))?void 0:h.actions;if(!m)return[];var y=x(e5(e,t,c,n,[{type:i,actions:eP(et(m),e.options.actions)}],s,o),2),g=y[0];return c=y[1],null==l||l.push(c),g;case $:var m=a.get(c,n.data);if(!m)return[];var E=x(e5(e,t,c,n,[{type:i,actions:eP(et(m),e.options.actions)}],s,o),2),S=E[0];return c=E[1],null==l||l.push(c),S;case A:var v=eJ(a,c,n);return null==s||s(v,r,n),v;case D:c=ei(c,n,[a],s?void 0:t),null==l||l.push(c);break;default:var k=eR(a,e.options.actions),w=k.exec;if(s)s(k,c,n);else if(w&&l){var O=l.length-1;k=T(T({},k),{exec:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];w.apply(void 0,b([l[O]],x(t),!1))}})}return k}}(i.type,m);y&&(p=p.concat(y))}}catch(e){a={error:e}}finally{try{v&&!v.done&&(h=f.return)&&h.call(f)}finally{if(a)throw a.error}}return d.forEach(function(e){s(e,c,n)}),d.length=0,p})),c]}e.s(["after",()=>eX,"assign",()=>eW,"cancel",()=>eH,"choose",()=>e8,"done",()=>eZ,"doneInvoke",()=>e0,"error",()=>e1,"escalate",()=>e4,"forwardTo",()=>e3,"getActionFunction",()=>eD,"initEvent",()=>eN,"isActionObject",()=>eQ,"log",()=>eG,"pure",()=>e2,"raise",()=>eU,"resolveActions",()=>e5,"resolveLog",()=>eq,"resolveRaise",()=>eL,"resolveSend",()=>ej,"resolveStop",()=>eJ,"respond",()=>e$,"send",()=>eM,"sendParent",()=>eF,"sendTo",()=>eV,"sendUpdate",()=>eB,"start",()=>eY,"stop",()=>ez,"toActionObject",()=>eR,"toActionObjects",()=>eP,"toActivityDefinition",()=>eC],51105);var e6=function(){function e(e){var t,r,n=this;this.actions=[],this.activities=K,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||K,this.meta=(void 0===(t=e.configuration)&&(t=[]),t.reduce(function(e,t){return void 0!==t.meta&&(e[t.id]=t.meta),e},{})),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=null!=(r=Array.isArray(e.tags)?new Set(e.tags):e.tags)?r:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return b([],x(new Set(ee(b([],x(n.configuration.map(function(e){return e.ownEvents})),!1)))),!1)}})}return e.from=function(t,r){return t instanceof e?t.context!==r?new e({value:t.value,context:r,_event:t._event,_sessionid:null,historyValue:t.historyValue,history:t.history,actions:[],activities:t.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):t:new e({value:t,context:r,_event:eN,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(t){return new e(t)},e.inert=function(t,r){return t instanceof e?t.actions.length?new e({value:t.value,context:r,_event:eN,_sessionid:null,historyValue:t.historyValue,history:t.history,activities:t.activities,configuration:t.configuration,transitions:[],children:{}}):t:e.from(t,r)},e.prototype.toStrings=function(e,t){var r=this;if(void 0===e&&(e=this.value),void 0===t&&(t="."),ec(e))return[e];var n=Object.keys(e);return n.concat.apply(n,b([],x(n.map(function(n){return r.toStrings(e[n],t).map(function(e){return n+t+e})})),!1))},e.prototype.toJSON=function(){this.configuration,this.transitions;var e=this.tags;this.machine;var t=S(this,["configuration","transitions","tags","machine"]);return T(T({},t),{tags:Array.from(e)})},e.prototype.matches=function(e){return q(e,this.value)},e.prototype.hasTag=function(e){return this.tags.has(e)},e.prototype.can=function(e){es(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var t,r=null==(t=this.machine)?void 0:t.getTransitionData(this,e);return!!(null==r?void 0:r.transitions.length)&&r.transitions.some(function(e){return void 0!==e.target||e.actions.length})},e}(),e7=[],te=function(e,t){e7.push(e);var r=t(e);return e7.pop(),r};function tt(e){var t;return(t={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:e}}})[eu]=function(){return this},t}function tr(e,t,r){var n=tt(t);if(n.deferred=!0,ed(e)){var i=n.state=te(void 0,function(){return(r?e.withContext(r):e).initialState});n.getSnapshot=function(){return i}}return n}function tn(e){return T(T({type:L},e),{toJSON:function(){e.onDone,e.onError;var t=S(e,["onDone","onError"]);return T(T({},t),{type:L,src:function(e){if("string"==typeof e){var t={type:e};return t.toString=function(){return e},t}return e}(e.src)})}})}var ti={},ts=function(e){return"#"===e[0]},to=function(){function e(t,r,n,i){void 0===n&&(n="context"in t?t.context:void 0);var s,o=this;this.config=t,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},r),this.parent=null==i?void 0:i.parent,this.key=this.config.key||(null==i?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||b([this.machine.key],x(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!=(s=this.config.schema)?s:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?W(this.config.states,function(t,r){var n,i=new e(t,{},void 0,{parent:o,key:r});return Object.assign(o.idMap,T(((n={})[i.id]=i,n),i.idMap)),i}):ti;var a=0;!function e(t){var r,n;t.order=a++;try{for(var i=k(ek(t)),s=i.next();!s.done;s=i.next()){var o=s.value;e(o)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some(function(e){return""===e.event}):""in this.config.on),this.strict=!!this.config.strict,this.onEntry=et(this.config.entry||this.config.onEntry).map(function(e){return eR(e)}),this.onExit=et(this.config.exit||this.config.onExit).map(function(e){return eR(e)}),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=et(this.config.invoke).map(function(e,t){if(ed(e)){var r,n,i=eE(o.id,t);return o.machine.options.services=T(((r={})[i]=e,r),o.machine.options.services),tn({src:i,id:i})}if(ec(e.src)){var i=e.id||eE(o.id,t);return tn(T(T({},e),{id:i,src:e.src}))}if(ed(e.src)||ea(e.src)){var i=e.id||eE(o.id,t);return o.machine.options.services=T(((n={})[i]=e.src,n),o.machine.options.services),tn(T(T({id:i},e),{src:i}))}var s=e.src;return tn(T(T({id:eE(o.id,t)},e),{src:s}))}),this.activities=et(this.config.activities).concat(this.invoke).map(function(e){return eC(e)}),this.transition=this.transition.bind(this),this.tags=et(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||(function e(t){var r=[t];return eS(t)?r:r.concat(ee(ex(t).map(e)))})(this).forEach(function(e){return e.on})},e.prototype.withConfig=function(t,r){var n=this.options,i=n.actions,s=n.activities,o=n.guards,a=n.services,c=n.delays;return new e(this.config,{actions:T(T({},i),t.actions),activities:T(T({},s),t.activities),guards:T(T({},o),t.guards),services:T(T({},a),t.services),delays:T(T({},c),t.delays)},null!=r?r:this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},Object.defineProperty(e.prototype,"context",{get:function(){return ea(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:W(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(e,t){return e[t.eventType]=e[t.eventType]||[],e[t.eventType].push(t),e},{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=""===e,r=this.transitions.filter(function(r){var n=r.eventType===e;return t?n:n||"*"===r.eventType});return this.__cache.candidates[e]=r,r},e.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var r=function(t,r){var n=eX(ea(t)?"".concat(e.id,":delay[").concat(r,"]"):t,e.id);return e.onEntry.push(eM(n,{delay:t})),e.onExit.push(eH(n)),n};return(eo(t)?t.map(function(e,t){var n=r(e.delay,t);return T(T({},e),{event:n})}):ee(Object.keys(t).map(function(e,n){var i=t[e],s=ec(i)?{target:i}:i,o=isNaN(+e)?e:+e,a=r(o,n);return et(s).map(function(e){return T(T({},e),{event:a,delay:o})})}))).map(function(t){var r=t.delay;return T(T({},e.formatTransition(t)),{delay:r})})},e.prototype.getStateNodes=function(e){var t,r=this;if(!e)return[];var n=e instanceof e6?e.value:z(e,this.delimiter);if(ec(n)){var i=this.getStateNode(n).initial;return void 0!==i?this.getStateNodes(((t={})[n]=i,t)):[this,this.states[n]]}var s=Object.keys(n),o=[this];return o.push.apply(o,b([],x(ee(s.map(function(e){return r.getStateNode(e).getStateNodes(n[e])}))),!1)),o},e.prototype.handles=function(e){var t=H(e);return this.events.includes(t)},e.prototype.resolveState=function(e){var t=e instanceof e6?e:e6.create(e),r=Array.from(eb([],this.getStateNodes(t.value)));return new e6(T(T({},t),{value:this.resolve(t.value),configuration:r,done:e_(r,this),tags:eI(r),machine:this.machine}))},e.prototype.transitionLeafNode=function(e,t,r){var n=this.getStateNode(e).next(t,r);return n&&n.transitions.length?n:this.next(t,r)},e.prototype.transitionCompoundNode=function(e,t,r){var n=Object.keys(e),i=this.getStateNode(n[0])._transition(e[n[0]],t,r);return i&&i.transitions.length?i:this.next(t,r)},e.prototype.transitionParallelNode=function(e,t,r){var n,i,s={};try{for(var o=k(Object.keys(e)),a=o.next();!a.done;a=o.next()){var c=a.value,l=e[c];if(l){var u=this.getStateNode(c)._transition(l,t,r);u&&(s[c]=u)}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}var d=Object.keys(s).map(function(e){return s[e]}),h=ee(d.map(function(e){return e.transitions}));if(!d.some(function(e){return e.transitions.length>0}))return this.next(t,r);var p=ee(Object.keys(s).map(function(e){return s[e].configuration}));return{transitions:h,exitSet:ee(d.map(function(e){return e.exitSet})),configuration:p,source:t,actions:ee(Object.keys(s).map(function(e){return s[e].actions}))}},e.prototype._transition=function(e,t,r){return ec(e)?this.transitionLeafNode(e,t,r):1===Object.keys(e).length?this.transitionCompoundNode(e,t,r):this.transitionParallelNode(e,t,r)},e.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,ef(t))},e.prototype.next=function(e,t){var r,n,i,s=this,o=t.name,a=[],c=[];try{for(var l=k(this.getCandidates(o)),u=l.next();!u.done;u=l.next()){var d=u.value,h=d.cond,p=d.in,f=e.context,v=!p||(ec(p)&&ts(p)?e.matches(z(this.getStateNodeById(p).path,this.delimiter)):q(z(p,this.delimiter),X(this.path.slice(0,-2))(e.value))),m=!1;try{m=!h||em(this.machine,h,f,t,e)}catch(e){throw Error("Unable to evaluate guard '".concat(h.name||h.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,"':\n").concat(e.message))}if(m&&v){void 0!==d.target&&(c=d.target),a.push.apply(a,b([],x(d.actions),!1)),i=d;break}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}if(i){if(!c.length)return{transitions:[i],exitSet:[],configuration:e.value?[this]:[],source:e,actions:a};var y=ee(c.map(function(t){return s.getRelativeStateNodes(t,e.historyValue)})),g=!!i.internal;return{transitions:[i],exitSet:g?[]:ee(c.map(function(e){return s.getPotentiallyReenteringNodes(e)})),configuration:y,source:e,actions:a}}},e.prototype.getPotentiallyReenteringNodes=function(e){if(this.order<e.order)return[this];for(var t=[],r=this;r&&r!==e;)t.push(r),r=r.parent;return r!==e?[]:(t.push(e),t)},e.prototype.getActions=function(e,t,r,n,i,s,o){var a,c,l,u,d=this,h=s?eb([],this.getStateNodes(s.value)):[],p=new Set;try{for(var f=k(Array.from(e).sort(function(e,t){return e.order-t.order})),v=f.next();!v.done;v=f.next()){var m=v.value;(!eA(h,m)||eA(r.exitSet,m)||m.parent&&p.has(m.parent))&&p.add(m)}}catch(e){a={error:e}}finally{try{v&&!v.done&&(c=f.return)&&c.call(f)}finally{if(a)throw a.error}}try{for(var y=k(h),g=y.next();!g.done;g=y.next()){var m=g.value;(!eA(e,m)||eA(r.exitSet,m.parent))&&r.exitSet.push(m)}}catch(e){l={error:e}}finally{try{g&&!g.done&&(u=y.return)&&u.call(y)}finally{if(l)throw l.error}}r.exitSet.sort(function(e,t){return t.order-e.order});var E=Array.from(p).sort(function(e,t){return e.order-t.order}),T=new Set(r.exitSet),S=ee(E.map(function(e){var t=[];if("final"!==e.type)return t;var s=e.parent;if(!s.parent)return t;t.push(eZ(e.id,e.doneData),eZ(s.id,e.doneData?er(e.doneData,n,i):void 0));var o=s.parent;return"parallel"===o.type&&ex(o).every(function(e){return e_(r.configuration,e)})&&t.push(eZ(o.id)),t})),w=E.map(function(e){var t=e.onEntry,r=e.activities.map(function(e){return eY(e)});return{type:"entry",actions:eP(o?b(b([],x(t),!1),x(r),!1):b(b([],x(r),!1),x(t),!1),d.machine.options.actions)}}).concat({type:"state_done",actions:S.map(function(e){return eU(e)})}),A=Array.from(T).map(function(e){return{type:"exit",actions:eP(b(b([],x(e.onExit),!1),x(e.activities.map(function(e){return ez(e)})),!1),d.machine.options.actions)}}).concat({type:"transition",actions:eP(r.actions,this.machine.options.actions)}).concat(w);if(t){var _=eP(ee(b([],x(e),!1).sort(function(e,t){return t.order-e.order}).map(function(e){return e.onExit})),this.machine.options.actions).filter(function(e){return!eT(e)});return A.concat({type:"stop",actions:_})}return A},e.prototype.transition=function(e,t,r,n){void 0===e&&(e=this.initialState);var i,s,o=ef(t);if(e instanceof e6)s=void 0===r?e:this.resolveState(e6.from(e,r));else{var a=ec(e)?this.resolve(J(this.getResolvedPath(e))):this.resolve(e),c=null!=r?r:this.machine.context;s=this.resolveState(e6.from(a,c))}if(this.strict&&!this.events.includes(o.name)&&(i=o.name,!/^(done|error)\./.test(i)))throw Error("Machine '".concat(this.id,"' does not accept event '").concat(o.name,"'"));var l=this._transition(s.value,s,o)||{transitions:[],configuration:[],exitSet:[],source:s,actions:[]},u=eb([],this.getStateNodes(s.value)),d=l.configuration.length?eb(u,l.configuration):u;return l.configuration=b([],x(d),!1),this.resolveTransition(l,s,s.context,n,o)},e.prototype.resolveRaisedTransition=function(e,t,r,n){var i,s=e.actions;return(e=this.transition(e,t,void 0,n))._event=r,e.event=r.data,(i=e.actions).unshift.apply(i,b([],x(s),!1)),e},e.prototype.resolveTransition=function(e,t,r,n,i){var s,o,a,c,l,u,d=this;void 0===i&&(i=eN);var h=e.configuration,p=!t||e.transitions.length>0,f=p?e.configuration:t?t.configuration:[],v=e_(f,this),m=p?(o=eb([s=this.machine],h),function e(t,r){var n=r.get(t);if(!n)return{};if("compound"===t.type){var i=n[0];if(!i)return{};if(eS(i))return i.key}var s={};return n.forEach(function(t){s[t.key]=e(t,r)}),s}(s,ew(o))):void 0,y=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,g=this.getActions(new Set(f),v,e,r,i,t,n),E=t?T({},t.activities):{};try{for(var S=k(g),b=S.next();!b.done;b=S.next()){var _=b.value;try{for(var I=(l=void 0,k(_.actions)),O=I.next();!O.done;O=I.next()){var D=O.value;D.type===w?E[D.activity.id||D.activity.type]=D:D.type===A&&(E[D.activity.id||D.activity.type]=!1)}}catch(e){l={error:e}}finally{try{O&&!O.done&&(u=I.return)&&u.call(I)}finally{if(l)throw l.error}}}}catch(e){a={error:e}}finally{try{b&&!b.done&&(c=S.return)&&c.call(S)}finally{if(a)throw a.error}}var R=x(e5(this,t,r,i,g,n,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),P=R[0],C=R[1],U=x(function(e,t){var r,n,i=x([[],[]],2),s=i[0],o=i[1];try{for(var a=k(e),c=a.next();!c.done;c=a.next()){var l=c.value;t(l)?s.push(l):o.push(l)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return[s,o]}(P,eT),2),M=U[0],j=U[1],F=P.filter(function(e){var t;return e.type===w&&(null==(t=e.activity)?void 0:t.type)===L}).reduce(function(e,t){var r,n,s,o,a,c,l,u;return e[t.activity.id]=(r=t.activity,n=d.machine,s=i,a=ey(r.src),c=null==(o=null==n?void 0:n.options.services)?void 0:o[a.type],l=r.data?er(r.data,C,s):void 0,(u=c?tr(c,r.id,l):tt(r.id)).meta=r,u),e},t?T({},t.children):{}),B=new e6({value:m||t.value,context:C,_event:i,_sessionid:t?t._sessionid:null,historyValue:m?y?{current:m,states:function e(t,r){return W(t.states,function(t,n){if(t){var i=(ec(r)?void 0:r[n])||(t?t.current:void 0);if(i)return{current:i,states:e(t,i)}}})}(y,m)}:void 0:t?t.historyValue:void 0,history:!m||e.source?t:void 0,actions:m?j:[],activities:m?E:t?t.activities:{},events:[],configuration:f,transitions:e.transitions,children:F,done:v,tags:eI(f),machine:this}),$=r!==C;B.changed=i.name===V||$;var K=B.history;K&&delete K.history;var G=!v&&(this._transient||h.some(function(e){return e._transient}));if(!p&&(!G||""===i.name))return B;var q=B;if(!v)for(G&&(q=this.resolveRaisedTransition(q,{type:N},i,n));M.length;){var H=M.shift();q=this.resolveRaisedTransition(q,H._event,i,n)}var Y=q.changed||(K?!!q.actions.length||$||typeof K.value!=typeof q.value||!function e(t,r){if(t===r)return!0;if(void 0===t||void 0===r)return!1;if(ec(t)||ec(r))return t===r;var n=Object.keys(t),i=Object.keys(r);return n.length===i.length&&n.every(function(n){return e(t[n],r[n])})}(q.value,K.value):void 0);return q.changed=Y,q.history=K,q},e.prototype.getStateNode=function(e){if(ts(e))return this.machine.getStateNodeById(e);if(!this.states)throw Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},e.prototype.getStateNodeById=function(e){var t=ts(e)?e.slice(1):e;if(t===this.id)return this;var r=this.machine.idMap[t];if(!r)throw Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return r},e.prototype.getStateNodeByPath=function(e){if("string"==typeof e&&ts(e))try{return this.getStateNodeById(e.slice(1))}catch(e){}for(var t=Y(e,this.delimiter).slice(),r=this;t.length;){var n=t.shift();if(!n.length)break;r=r.getStateNode(n)}return r},e.prototype.resolve=function(e){var t,r=this;if(!e)return this.initialStateValue||ti;switch(this.type){case"parallel":return W(this.initialStateValue,function(t,n){return t?r.getStateNode(n).resolve(e[n]||t):ti});case"compound":if(ec(e)){var n=this.getStateNode(e);if("parallel"===n.type||"compound"===n.type)return(t={})[e]=n.initialStateValue,t;return e}if(!Object.keys(e).length)return this.initialStateValue||{};return W(e,function(e,t){return e?r.getStateNode(t).resolve(e):ti});default:return e||ti}},e.prototype.getResolvedPath=function(e){if(ts(e)){var t=this.machine.idMap[e.slice(1)];if(!t)throw Error("Unable to find state node '".concat(e,"'"));return t.path}return Y(e,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var e,t;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)t=Q(this.states,function(e){return e.initialStateValue||ti},function(e){return"history"!==e.type});else if(void 0!==this.initial){if(!this.states[this.initial])throw Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=eS(this.states[this.initial])?this.initial:((e={})[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(e,t){this._init();var r=this.getStateNodes(e);return this.resolveTransition({configuration:r,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=t?t:this.machine.context,void 0)},Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var e;if("history"===this.type){var t=this.config;e=ec(t.target)&&ts(t.target)?J(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target}return e},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(e,t,r){return void 0===r&&(r=!0),r?"history"===e.type?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var e=this;return eS(this)?[this]:"compound"!==this.type||this.initial?ee(Z(this.initialStateValue).map(function(t){return e.getFromRelativePath(t)})):[this]},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=x(e),r=t[0],n=t.slice(1);if(!this.states)throw Error("Cannot retrieve subPath '".concat(r,"' from node with no states"));var i=this.getStateNode(r);if("history"===i.type)return i.resolveHistory();if(!this.states[r])throw Error("Child state '".concat(r,"' does not exist on '").concat(this.id,"'"));return this.states[r].getFromRelativePath(n)},e.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:Q(this.states,function(t,r){if(!e)return t.historyValue();var n=ec(e)?void 0:e[r];return t.historyValue(n||t.initialStateValue)},function(e){return!e.history})}},e.prototype.resolveHistory=function(e){var t,r=this;if("history"!==this.type)return[this];var n=this.parent;if(!e){var i=this.target;return i?ee(Z(i).map(function(e){return n.getFromRelativePath(e)})):n.initialStateNodes}var s=(t=n.path,function(e){var r,n,i=e;try{for(var s=k(t),o=s.next();!o.done;o=s.next()){var a=o.value;i=i.states[a]}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i})(e).current;return ec(s)?[n.getStateNode(s)]:ee(Z(s).map(function(e){return"deep"===r.history?n.getFromRelativePath(e):[n.states[e[0]]]}))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var e=this,t=ee(Object.keys(this.states).map(function(t){return e.states[t].stateIds}));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){if(this.__cache.events)return this.__cache.events;var e,t,r,n,i=this.states,s=new Set(this.ownEvents);if(i)try{for(var o=k(Object.keys(i)),a=o.next();!a.done;a=o.next()){var c=i[a.value];if(c.states)try{for(var l=(r=void 0,k(c.events)),u=l.next();!u.done;u=l.next()){var d=u.value;s.add("".concat(d))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(s)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){return Array.from(new Set(this.transitions.filter(function(e){return!(!e.target&&!e.actions.length&&e.internal)}).map(function(e){return e.eventType})))},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(e){var t=this;if(void 0!==e)return e.map(function(e){if(!ec(e))return e;var r=e[0]===t.delimiter;if(r&&!t.parent)return t.getStateNodeByPath(e.slice(1));var n=r?t.key+e:e;if(!t.parent)return t.getStateNodeByPath(n);try{return t.parent.getStateNodeByPath(n)}catch(e){throw Error("Invalid transition definition for state node '".concat(t.id,"':\n").concat(e.message))}})},e.prototype.formatTransition=function(e){var t=this,r=function(e){if(void 0!==e&&""!==e)return et(e)}(e.target),n="internal"in e?e.internal:!r||r.some(function(e){return ec(e)&&e[0]===t.delimiter}),i=this.machine.options.guards,s=this.resolveTarget(r),o=T(T({},e),{actions:eP(et(e.actions)),cond:el(e.cond,i),target:s,source:this,internal:n,eventType:e.event,toJSON:function(){return T(T({},o),{target:o.target?o.target.map(function(e){return"#".concat(e.id)}):void 0,source:"#".concat(t.id)})}});return o},e.prototype.formatTransitions=function(){var e,t,r,n=this;if(this.config.on)if(Array.isArray(this.config.on))r=this.config.on;else{var i=this.config.on,s=i["*"],o=S(i,["*"]);r=ee(Object.keys(o).map(function(e){return ev(e,o[e])}).concat(ev("*",void 0===s?[]:s)))}else r=[];var a=this.config.always?ev("",this.config.always):[],c=this.config.onDone?ev(String(eZ(this.id)),this.config.onDone):[],l=ee(this.invoke.map(function(e){var t=[];return e.onDone&&t.push.apply(t,b([],x(ev(String(e0(e.id)),e.onDone)),!1)),e.onError&&t.push.apply(t,b([],x(ev(String(e1(e.id)),e.onError)),!1)),t})),u=this.after,d=ee(b(b(b(b([],x(c),!1),x(l),!1),x(r),!1),x(a),!1).map(function(e){return et(e).map(function(e){return n.formatTransition(e)})}));try{for(var h=k(u),p=h.next();!p.done;p=h.next()){var f=p.value;d.push(f)}}catch(t){e={error:t}}finally{try{p&&!p.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}return d},e}();function ta(e,t){return new to(e,t)}e.i(51105),e.s(["actionTypes",0,eO,"after",()=>eX,"assign",()=>eW,"cancel",()=>eH,"choose",()=>e8,"done",()=>eZ,"doneInvoke",()=>e0,"error",()=>e1,"escalate",()=>e4,"forwardTo",()=>e3,"getActionFunction",()=>eD,"initEvent",()=>eN,"isActionObject",()=>eQ,"log",()=>eG,"pure",()=>e2,"raise",()=>eU,"resolveActions",()=>e5,"resolveLog",()=>eq,"resolveRaise",()=>eL,"resolveSend",()=>ej,"resolveStop",()=>eJ,"respond",()=>e$,"send",()=>eM,"sendParent",()=>eF,"sendTo",()=>eV,"sendUpdate",()=>eB,"start",()=>eY,"stop",()=>ez,"toActionObject",()=>eR,"toActionObjects",()=>eP,"toActivityDefinition",()=>eC],57569);var tc=e.i(57569),tl={deferEvents:!1},tu=function(){function e(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=T(T({},tl),e)}return e.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents)return void this.schedule(e);this.process(e)}this.flushEvents()},e.prototype.schedule=function(e){if(!this.initialized||this.processingEvent)return void this.queue.push(e);if(0!==this.queue.length)throw Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},e.prototype.clear=function(){this.queue=[]},e.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},e.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(e){throw this.clear(),e}finally{this.processingEvent=!1}},e}(),td=new Map,th=0,tp=function(e){td.delete(e)};function tf(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:e.g}var tv={sync:!1,autoForward:!1};(i=h||(h={}))[i.NotStarted=0]="NotStarted",i[i.Running=1]="Running",i[i.Stopped=2]="Stopped";var tm=function(){function e(t,r){void 0===r&&(r=e.defaultOptions);var n=this;this.machine=t,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=h.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(e,t){if(eo(e))return n.batch(e),n.state;var r=ef(ep(e,t));if(n.status===h.Stopped)return n.state;if(n.status!==h.Running&&!n.options.deferEvents)throw Error('Event "'.concat(r.name,'" was sent to uninitialized service "').concat(n.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(r.data)));return n.scheduler.schedule(function(){n.forward(r);var e=n._nextState(r);n.update(e,r)}),n._state},this.sendTo=function(e,t,r){var i,s=n.parent&&(t===u.Parent||n.parent.id===t),o=s?n.parent:ec(t)?t===u.Internal?n:n.children.get(t)||(i=t,td.get(i)):t&&"function"==typeof t.send?t:void 0;if(!o){if(!s)throw Error("Unable to send event to child '".concat(t,"' from service '").concat(n.id,"'."));return}if("machine"in o){if(n.status!==h.Stopped||n.parent!==o||n.state.done){var a=T(T({},e),{name:e.name===F?"".concat(e1(n.id)):e.name,origin:n.sessionId});!r&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([o,a]):o.send(a)}}else!r&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([o,e.data]):o.send(e.data)},this._exec=function(e,t,r,i){void 0===i&&(i=n.machine.options.actions);var s=e.exec||eD(e.type,i),o=ea(s)?s:s?s.exec:e.exec;if(o)try{return o(t,r.data,n.machine.config.predictableActionArguments?{action:e,_event:r}:{action:e,state:n.state,_event:r})}catch(e){throw n.parent&&n.parent.send({type:"xstate.error",data:e}),e}switch(e.type){case _:n.defer(e);break;case I:if("number"==typeof e.delay)return void n.defer(e);e.to?n.sendTo(e._event,e.to,r===eN):n.send(e._event);break;case O:n.cancel(e.sendId);break;case w:if(n.status!==h.Running)return;var a=e.activity;if(!n.machine.config.predictableActionArguments&&!n.state.activities[a.id||a.type])break;if(a.type===l.Invoke){var c=ey(a.src),u=n.machine.options.services?n.machine.options.services[c.type]:void 0,d=a.id,p=a.data,f="autoForward"in a?a.autoForward:!!a.forward;if(!u)return;var v=p?er(p,t,r):void 0;if("string"==typeof u)return;var m=ea(u)?u(t,r.data,{data:v,src:c,meta:a.meta}):u;if(!m)return;var y=void 0;ed(m)&&(m=v?m.withContext(v):m,y={autoForward:f}),n.spawn(m,d,y)}else n.spawnActivity(a);break;case A:n.stopChild(e.activity.id);break;case C:var g=e.label,E=e.value;g?n.logger(g,E):n.logger(E)}};var i=T(T({},e.defaultOptions),r),s=i.clock,o=i.logger,a=i.parent,c=i.id,d=void 0!==c?c:t.id;this.id=d,this.logger=o,this.clock=s,this.parent=a,this.options=i,this.scheduler=new tu({deferEvents:this.options.deferEvents}),this.sessionId="x:".concat(th++)}return Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:te(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){var r,n;try{for(var i=k(e.actions),s=i.next();!s.done;s=i.next()){var o=s.value;this.exec(o,e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.update=function(e,t){var r,n,i,s,o,a,c,l,u=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||t===eN)&&this.options.execute)this.execute(this.state);else for(var d=void 0;d=this._outgoingQueue.shift();)d[0].send(d[1]);if(this.children.forEach(function(e){u.state.children[e.id]=e}),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var h=k(this.eventListeners),p=h.next();!p.done;p=h.next()){var f=p.value;f(e.event)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}try{for(var v=k(this.listeners),m=v.next();!m.done;m=v.next()){var f=m.value;f(e,e.event)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(s=v.return)&&s.call(v)}finally{if(i)throw i.error}}try{for(var y=k(this.contextListeners),g=y.next();!g.done;g=y.next())(0,g.value)(this.state.context,this.state.history?this.state.history.context:void 0)}catch(e){o={error:e}}finally{try{g&&!g.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}if(this.state.done){var E=e.configuration.find(function(e){return"final"===e.type&&e.parent===u.machine}),T=E&&E.doneData?er(E.doneData,e.context,t):void 0;this._doneEvent=e0(this.id,T);try{for(var S=k(this.doneListeners),x=S.next();!x.done;x=S.next()){var f=x.value;f(this._doneEvent)}}catch(e){c={error:e}}finally{try{x&&!x.done&&(l=S.return)&&l.call(S)}finally{if(c)throw c.error}}this._stop(),this._stopChildren(),tp(this.sessionId)}},e.prototype.onTransition=function(e){return this.listeners.add(e),this.status===h.Running&&e(this.state,this.state.event),this},e.prototype.subscribe=function(e,t,r){var n=this,i=eg(e,t,r);this.listeners.add(i.next),this.status!==h.NotStarted&&i.next(this.state);var s=function(){n.doneListeners.delete(s),n.stopListeners.delete(s),i.complete()};return this.status===h.Stopped?i.complete():(this.onDone(s),this.onStop(s)),{unsubscribe:function(){n.listeners.delete(i.next),n.doneListeners.delete(s),n.stopListeners.delete(s)}}},e.prototype.onEvent=function(e){return this.eventListeners.add(e),this},e.prototype.onSend=function(e){return this.sendListeners.add(e),this},e.prototype.onChange=function(e){return this.contextListeners.add(e),this},e.prototype.onStop=function(e){return this.stopListeners.add(e),this},e.prototype.onDone=function(e){return this.status===h.Stopped&&this._doneEvent?e(this._doneEvent):this.doneListeners.add(e),this},e.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},e.prototype.start=function(e){var t,r,n=this;if(this.status===h.Running)return this;this.machine._init(),t=this.sessionId,r=this,td.set(t,r),this.initialized=!0,this.status=h.Running;var i=void 0===e?this.initialState:te(this,function(){return"object"==typeof e&&null!==e&&"value"in e&&"_event"in e?n.machine.resolveState(e):n.machine.resolveState(e6.from(e,n.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){n.update(i,eN)}),this},e.prototype._stopChildren=function(){this.children.forEach(function(e){ea(e.stop)&&e.stop()}),this.children.clear()},e.prototype._stop=function(){var e,t,r,n,i,s,o,a,c,l;try{for(var u=k(this.listeners),d=u.next();!d.done;d=u.next()){var p=d.value;this.listeners.delete(p)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}try{for(var f=k(this.stopListeners),v=f.next();!v.done;v=f.next()){var p=v.value;p(),this.stopListeners.delete(p)}}catch(e){r={error:e}}finally{try{v&&!v.done&&(n=f.return)&&n.call(f)}finally{if(r)throw r.error}}try{for(var m=k(this.contextListeners),y=m.next();!y.done;y=m.next()){var p=y.value;this.contextListeners.delete(p)}}catch(e){i={error:e}}finally{try{y&&!y.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}try{for(var g=k(this.doneListeners),E=g.next();!E.done;E=g.next()){var p=E.value;this.doneListeners.delete(p)}}catch(e){o={error:e}}finally{try{E&&!E.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}if(!this.initialized)return this;this.initialized=!1,this.status=h.Stopped,this._initialState=void 0;try{for(var T=k(Object.keys(this.delayedEventsMap)),S=T.next();!S.done;S=T.next()){var x=S.value;this.clock.clearTimeout(this.delayedEventsMap[x])}}catch(e){c={error:e}}finally{try{S&&!S.done&&(l=T.return)&&l.call(T)}finally{if(c)throw c.error}}this.scheduler.clear(),this.scheduler=new tu({deferEvents:this.options.deferEvents})},e.prototype.stop=function(){var e=this,t=this.scheduler;return this._stop(),t.schedule(function(){if(null==(t=e._state)||!t.done){var t,r=ef({type:"xstate.stop"}),n=te(e,function(){var t=ee(b([],x(e.state.configuration),!1).sort(function(e,t){return t.order-e.order}).map(function(t){return eP(t.onExit,e.machine.options.actions)})),n=x(e5(e.machine,e.state,e.state.context,r,[{type:"exit",actions:t}],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),i=n[0],s=n[1],o=new e6({value:e.state.value,context:s,_event:r,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:i.filter(function(e){return!eT(e)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return o.changed=!0,o});e.update(n,r),e._stopChildren(),tp(e.sessionId)}}),this},e.prototype.batch=function(e){var t=this;if(this.status===h.NotStarted&&this.options.deferEvents);else if(this.status!==h.Running)throw Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(e.length){var r=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var n,i,s=t.state,o=!1,a=[];try{for(var c=k(e),l=c.next();!l.done;l=c.next()){var u=l.value;!function(e){var n=ef(e);t.forward(n),s=te(t,function(){return t.machine.transition(s,n,void 0,r||void 0)}),a.push.apply(a,b([],x(t.machine.config.predictableActionArguments?s.actions:s.actions.map(function(e){var t,r;return t=s,r=e.exec,T(T({},e),{exec:void 0!==r?function(){return r(t.context,t.event,{action:e,state:t,_event:t._event})}:void 0})})),!1)),o=o||!!s.changed}(u)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}s.changed=o,s.actions=a,t.update(s,ef(e[e.length-1]))})}},e.prototype.sender=function(e){return this.send.bind(this,e)},e.prototype._nextState=function(e,t){var r=this;void 0===t&&(t=!!this.machine.config.predictableActionArguments&&this._exec);var n=ef(e);if(0===n.name.indexOf(j)&&!this.state.nextEvents.some(function(e){return 0===e.indexOf(j)}))throw n.data.data;return te(this,function(){return r.machine.transition(r.state,n,void 0,t||void 0)})},e.prototype.nextState=function(e){return this._nextState(e,!1)},e.prototype.forward=function(e){var t,r;try{for(var n=k(this.forwardTo),i=n.next();!i.done;i=n.next()){var s=i.value,o=this.children.get(s);if(!o)throw Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(s,"'."));o.send(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.defer=function(e){var t=this,r=this.clock.setTimeout(function(){"to"in e&&e.to?t.sendTo(e._event,e.to,!0):t.send(e._event)},e.delay);e.id&&(this.delayedEventsMap[e.id]=r)},e.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},e.prototype.exec=function(e,t,r){void 0===r&&(r=this.machine.options.actions),this._exec(e,t.context,t._event,r)},e.prototype.removeChild=function(e){var t;this.children.delete(e),this.forwardTo.delete(e),null==(t=this.state)||delete t.children[e]},e.prototype.stopChild=function(e){var t=this.children.get(e);t&&(this.removeChild(e),ea(t.stop)&&t.stop())},e.prototype.spawn=function(e,t,r){if(this.status!==h.Running)return tr(e,t);if(en(e))return this.spawnPromise(Promise.resolve(e),t);if(ea(e))return this.spawnCallback(e,t);if(function(e){try{return"function"==typeof e.send}catch(e){return!1}}(e)&&"id"in e)return this.spawnActor(e,t);if(function(e){try{return"subscribe"in e&&ea(e.subscribe)}catch(e){return!1}}(e))return this.spawnObservable(e,t);if(ed(e))return this.spawnMachine(e,T(T({},r),{id:t}));if(null!==e&&"object"==typeof e&&"transition"in e&&"function"==typeof e.transition)return this.spawnBehavior(e,t);throw Error('Unable to spawn entity "'.concat(t,'" of type "').concat(typeof e,'".'))},e.prototype.spawnMachine=function(t,r){var n=this;void 0===r&&(r={});var i=new e(t,T(T({},this.options),{parent:this,id:r.id||t.id})),s=T(T({},tv),r);return s.sync&&i.onTransition(function(e){n.send(V,{state:e,id:i.id})}),this.children.set(i.id,i),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(e){n.removeChild(i.id),n.send(ef(e,{origin:i.id}))}).start(),i},e.prototype.spawnBehavior=function(e,t){var r,n,i,s,o,a,c,l,u,d,h=(r={id:t,parent:this},n=e.initialState,i=new Set,s=[],o=!1,a=function(){if(!o){for(o=!0;s.length>0;){var t=s.shift();n=e.transition(n,t,d),i.forEach(function(e){return e.next(n)})}o=!1}},c={id:r.id,send:function(e){s.push(e),a()},getSnapshot:function(){return n},subscribe:function(e,t,r){var s=eg(e,t,r);return i.add(s),s.next(n),{unsubscribe:function(){i.delete(s)}}}},u=T(((l={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[eu]=function(){return this},l),c),d={parent:r.parent,self:u,id:r.id||"anonymous",observers:i},n=e.start?e.start(d):n,u);return this.children.set(t,h),h},e.prototype.spawnPromise=function(e,t){var r,n,i=this,s=!1;e.then(function(e){s||(n=e,i.removeChild(t),i.send(ef(e0(t,e),{origin:t})))},function(e){if(!s){i.removeChild(t);var r=e1(t,e);try{i.send(ef(r,{origin:t}))}catch(e){i.devTools&&i.devTools.send(r,i.state),i.machine.strict&&i.stop()}}});var o=((r={id:t,send:function(){},subscribe:function(t,r,n){var i=eg(t,r,n),s=!1;return e.then(function(e){s||(i.next(e),s||i.complete())},function(e){s||i.error(e)}),{unsubscribe:function(){return s=!0}}},stop:function(){s=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return n}})[eu]=function(){return this},r);return this.children.set(t,o),o},e.prototype.spawnCallback=function(e,t){var r,n,i,s=this,o=!1,a=new Set,c=new Set;try{i=e(function(e){n=e,c.forEach(function(t){return t(e)}),o||s.send(ef(e,{origin:t}))},function(e){a.add(e)})}catch(e){this.send(e1(t,e))}if(en(i))return this.spawnPromise(i,t);var l=((r={id:t,send:function(e){return a.forEach(function(t){return t(e)})},subscribe:function(e){var t=eg(e);return c.add(t.next),{unsubscribe:function(){c.delete(t.next)}}},stop:function(){o=!0,ea(i)&&i()},toJSON:function(){return{id:t}},getSnapshot:function(){return n}})[eu]=function(){return this},r);return this.children.set(t,l),l},e.prototype.spawnObservable=function(e,t){var r,n,i=this,s=e.subscribe(function(e){n=e,i.send(ef(e,{origin:t}))},function(e){i.removeChild(t),i.send(ef(e1(t,e),{origin:t}))},function(){i.removeChild(t),i.send(ef(e0(t),{origin:t}))}),o=((r={id:t,send:function(){},subscribe:function(t,r,n){return e.subscribe(t,r,n)},stop:function(){return s.unsubscribe()},getSnapshot:function(){return n},toJSON:function(){return{id:t}}})[eu]=function(){return this},r);return this.children.set(t,o),o},e.prototype.spawnActor=function(e,t){return this.children.set(t,e),e},e.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(t){var r=t(this.state.context,e);this.spawnEffect(e.id,r)}},e.prototype.spawnEffect=function(e,t){var r;this.children.set(e,((r={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}})[eu]=function(){return this},r))},e.prototype.attachDev=function(){var e=tf();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(T(T({name:this.id,autoPause:!0,stateSanitizer:function(e){return{value:e.value,context:e.context,actions:e.actions}}},t),{features:T({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}if(tf()){var r=function(){var e=tf();if(e&&"__xstate__"in e)return e.__xstate__}();r&&r.register(this)}}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[eu]=function(){return this},e.prototype.getSnapshot=function(){return this.status===h.NotStarted?this.initialState:this._state},e.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},e.interpret=ty,e}();function ty(e,t){return new tm(e,t)}function tg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var tE=function e(t,r){function n(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=tg({},r,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var o in i)i[o]&&(s+="; "+o,!0!==i[o]&&(s+="="+i[o].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+s}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var s=r[i].split("="),o=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(n[a]=t.read(o,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",tg({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,tg({},this.attributes,t))},withConverter:function(t){return e(tg({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),tT=e.i(77013);let tS="nhostRefreshToken",tk="nhostRefreshTokenId",tx="nhostRefreshTokenExpiresAt";class tb extends Error{constructor(e){super(e.message),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),e instanceof Error?(this.name=e.name,this.error={error:e.name,status:1,message:e.message}):(this.name=e.error,this.error=e)}}let tw={status:10,error:"invalid-email",message:"Email is incorrectly formatted"},tA={status:10,error:"invalid-mfa-type",message:"MFA type is invalid"},t_={status:10,error:"invalid-mfa-code",message:"MFA code is invalid"},tI={status:10,error:"invalid-password",message:"Password is incorrectly formatted"},tO={status:10,error:"invalid-phone-number",message:"Phone number is incorrectly formatted"},tN={status:10,error:"invalid-mfa-ticket",message:"MFA ticket is invalid"},tD={status:10,error:"no-mfa-ticket",message:"No MFA ticket has been provided"},tR={status:10,error:"no-refresh-token",message:"No refresh token has been provided"},tP={status:20,error:"refresher-already-running",message:"The token refresher is already running. You must wait until is has finished before submitting a new token."},tC={status:20,error:"already-signed-in",message:"User is already signed in"},tU={status:20,error:"unauthenticated-user",message:"User is not authenticated"},tL={status:20,error:"unverified-user",message:"Email needs verification"},tM={status:10,error:"invalid-refresh-token",message:"Invalid or expired refresh token"},tj={status:1,error:"invalid-sign-in-method",message:"Invalid sign-in method"},tF={user:null,mfa:null,accessToken:{value:null,expiresAt:null,expiresInSeconds:15},refreshTimer:{startedAt:null,attempts:0,lastAttempt:null},refreshToken:{value:null},importTokenAttempts:0,errors:{}};function tV(e){let t=new Uint8Array(e),r="";for(let e of t)r+=String.fromCharCode(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function tB(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,n=atob(t.padEnd(t.length+r,"=")),i=new ArrayBuffer(n.length),s=new Uint8Array(i);for(let e=0;e<n.length;e++)s[e]=n.charCodeAt(e);return i}function t$(){return(null==window?void 0:window.PublicKeyCredential)!==void 0&&"function"==typeof window.PublicKeyCredential}function tK(e){let{id:t}=e;return{...e,id:tB(t),transports:e.transports}}function tG(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}class tq extends Error{constructor({message:e,code:t,cause:r,name:n}){super(e,{cause:r}),this.name=null!=n?n:r.name,this.code=t}}let tH=new class{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}},tY=["cross-platform","platform"];function tz(e){if(e&&!(0>tY.indexOf(e)))return e}async function tJ(e){var t,r;let n,i,s,o,a;if(!t$())throw Error("WebAuthn is not supported in this browser");let c={publicKey:{...e,challenge:tB(e.challenge),user:{...e.user,id:(r=e.user.id,new TextEncoder().encode(r))},excludeCredentials:null==(t=e.excludeCredentials)?void 0:t.map(tK)}};c.signal=tH.createNewAbortSignal();try{n=await navigator.credentials.create(c)}catch(e){throw function({error:e,options:t}){var r,n;let{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new tq({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if((null==(r=i.authenticatorSelection)?void 0:r.requireResidentKey)===!0)return new tq({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if((null==(n=i.authenticatorSelection)?void 0:n.userVerification)==="required")return new tq({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if("InvalidStateError"===e.name)return new tq({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if("NotAllowedError"===e.name)return new tq({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("NotSupportedError"===e.name)return new tq(0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if("SecurityError"===e.name){let t=window.location.hostname;if(!tG(t))return new tq({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(i.rp.id!==t)return new tq({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new tq({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new tq({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return e}({error:e,options:c})}if(!n)throw Error("Registration was not completed");let{id:l,rawId:u,response:d,type:h}=n;if("function"==typeof d.getTransports&&(i=d.getTransports()),"function"==typeof d.getPublicKeyAlgorithm)try{s=d.getPublicKeyAlgorithm()}catch(e){tW("getPublicKeyAlgorithm()",e)}if("function"==typeof d.getPublicKey)try{let e=d.getPublicKey();null!==e&&(o=tV(e))}catch(e){tW("getPublicKey()",e)}if("function"==typeof d.getAuthenticatorData)try{a=tV(d.getAuthenticatorData())}catch(e){tW("getAuthenticatorData()",e)}return{id:l,rawId:tV(u),response:{attestationObject:tV(d.attestationObject),clientDataJSON:tV(d.clientDataJSON),transports:i,publicKeyAlgorithm:s,publicKey:o,authenticatorData:a},type:h,clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:tz(n.authenticatorAttachment)}}function tW(e,t){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${e}. You should report this error to them.
`,t)}async function tQ(e,t=!1){var r,n,i;let s,o,a;if(!t$())throw Error("WebAuthn is not supported in this browser");(null==(r=e.allowCredentials)?void 0:r.length)!==0&&(s=null==(n=e.allowCredentials)?void 0:n.map(tK));let c={...e,challenge:tB(e.challenge),allowCredentials:s},l={};if(t){let e;if(!await (void 0===(e=window.PublicKeyCredential).isConditionalMediationAvailable?new Promise(e=>e(!1)):e.isConditionalMediationAvailable()))throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');l.mediation="conditional",c.allowCredentials=[]}l.publicKey=c,l.signal=tH.createNewAbortSignal();try{o=await navigator.credentials.get(l)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new tq({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if("NotAllowedError"===e.name)return new tq({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("SecurityError"===e.name){let t=window.location.hostname;if(!tG(t))return new tq({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new tq({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new tq({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return e}({error:e,options:l})}if(!o)throw Error("Authentication was not completed");let{id:u,rawId:d,response:h,type:p}=o;return h.userHandle&&(i=h.userHandle,a=new TextDecoder("utf-8").decode(i)),{id:u,rawId:tV(d),response:{authenticatorData:tV(h.authenticatorData),clientDataJSON:tV(h.clientDataJSON),signature:tV(h.signature),userHandle:a},type:p,clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:tz(o.authenticatorAttachment)}}let tX="undefined"!=typeof window,tZ=new Map,t0=e=>{var t;return tX&&"undefined"!=typeof localStorage?localStorage.getItem(e):null!=(t=tZ.get(e))?t:null},t1=(e,t)=>{tX&&"undefined"!=typeof localStorage?t?localStorage.setItem(e,t):localStorage.removeItem(e):t?tZ.set(e,t):tZ.has(e)&&tZ.delete(e)},t2=e=>e&&e.accessToken.value&&e.accessToken.expiresAt&&e.user?{accessToken:e.accessToken.value,accessTokenExpiresIn:(e.accessToken.expiresAt.getTime()-Date.now())/1e3,refreshToken:e.refreshToken.value,user:e.user}:null,t3=({accessToken:e,refreshToken:t,isError:r,user:n,error:i})=>r?{session:null,error:i}:n&&e?{session:{accessToken:e,accessTokenExpiresIn:0,refreshToken:t,user:n},error:null}:{session:null,error:null},t4=()=>"undefined"!=typeof window&&void 0!==window.location,t8=globalThis.fetch;"string"!=typeof EdgeRuntime&&(t8=(0,tT.default)().fetch);let t9=async(e,t,{token:r,body:n,extraHeaders:i}={})=>{let s={"Content-Type":"application/json",Accept:"*/*"};r&&(s.Authorization=`Bearer ${r}`);let o={method:t,headers:{...s,...i}};n&&(o.body=JSON.stringify(n));try{let t=await t8(e,o);if(!t.ok){let e=await t.json();return Promise.reject({error:e})}try{return{data:await t.json(),error:null}}catch{return console.warn(`Unexpected response: can't parse the response of the server at ${e}`),{data:"OK",error:null}}}catch{return Promise.reject({error:{message:"Network Error",status:0,error:"network"}})}},t5=async(e,t,r,n)=>t9(e,"POST",{token:r,body:t,extraHeaders:n}),t6=(e,t)=>{let r=t&&Object.entries(t).map(([e,t])=>{let r=Array.isArray(t)?t.join(","):"object"==typeof t?JSON.stringify(t):t;return`${e}=${encodeURIComponent(r)}`}).join("&");return r?`${e}?${r}`:e},t7=(e,t)=>{if(!(null!=t&&t.redirectTo))return t;let{redirectTo:r,...n}=t;if(!e)return r.startsWith("/")?n:t;let i=new URL(e),s=Object.fromEntries(new URLSearchParams(i.search)),o=new URL(r.startsWith("/")?i.origin+r:r),a=Object.fromEntries(new URLSearchParams(o.search));r.startsWith("/")&&(a={...s,...a});let c=i.pathname;return o.pathname.length>1&&(c+=o.pathname.slice(1)),{...n,redirectTo:t6(o.origin+c,a)}};function re(e,t){var r;if(!t){if("undefined"==typeof window)return;t=(null==(r=window.location)?void 0:r.href)||""}let n=RegExp("[?&#]"+(e=e.replace(/[\[\]]/g,"\\$&"))+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function rt(e){var t;if("undefined"==typeof window)return;let r=null==window?void 0:window.location;if(r&&r){let n=new URLSearchParams(r.search),i=new URLSearchParams(null==(t=r.hash)?void 0:t.slice(1));n.delete(e),i.delete(e);let s=window.location.pathname;Array.from(n).length&&(s+=`?${n.toString()}`),Array.from(i).length&&(s+=`#${i.toString()}`),window.history.pushState({},"",s)}}let rr=e=>!!e&&"string"==typeof e&&!!String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),rn=e=>!!e&&"string"==typeof e&&e.length>=3,ri=e=>!!e&&"string"==typeof e,rs=({backendUrl:e,clientUrl:t,interpreter:r})=>ta({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:eW({error:e=>tw}),saveRequestError:eW({error:(e,{data:{error:t}})=>t}),reportError:eM(e=>({type:"ERROR",error:e.error})),reportSuccess:eM("SUCCESS")},guards:{invalidEmail:(e,{email:t})=>!rr(t)},services:{requestChange:async(n,{email:i,options:s})=>(await t5(`${e}/user/email/change`,{newEmail:i,options:t7(t,s)},null==r?void 0:r.getSnapshot().context.accessToken.value)).data}}),ro=({backendUrl:e,interpreter:t})=>ta({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:eW({error:e=>tI}),saveRequestError:eW({error:(e,{data:{error:t}})=>t}),reportError:eM(e=>({type:"ERROR",error:e.error})),reportSuccess:eM("SUCCESS")},guards:{invalidPassword:(e,{password:t})=>!rn(t)},services:{requestChange:(r,{password:n,ticket:i})=>t5(`${e}/user/password`,{newPassword:n,ticket:i},null==t?void 0:t.getSnapshot().context.accessToken.value)}}),ra=({backendUrl:e,clientUrl:t})=>ta({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:eW({error:e=>tw}),saveRequestError:eW({error:(e,{data:{error:t}})=>t}),reportError:eM(e=>({type:"ERROR",error:e.error})),reportSuccess:eM("SUCCESS")},guards:{invalidEmail:(e,{email:t})=>!rr(t)},services:{requestChange:(r,{email:n,options:i})=>t5(`${e}/user/password/reset`,{email:n,options:t7(t,i)})}}),rc=({backendUrl:e,clientUrl:t})=>ta({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"sendVerificationEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"request",id:"request",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:eW({error:e=>tw}),saveRequestError:eW({error:(e,{data:{error:t}})=>t}),reportError:eM(e=>({type:"ERROR",error:e.error})),reportSuccess:eM("SUCCESS")},guards:{invalidEmail:(e,{email:t})=>!rr(t)},services:{request:async(r,{email:n,options:i})=>(await t5(`${e}/user/email/send-verification-email`,{email:n,options:t7(t,i)})).data}});class rl{constructor({clientStorageType:e="web",autoSignIn:t=!0,autoRefreshToken:r=!0,start:n=!0,backendUrl:i,clientUrl:s,broadcastKey:o,devTools:a,...c}){var l;if(this._started=!1,this._subscriptionsQueue=new Set,this._subscriptions=new Set,this.backendUrl=i,this.clientUrl=s,this._machine=(({backendUrl:e,clientUrl:t,broadcastKey:r,clientStorageType:n="web",clientStorage:i,refreshIntervalTime:s,autoRefreshToken:o=!0,autoSignIn:a=!0})=>{let c=((e,t)=>{if("localStorage"===e||"web"===e)return t0;if("cookie"===e)return e=>{var t;return tX&&null!=(t=tE.get(e))?t:null};if(!t)throw Error(`clientStorageType is set to '${e}' but no clientStorage has been given`);if("react-native"===e)return e=>{var r;return null==(r=t.getItem)?void 0:r.call(t,e)};if("capacitor"===e)return e=>{var r;return null==(r=t.get)?void 0:r.call(t,{key:e})};if("expo-secure-storage"===e)return e=>{var r;return null==(r=t.getItemAsync)?void 0:r.call(t,e)};if("custom"===e){if(t.getItem&&t.removeItem)return t.getItem;if(t.getItemAsync)return t.getItemAsync;throw Error('clientStorageType is set to \'custom\' but clientStorage is missing either "getItem" and "removeItem" properties or "getItemAsync" property')}throw Error(`Unknown storage type: ${e}`)})(n,i),l=((e,t)=>{if("localStorage"===e||"web"===e)return t1;if("cookie"===e)return(e,t)=>{tX&&(t?tE.set(e,t,{expires:30,sameSite:"lax",httpOnly:!1}):tE.remove(e))};if(!t)throw Error(`clientStorageType is set to '${e}' but no clienStorage has been given`);if("react-native"===e)return(e,r)=>{var n,i;return r?null==(n=t.setItem)?void 0:n.call(t,e,r):null==(i=t.removeItem)?void 0:i.call(t,e)};if("capacitor"===e)return(e,r)=>{var n,i;return r?null==(n=t.set)?void 0:n.call(t,{key:e,value:r}):null==(i=t.remove)?void 0:i.call(t,{key:e})};if("expo-secure-storage"===e)return async(e,r)=>{var n,i;return r?null==(n=t.setItemAsync)?void 0:n.call(t,e,r):null==(i=t.deleteItemAsync)?void 0:i.call(t,e)};if("custom"===e){if(!t.removeItem)throw Error("clientStorageType is set to 'custom' but clientStorage is missing a removeItem property");if(t.setItem)return(e,r)=>{var n,i;return r?null==(n=t.setItem)?void 0:n.call(t,e,r):null==(i=t.removeItem)?void 0:i.call(t,e)};if(t.setItemAsync)return async(e,r)=>{var n,i;return r?null==(n=t.setItemAsync)?void 0:n.call(t,e,r):null==(i=t.removeItem)?void 0:i.call(t,e)};throw Error("clientStorageType is set to 'custom' but clientStorage is missing setItem or setItemAsync property")}throw Error(`Unknown storage type: ${e}`)})(n,i),u=async(t,r,n,i)=>(await t5(`${e}${t}`,r,n,i)).data,d=null;if("undefined"!=typeof window&&r)try{d=new BroadcastChannel(r)}catch{}return ta({schema:{context:{},events:{},services:{}},tsTypes:{},context:tF,predictableActionArguments:!0,id:"nhost",type:"parallel",states:{authentication:{initial:"starting",on:{SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","resetTimer","reportTokenChanged"],target:".signedIn"}]},states:{starting:{tags:["loading"],always:{cond:"isSignedIn",target:"signedIn"},invoke:{id:"importRefreshToken",src:"importRefreshToken",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"signedIn"},{target:"signedOut"}],onError:[{cond:"shouldRetryImportToken",actions:"incrementTokenImportAttempts",target:"retryTokenImport"},{actions:["saveAuthenticationError"],target:"signedOut"}]}},retryTokenImport:{tags:["loading"],after:{RETRY_IMPORT_TOKEN_DELAY:"starting"}},signedOut:{initial:"noErrors",entry:"reportSignedOut",states:{noErrors:{},success:{},needsSmsOtp:{},needsMfa:{},failed:{},signingOut:{entry:["clearContextExceptTokens"],exit:["destroyAccessToken","destroyRefreshToken","reportTokenChanged"],invoke:{src:"signout",id:"signingOut",onDone:{target:"success"},onError:{target:"failed",actions:["saveAuthenticationError"]}}}},on:{SIGNIN_PASSWORD:"authenticating.password",SIGNIN_ANONYMOUS:"authenticating.anonymous",SIGNIN_SECURITY_KEY_EMAIL:"authenticating.securityKeyEmail",SIGNIN_SECURITY_KEY:"authenticating.securityKey",SIGNIN_MFA_TOTP:"authenticating.mfa.totp",SIGNIN_PAT:"authenticating.pat",SIGNIN_ID_TOKEN:"authenticating.idToken"}},authenticating:{entry:"resetErrors",states:{password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:[{cond:"hasMfaTicket",actions:["saveMfaTicket"],target:"#nhost.authentication.signedOut.needsMfa"},{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"}],onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},pat:{invoke:{src:"signInPAT",id:"authenticateWithPAT",onDone:{actions:["savePATSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},idToken:{invoke:{src:"signInIdToken",id:"authenticateWithIdToken",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},mfa:{states:{totp:{invoke:{src:"signInMfaTotp",id:"signInMfaTotp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:["saveAuthenticationError"],target:"#nhost.authentication.signedOut.failed"}}}}},securityKeyEmail:{invoke:{src:"signInSecurityKeyEmail",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},securityKey:{invoke:{src:"signInSecurityKey",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}}}},signedIn:{type:"parallel",entry:["reportSignedIn","cleanUrl","broadcastToken","resetErrors"],on:{SIGNOUT:"signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"isRefreshTokenPAT",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{1e3:{internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","resetTimer","reportTokenChanged","broadcastToken"],target:"pending"},onError:[{cond:"isUnauthorizedError",target:"#nhost.authentication.signedOut"},{actions:"saveRefreshAttempt",target:"pending"}]}}}}}}}}}},token:{initial:"idle",states:{idle:{on:{TRY_TOKEN:"running"},initial:"noErrors",states:{noErrors:{},error:{}}},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","reportTokenChanged","broadcastToken"],target:["#nhost.authentication.signedIn","idle.noErrors"]},onError:[{cond:"isSignedIn",target:"idle.error"},{actions:"saveAuthenticationError",target:["#nhost.authentication.signedOut.failed","idle.error"]}]}}}},registration:{initial:"incomplete",on:{SIGNED_IN:[{cond:"isAnonymous",target:".incomplete"},".complete"]},states:{incomplete:{on:{SIGNUP_EMAIL_PASSWORD:"emailPassword",SIGNUP_SECURITY_KEY:"securityKey",PASSWORDLESS_EMAIL:"passwordlessEmail",PASSWORDLESS_SMS:"passwordlessSms",PASSWORDLESS_SMS_OTP:"passwordlessSmsOtp",SIGNIN_EMAIL_OTP:"signInEmailOTP",VERIFY_EMAIL_OTP:"verifyEmailOTP"},initial:"noErrors",states:{noErrors:{},needsEmailVerification:{},needsOtp:{},failed:{}}},emailPassword:{entry:["resetErrors"],invoke:{src:"signUpEmailPassword",id:"signUpEmailPassword",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},securityKey:{entry:["resetErrors"],invoke:{src:"signUpSecurityKey",id:"signUpSecurityKey",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},passwordlessEmail:{entry:["resetErrors"],invoke:{src:"passwordlessEmail",id:"passwordlessEmail",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSms:{entry:["resetErrors"],invoke:{src:"passwordlessSms",id:"passwordlessSms",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSmsOtp:{entry:["resetErrors"],invoke:{src:"passwordlessSmsOtp",id:"passwordlessSmsOtp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},signInEmailOTP:{entry:["resetErrors"],invoke:{src:"signInEmailOTP",id:"signInEmailOTP",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},verifyEmailOTP:{entry:["resetErrors"],invoke:{src:"verifyEmailOTP",id:"verifyEmailOTP",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},complete:{on:{SIGNED_OUT:"incomplete"}}}}}},{actions:{reportSignedIn:eM("SIGNED_IN"),reportSignedOut:eM("SIGNED_OUT"),reportTokenChanged:eM("TOKEN_CHANGED"),incrementTokenImportAttempts:eW({importTokenAttempts:({importTokenAttempts:e})=>e+1}),clearContext:eW(()=>(l(tx,null),l(tS,null),l(tk,null),{...tF})),clearContextExceptTokens:eW(({accessToken:e,refreshToken:t})=>({...tF,accessToken:e,refreshToken:t})),saveSession:eW({user:(e,{data:t})=>{var r;return(null==(r=null==t?void 0:t.session)?void 0:r.user)||null},accessToken:(e,{data:t})=>{if(t.session){let{accessTokenExpiresIn:e,accessToken:r}=t.session,n=new Date(Date.now()+1e3*e);return l(tx,n.toISOString()),{value:r,expiresAt:n,expiresInSeconds:e}}return l(tx,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(e,{data:t})=>{var r,n;let i=(null==(r=t.session)?void 0:r.refreshToken)||null,s=(null==(n=t.session)?void 0:n.refreshTokenId)||null;return i&&l(tS,i),s&&l(tk,s),{value:i}}}),savePATSession:eW({user:(e,{data:t})=>{var r;return(null==(r=null==t?void 0:t.session)?void 0:r.user)||null},accessToken:(e,{data:t})=>{if(t.session){let{accessTokenExpiresIn:e,accessToken:r}=t.session,n=new Date(Date.now()+1e3*e);return l(tx,n.toISOString()),{value:r,expiresAt:n,expiresInSeconds:e}}return l(tx,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(e,{data:t})=>{var r,n;let i=(null==(r=t.session)?void 0:r.refreshToken)||null,s=(null==(n=t.session)?void 0:n.refreshTokenId)||null;return i&&l(tS,i),s&&l(tk,s),{value:i,isPAT:!0}}}),saveMfaTicket:eW({mfa:(e,t)=>{var r;return null==(r=t.data)?void 0:r.mfa}}),resetTimer:eW({refreshTimer:e=>({startedAt:new Date,attempts:0,lastAttempt:null})}),saveRefreshAttempt:eW({refreshTimer:(e,t)=>({startedAt:e.refreshTimer.startedAt,attempts:e.refreshTimer.attempts+1,lastAttempt:new Date})}),saveAuthenticationError:eW({errors:({errors:e},{data:{error:t}})=>({...e,authentication:t})}),resetErrors:eW({errors:e=>({}),importTokenAttempts:e=>0}),saveRegistrationError:eW({errors:({errors:e},{data:{error:t}})=>({...e,registration:t})}),destroyRefreshToken:eW({refreshToken:e=>(l(tS,null),l(tk,null),{value:null})}),destroyAccessToken:eW({accessToken:e=>(l(tx,null),{value:null,expiresAt:null,expiresInSeconds:null})}),cleanUrl:()=>{a&&re("refreshToken")&&(rt("refreshToken"),rt("type"))},broadcastToken:e=>{if(a&&r&&d)try{d.postMessage({type:"broadcast_session",payload:{token:e.refreshToken.value,accessToken:e.accessToken.value,user:e.user,expiresAt:e.accessToken.expiresAt?e.accessToken.expiresAt.toISOString():null,expiresInSeconds:e.accessToken.expiresInSeconds}})}catch{}}},guards:{isAnonymous:(e,t)=>{var r;return!!(null!=(r=e.user)&&r.isAnonymous)},isSignedIn:e=>!!e.user&&!!e.accessToken.value,noToken:e=>!e.refreshToken.value,isRefreshTokenPAT:e=>{var t;return!!(null!=(t=e.refreshToken)&&t.isPAT)},hasRefreshToken:e=>!!e.refreshToken.value,isAutoRefreshDisabled:()=>!o,refreshTimerShouldRefresh:e=>{let{expiresAt:t}=e.accessToken;if(!t)return!1;if(e.refreshTimer.lastAttempt)return!(e.refreshTimer.attempts>5)&&Date.now()-e.refreshTimer.lastAttempt.getTime()>5e3*Math.pow(2,e.refreshTimer.attempts-1);if(t.getTime()<Date.now()||s&&Date.now()-e.refreshTimer.startedAt.getTime()>1e3*s)return!0;if(!e.accessToken.expiresInSeconds)return!1;let r=t.getTime()-Date.now();return r<=3e4||r<=6e4&&.1>Math.random()},shouldRetryImportToken:(e,t)=>e.importTokenAttempts<5&&(0===t.data.error.status||t.data.error.status>=500),unverified:(e,{data:{error:t}})=>401===t.status&&("Email is not verified"===t.message||"unverified-user"===t.error),hasSession:(e,t)=>{var r;return!!(null!=(r=t.data)&&r.session)},hasMfaTicket:(e,t)=>{var r;return!!(null!=(r=t.data)&&r.mfa)},isUnauthorizedError:(e,{data:{error:t}})=>401===t.status},services:{signInPassword:(e,{email:t,password:r})=>rr(t)?rn(r)?u("/signin/email-password",{email:t,password:r}):Promise.reject({error:tI}):Promise.reject({error:tw}),signInPAT:(e,{pat:t})=>u("/signin/pat",{personalAccessToken:t}),signInIdToken:(e,{provider:t,idToken:r,nonce:n})=>u("/signin/idtoken",{provider:t,idToken:r,...n&&{nonce:n}}),passwordlessSms:(e,{phoneNumber:r,options:n})=>{var i;return ri(r)?null!=(i=e.user)&&i.isAnonymous?(console.warn("Deanonymisation from a phone number is not yet implemented in hasura-auth"),u("/user/deanonymize",{signInMethod:"passwordless",connection:"sms",phoneNumber:r,options:t7(t,n)},e.accessToken.value)):u("/signin/passwordless/sms",{phoneNumber:r,options:t7(t,n)}):Promise.reject({error:tO})},passwordlessSmsOtp:(e,{phoneNumber:t,otp:r})=>ri(t)?u("/signin/passwordless/sms/otp",{phoneNumber:t,otp:r}):Promise.reject({error:tO}),signInEmailOTP:(e,{email:r,options:n})=>rr(r)?u("/signin/otp/email",{email:r,options:t7(t,n)}):Promise.reject({error:tw}),verifyEmailOTP:(e,{email:t,otp:r})=>rr(t)?u("/signin/otp/email/verify",{email:t,otp:r}):Promise.reject({error:tw}),passwordlessEmail:(e,{email:r,options:n})=>{var i;return rr(r)?null!=(i=e.user)&&i.isAnonymous?u("/user/deanonymize",{signInMethod:"passwordless",connection:"email",email:r,options:t7(t,n)},e.accessToken.value):u("/signin/passwordless/email",{email:r,options:t7(t,n)}):Promise.reject({error:tw})},signInAnonymous:e=>u("/signin/anonymous"),signInMfaTotp:(e,t)=>{var r;let n=t.ticket||(null==(r=e.mfa)?void 0:r.ticket);return n?n&&"string"==typeof n&&n.match(/^mfaTotp:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)?u("/signin/mfa/totp",{ticket:n,otp:t.otp}):Promise.reject({error:tN}):Promise.reject({error:tD})},signInSecurityKeyEmail:async(e,{email:t})=>{let r;if(!rr(t))throw new tb(tw);let n=await u("/signin/webauthn",{email:t});try{r=await tQ(n)}catch(e){throw new tb(e)}return u("/signin/webauthn/verify",{email:t,credential:r})},refreshToken:async(e,t)=>{let r="TRY_TOKEN"===t.type?t.token:e.refreshToken.value;return{session:await u("/token",{refreshToken:r}),error:null}},signInSecurityKey:async()=>{try{let e,t=await u("/signin/webauthn",{});try{e=await tQ(t)}catch(e){throw new tb(e)}return u("/signin/webauthn/verify",{credential:e})}catch(e){throw new tb(e)}},signout:async(e,t)=>{let n=await u("/signout",{refreshToken:e.refreshToken.value,all:!!t.all},t.all?e.accessToken.value:void 0);if(r&&d)try{d.postMessage({type:"signout"})}catch{}return n},signUpEmailPassword:async(e,{email:r,password:n,options:i,requestOptions:s})=>{var o;return rr(r)?rn(n)?null!=(o=e.user)&&o.isAnonymous?u("/user/deanonymize",{signInMethod:"email-password",email:r,password:n,options:t7(t,i)},e.accessToken.value,null==s?void 0:s.headers):u("/signup/email-password",{email:r,password:n,options:t7(t,i)},null,null==s?void 0:s.headers):Promise.reject({error:tI}):Promise.reject({error:tw})},signUpSecurityKey:async(e,{email:t,options:r,requestOptions:n})=>{let i;if(!rr(t))return Promise.reject({error:tw});let s=null==r?void 0:r.nickname;s&&delete r.nickname;let o=await u("/signup/webauthn",{email:t,options:r},null,null==n?void 0:n.headers);try{i=await tJ(o)}catch(e){throw new tb(e)}return u("/signup/webauthn/verify",{credential:i,options:{redirectTo:null==r?void 0:r.redirectTo,nickname:s,displayName:null==r?void 0:r.displayName,...(null==r?void 0:r.metadata)&&{metadata:null==r?void 0:r.metadata}}})},importRefreshToken:async e=>{if(e.user&&e.refreshToken.value&&e.accessToken.value&&e.accessToken.expiresAt)return{session:{accessToken:e.accessToken.value,accessTokenExpiresIn:e.accessToken.expiresAt.getTime()-Date.now(),refreshToken:e.refreshToken.value,user:e.user},error:null};let t=null;if(a){let e=re("refreshToken")||null;if(e)try{return{session:await u("/token",{refreshToken:e}),error:null}}catch(e){t=e.error}else{let e=re("error"),t=re("errorDescription");if(e&&"social user already exists"!==t)return Promise.reject({session:null,error:{status:10,error:e,message:t||e}})}}let r=await c(tS);if(r)try{return{session:await u("/token",{refreshToken:r}),error:null}}catch(e){t=e.error}return t?Promise.reject({error:t,session:null}):{error:null,session:null}}},delays:{RETRY_IMPORT_TOKEN_DELAY:({importTokenAttempts:e})=>5e3*Math.pow(2,e-1)}})})({...c,backendUrl:i,clientUrl:s,broadcastKey:o,clientStorageType:e,autoSignIn:t,autoRefreshToken:r}),n&&this.start({devTools:a}),"undefined"!=typeof window&&o)try{this._channel=new BroadcastChannel(o),t&&(null==(l=this._channel)||l.addEventListener("message",e=>{var t;let{type:r,payload:n}=e.data;if("broadcast_session"===r){let e=null==(t=this.interpreter)?void 0:t.getSnapshot().context,r=null==e?void 0:e.refreshToken.value;this.interpreter&&n.token&&n.token!==r&&this.interpreter.send("SESSION_UPDATE",{data:{session:{user:n.user,accessToken:n.accessToken,refreshToken:n.token,accessTokenExpiresIn:n.expiresInSeconds}}})}})),this._channel.addEventListener("message",e=>{let{type:t}=e.data;"signout"===t&&this.interpreter&&this.interpreter.send("SIGNOUT")})}catch{}}start({devTools:e=!1,initialSession:t,interpreter:r}={}){var n,i;let s={...this.machine.context,accessToken:{...this.machine.context.accessToken},refreshToken:{...this.machine.context.refreshToken}};t&&(s.user=t.user,s.refreshToken.value=null!=(n=t.refreshToken)?n:null,s.accessToken.value=null!=(i=t.accessToken)?i:null,s.accessToken.expiresAt=new Date(Date.now()+1e3*t.accessTokenExpiresIn));let o=this.machine.withContext(s);this._interpreter||(this._interpreter=r||ty(o,{devTools:e})),this._started&&"undefined"!=typeof window||(this._interpreter.initialized&&(this._interpreter.stop(),this._subscriptions.forEach(e=>e())),this._interpreter.start(o.initialState),this._subscriptionsQueue.forEach(e=>e(this))),this._started=!0}get machine(){return this._machine}get interpreter(){return this._interpreter}get started(){return this._started}subscribe(e){if(!this.started)return this._subscriptionsQueue.add(e),()=>{console.log("onTokenChanged was added before the interpreter started. Cannot unsubscribe listener.")};{let t=e(this);return this._subscriptions.add(t),t}}}let ru=async({backendUrl:e,interpreter:t},r)=>{try{let n,{data:i}=await t5(`${e}/user/webauthn/add`,{},null==t?void 0:t.getSnapshot().context.accessToken.value);try{n=await tJ(i)}catch(e){throw new tb(e)}let{data:s}=await t5(`${e}/user/webauthn/verify`,{credential:n,nickname:r},null==t?void 0:t.getSnapshot().context.accessToken.value);return{key:s,isError:!1,error:null,isSuccess:!0}}catch(t){let{error:e}=t;return{isError:!0,error:e,isSuccess:!1}}},rd=async(e,t,r)=>new Promise(n=>{e.send("REQUEST",{email:t,options:r}),e.onTransition(e=>{e.matches({idle:"error"})?n({error:e.context.error,isError:!0,needsEmailVerification:!1}):e.matches({idle:"success"})&&n({error:null,isError:!1,needsEmailVerification:!0})})}),rh=async(e,t,r)=>new Promise(n=>{e.send("REQUEST",{password:t,ticket:r}),e.onTransition(e=>{e.matches({idle:"error"})?n({error:e.context.error,isError:!0,isSuccess:!1}):e.matches({idle:"success"})&&n({error:null,isError:!1,isSuccess:!0})})}),rp=async(e,t,r)=>new Promise(n=>{e.send("REQUEST",{email:t,options:r}),e.onTransition(e=>{e.matches({idle:"error"})?n({error:e.context.error,isError:!0,isSent:!1}):e.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),rf=(e,t,r)=>new Promise(n=>{e.send("REQUEST",{email:t,options:r}),e.onTransition(e=>{e.matches({idle:"error"})?n({error:e.context.error,isError:!0,isSent:!1}):e.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),rv=e=>new Promise(t=>{let{changed:r}=e.send("SIGNIN_ANONYMOUS");r||t({isSuccess:!1,isError:!0,error:tC,user:null,accessToken:null,refreshToken:null}),e.onTransition(e=>{e.matches({authentication:"signedIn"})&&t({isSuccess:!0,isError:!1,error:null,user:e.context.user,accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value}),e.matches({authentication:{signedOut:"failed"}})&&t({isSuccess:!1,isError:!0,error:e.context.errors.authentication||null,user:null,accessToken:null,refreshToken:null})})}),rm=(e,t,r)=>new Promise(n=>{let{changed:i,context:s}=e.send("SIGNIN_PASSWORD",{email:t,password:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:tC,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:s.user});e.onTransition(e=>{e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,needsMfaOtp:!1,mfa:null,user:null}):e.matches({authentication:{signedOut:"needsMfa"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!0,mfa:e.context.mfa,user:null}):e.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:null}):e.matches({authentication:"signedIn"})&&n({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:e.context.user})})}),ry=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send("PASSWORDLESS_EMAIL",{email:t,options:r});if(!i)return n({error:tC,isError:!0,isSuccess:!1});e.onTransition(e=>{e.matches("registration.incomplete.failed")?n({error:e.context.errors.registration||null,isError:!0,isSuccess:!1}):e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})&&n({error:null,isError:!1,isSuccess:!0})})}),rg=(e,t)=>new Promise(r=>{let{changed:n,context:i}=e.send({type:"SIGNIN_SECURITY_KEY_EMAIL",email:t});if(!n)return r({accessToken:i.accessToken.value,refreshToken:i.refreshToken.value,error:tC,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:i.user});e.onTransition(e=>{e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?r({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):e.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,refreshToken:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):e.matches({authentication:"signedIn"})&&r({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:e.context.user})})});function rE(e){return{error:e.message||"Something went wrong!",status:e.status||1,message:e.message||"Something went wrong!"}}let rT=async(e,t)=>{var r,n;let i,s,o=null==(r=e.interpreter)?void 0:r.getSnapshot(),a=null==o?void 0:o.context.accessToken.value;try{i=(await t5(`${e.backendUrl}/elevate/webauthn`,{email:t},a)).data}catch(e){return{error:rE(e),isError:!0,isSuccess:!1,elevated:!1}}try{s=await tQ(i)}catch(e){return{error:rE(e),isError:!0,isSuccess:!1,elevated:!1}}try{let{data:{session:r},error:i}=await t5(`${e.backendUrl}/elevate/webauthn/verify`,{email:t,credential:s},a);return r&&!i?(null==(n=e.interpreter)||n.send({type:"SESSION_UPDATE",data:{session:r}}),{error:null,isError:!1,isSuccess:!0,elevated:!0}):{error:i,isError:!0,isSuccess:!1,elevated:!1}}catch(t){let{error:e}=t;return{error:e,isError:!0,isSuccess:!1,elevated:!1}}},rS=(e,t,r)=>new Promise(n=>{let{changed:i,context:s}=e.send("SIGNIN_MFA_TOTP",{otp:t,ticket:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:tC,isError:!0,isSuccess:!1,user:s.user});e.onTransition(e=>{e.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null}):e.matches({authentication:"signedIn"})&&n({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,user:e.context.user})})}),rk=(e,t)=>new Promise(r=>{let{changed:n}=e.send("SIGNIN_PAT",{pat:t});n||r({isSuccess:!1,isError:!0,error:tC,user:null,accessToken:null,refreshToken:null}),e.onTransition(e=>e.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,refreshToken:null,user:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1}):e.matches({authentication:"signedIn"})?r({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,user:e.context.user,error:null,isError:!1,isSuccess:!0}):void 0)}),rx=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send("PASSWORDLESS_SMS",{phoneNumber:t,options:r});if(!i)return n({error:tC,isError:!0,isSuccess:!1,needsOtp:!1});e.onTransition(e=>{e.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!1,needsOtp:!0}):e.matches("registration.incomplete.failed")&&n({error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),rb=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send({type:"PASSWORDLESS_SMS_OTP",phoneNumber:t,otp:r});if(!i)return n({error:tC,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});e.onTransition(e=>{e.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:e.context.user,accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value}):e.matches({registration:{incomplete:"failed"}})&&n({error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),rw=async(e,t)=>new Promise(r=>{let{event:n}=e.send("SIGNOUT",{all:t});if("SIGNED_OUT"!==n.type)return r({isSuccess:!1,isError:!0,error:tU});e.onTransition(e=>{e.matches({authentication:{signedOut:"success"}})?r({isSuccess:!0,isError:!1,error:null}):e.matches("authentication.signedOut.failed")&&r({isSuccess:!1,isError:!0,error:e.context.errors.signout||null})})}),rA=(e,t,r,n,i)=>new Promise(s=>{let{changed:o,context:a}=e.send("SIGNUP_EMAIL_PASSWORD",{email:t,password:r,options:n,requestOptions:i});if(!o)return s({error:tC,accessToken:a.accessToken.value,refreshToken:a.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:a.user});e.onTransition(e=>{e.matches("registration.incomplete.failed")?s({accessToken:null,refreshToken:null,error:e.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?s({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):e.matches({authentication:"signedIn",registration:"complete"})&&s({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:e.context.user})})}),r_=(e,t,r,n)=>new Promise(i=>{let{changed:s,context:o}=e.send("SIGNUP_SECURITY_KEY",{email:t,options:r,requestOptions:n});if(!s)return i({error:tC,accessToken:o.accessToken.value,refreshToken:o.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:o.user});e.onTransition(e=>{e.matches("registration.incomplete.failed")?i({accessToken:null,refreshToken:null,error:e.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?i({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):e.matches({authentication:"signedIn",registration:"complete"})&&i({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:e.context.user})})}),rI=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send("SIGNIN_EMAIL_OTP",{email:t,options:r});if(!i)return n({error:tC,isError:!0,isSuccess:!1,needsOtp:!1});e.onTransition(e=>{e.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!0,needsOtp:!0}):e.matches("registration.incomplete.failed")&&n({error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),rO=(e,t,r)=>new Promise(n=>{let{changed:i}=e.send({type:"VERIFY_EMAIL_OTP",email:t,otp:r});if(!i)return n({error:tC,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});e.onTransition(e=>{e.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:e.context.user,accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value}):e.matches({registration:{incomplete:"failed"}})&&n({error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),rN=(e,{provider:t,idToken:r,nonce:n})=>new Promise(i=>{let{changed:s}=e.send("SIGNIN_ID_TOKEN",{provider:t,idToken:r,...n&&{nonce:n}});s||i({isSuccess:!1,isError:!0,error:tC,user:null,accessToken:null,refreshToken:null}),e.onTransition(e=>e.matches({authentication:{signedOut:"failed"}})?i({accessToken:null,refreshToken:null,user:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1}):e.matches({authentication:"signedIn"})?i({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,user:e.context.user,error:null,isError:!1,isSuccess:!0}):void 0)}),rD=async({backendUrl:e,interpreter:t},{provider:r,idToken:n,nonce:i})=>{try{return await t5(`${e}/link/idtoken`,{provider:r,idToken:n,...i&&{nonce:i}},null==t?void 0:t.getSnapshot().context.accessToken.value),{isError:!1,error:null,isSuccess:!0}}catch(t){let{error:e}=t;return{isError:!0,error:e,isSuccess:!1}}},rR=e=>new Promise(t=>{let{changed:r,context:n}=e.send({type:"SIGNIN_SECURITY_KEY"});if(!r)return t({accessToken:n.accessToken.value,refreshToken:n.refreshToken.value,error:tC,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:n.user});e.onTransition(e=>{e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?t({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):e.matches({authentication:{signedOut:"failed"}})?t({accessToken:null,refreshToken:null,error:e.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):e.matches({authentication:"signedIn"})&&t({accessToken:e.context.accessToken.value,refreshToken:e.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:e.context.user})})}),rP=async({backendUrl:e,interpreter:t},{expiresAt:r,metadata:n})=>{try{let{data:i}=await t5(`${e}/pat`,{expiresAt:r.toISOString(),metadata:n},null==t?void 0:t.getSnapshot().context.accessToken.value);return{data:i?{id:i.id||null,personalAccessToken:i.personalAccessToken||null}:null,isError:!1,error:null,isSuccess:!0}}catch(t){let{error:e}=t;return{isError:!0,error:e,isSuccess:!1,data:null}}};class rC{constructor({url:e,broadcastKey:t,autoRefreshToken:r=!0,autoSignIn:n=!0,clientStorage:i,clientStorageType:s,refreshIntervalTime:o,start:a=!0}){var c;this.url=e,this._client=new rl({backendUrl:e,clientUrl:"undefined"!=typeof window&&(null==(c=window.location)?void 0:c.origin)||"",broadcastKey:t,autoRefreshToken:r,autoSignIn:n,start:a,clientStorage:i,clientStorageType:s,refreshIntervalTime:o})}async signUp(e,t){let r=await this.waitUntilReady();if("securityKey"in e){let{email:n,options:i}=e;return t3(await r_(r,n,i,t))}let{email:n,password:i,options:s}=e;return t3(await rA(r,n,i,s,t))}async connectProvider(e){let t=(await this.waitUntilReady()).getSnapshot().context.accessToken.value,{provider:r,options:n}=e,i=t6(`${this._client.backendUrl}/signin/provider/${r}`,t7(this._client.clientUrl,{...n,connect:t}));return t4()&&(window.location.href=i),{providerUrl:i}}async signInIdToken(e){let t=await this.waitUntilReady();return{...t3(await rN(t,e)),mfa:null}}async linkIdToken(e){return rD(this._client,e)}async signIn(e){let t=await this.waitUntilReady();if(!e)return{...t3(await rv(t)),mfa:null};if("provider"in e){let{provider:t,options:r}=e,n=t6(`${this._client.backendUrl}/signin/provider/${t}`,t7(this._client.clientUrl,r));return t4()&&(window.location.href=n),{providerUrl:n,provider:t,session:null,mfa:null,error:null}}if("email"in e&&"password"in e){let r=await rm(t,e.email,e.password);return r.needsEmailVerification?{session:null,mfa:null,error:tL}:r.needsMfaOtp?{session:null,mfa:r.mfa,error:null}:{...t3(r),mfa:null}}if("email"in e&&"securityKey"in e){if(!0!==e.securityKey)throw Error("securityKey must be true");return{...t3(await rg(t,e.email)),mfa:null}}if("email"in e){let{email:r,options:n}=e,{error:i}=await ry(t,r,n);return{session:null,mfa:null,error:i}}if("phoneNumber"in e&&"otp"in e)return{...t3(await rb(t,e.phoneNumber,e.otp)),mfa:null};if("phoneNumber"in e){let{error:r}=await rx(t,e.phoneNumber,e.options);return{error:r,mfa:null,session:null}}return"otp"in e?{...t3(await rS(t,e.otp,e.ticket)),mfa:null}:{error:tj,mfa:null,session:null}}async signInPAT(e){let t=await this.waitUntilReady();return t3(await rk(t,e))}async signInEmailOTP(e,t){let r=await this.waitUntilReady(),{error:n}=await rI(r,e,t);return{error:n,session:null,mfa:null}}async verifyEmailOTP(e,t){let r=await this.waitUntilReady();return{...t3(await rO(r,e,t)),mfa:null}}async signInSecurityKey(){let e=await this.waitUntilReady();return{...t3(await rR(e)),mfa:null}}async signOut(e){let t=await this.waitUntilReady(),{error:r}=await rw(t,null==e?void 0:e.all);return{error:r}}async resetPassword({email:e,options:t}){let r=ty(ra(this._client)).start(),{error:n}=await rp(r,e,t);return{error:n}}async changePassword({newPassword:e,ticket:t}){let r=ty(ro(this._client)).start(),{error:n}=await rh(r,e,t);return{error:n}}async sendVerificationEmail({email:e,options:t}){let r=ty(rc(this._client)).start(),{error:n}=await rf(r,e,t);return{error:n}}async changeEmail({newEmail:e,options:t}){let r=ty(rs(this._client)).start(),{error:n}=await rd(r,e,t);return{error:n}}async deanonymize(e){let t=await this.waitUntilReady();if("passwordless"===e.signInMethod){if("email"===e.connection){let{error:r}=await ry(t,e.email,e.options);return{error:r}}if("sms"===e.connection){let{error:r}=await rx(t,e.phoneNumber,e.options);return{error:r}}}if("email-password"===e.signInMethod){let{error:r}=await rA(t,e.email,e.password,e.options);return{error:r}}throw Error("Unknown deanonymization method")}async addSecurityKey(e){let{error:t,key:r}=await ru(this._client,e);return{error:t,key:r}}async elevateEmailSecurityKey(e){if(!e)throw Error("A user email is required");return{...await rT(this._client,e),mfa:null}}async createPAT(e,t){return rP(this._client,{expiresAt:e,metadata:t})}onTokenChanged(e){return this._client.subscribe(()=>{var t;let r=null==(t=this._client.interpreter)?void 0:t.onTransition(({event:t,context:r})=>{"TOKEN_CHANGED"===t.type&&e(t2(r))});return()=>null==r?void 0:r.stop()})}onAuthStateChanged(e){return this._client.subscribe(()=>{var t;let r=null==(t=this._client.interpreter)?void 0:t.onTransition(({event:t,context:r})=>{("SIGNED_IN"===t.type||"SIGNED_OUT"===t.type)&&e(t.type,t2(r))});return()=>null==r?void 0:r.stop()})}isAuthenticated(){var e;return!!(null!=(e=this._client.interpreter)&&e.getSnapshot().matches({authentication:"signedIn"}))}async isAuthenticatedAsync(){return(await this.waitUntilReady()).getSnapshot().matches({authentication:"signedIn"})}getAuthenticationStatus(){var e;let t=(null==(e=this.client.interpreter)?void 0:e.getSnapshot().context.importTokenAttempts)||0;return this.isReady()?{isAuthenticated:this.isAuthenticated(),isLoading:!1,connectionAttempts:t}:{isAuthenticated:!1,isLoading:!0,connectionAttempts:t}}getAccessToken(){var e,t;return null!=(t=null==(e=this._client.interpreter)?void 0:e.getSnapshot().context.accessToken.value)?t:void 0}getDecodedAccessToken(){let e=this.getAccessToken();return e?E(e):null}getHasuraClaims(){var e;return(null==(e=this.getDecodedAccessToken())?void 0:e["https://hasura.io/jwt/claims"])||null}getHasuraClaim(e){var t;return(null==(t=this.getHasuraClaims())?void 0:t[e.startsWith("x-hasura-")?e:`x-hasura-${e}`])||null}async refreshSession(e){try{let t=await this.waitUntilReady();return new Promise(r=>{let n=e||t.getSnapshot().context.refreshToken.value;if(!n)return r({session:null,error:tR});let{changed:i}=t.send("TRY_TOKEN",{token:n});if(!i)return r({session:null,error:tP});t.onTransition(e=>{e.matches({token:{idle:"error"}})?r({session:null,error:tM}):"TOKEN_CHANGED"===e.event.type&&r({session:t2(e.context),error:null})})})}catch(e){return{session:null,error:e.message}}}getSession(){var e,t;return t2(null==(t=null==(e=this._client.interpreter)?void 0:e.getSnapshot())?void 0:t.context)}async initWithSession({session:e}){this.client.start({initialSession:e}),await this.waitUntilReady()}getUser(){var e,t,r;return(null==(r=null==(t=null==(e=this._client.interpreter)?void 0:e.getSnapshot())?void 0:t.context)?void 0:r.user)||null}waitUntilReady(){let e=this._client.interpreter;if(!e)throw Error("Auth interpreter not set");return e.getSnapshot().hasTag("loading")?new Promise((t,r)=>{let n=setTimeout(()=>r("The state machine is not yet ready after 15 seconds."),15e3);e.onTransition(r=>{if(!r.hasTag("loading"))return clearTimeout(n),t(e)})}):Promise.resolve(e)}isReady(){var e,t;return!(null!=(t=null==(e=this._client.interpreter)?void 0:e.getSnapshot())&&t.hasTag("loading"))}get client(){return this._client}}var rU=Object.defineProperty,rL=(e,t,r)=>{let n;return(n="symbol"!=typeof t?t+"":t)in e?rU(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r};let rM=async(e,t,{accessToken:r,name:n,fileId:i,bucketId:s,adminSecret:o,onUploadProgress:a,headers:c={}}={})=>{var l;let u={...c};if(s&&t.append("bucket-id",s),o&&(u["x-hasura-admin-secret"]=o),r&&(u.Authorization=`Bearer ${r}`),(n||i)&&!t.has("metadata[]")){let e={};n&&(e.name=n),i&&(e.id=i),t.append("metadata[]",new Blob([JSON.stringify(e)],{type:"application/json"}),"")}let d=`${e}/files`;if("undefined"==typeof XMLHttpRequest)try{let e=await fetch(d,{method:"POST",headers:u,body:t}),r=await e.json();return e.ok?{fileMetadata:r,error:null}:{error:{status:e.status,message:(null==(l=null==r?void 0:r.error)?void 0:l.message)||e.statusText,error:e.statusText},fileMetadata:null}}catch(e){return{error:{status:0,message:e.message,error:e.message},fileMetadata:null}}return new Promise(e=>{let r=new XMLHttpRequest;r.responseType="json",r.onload=()=>{var t,n,i,s,o,a,c,l;return r.status<200||r.status>=300?e({fileMetadata:null,error:{error:null!=(o=null!=(s=null==(n=null==(t=r.response)?void 0:t.error)?void 0:n.message)?s:null==(i=r.response)?void 0:i.error)?o:r.response,message:null!=(l=null==(c=null==(a=r.response)?void 0:a.error)?void 0:c.message)?l:r.response,status:r.status}}):e({fileMetadata:r.response,error:null})},r.onerror=()=>e({fileMetadata:null,error:{error:r.statusText,message:r.statusText,status:r.status}}),a&&r.upload.addEventListener("progress",a,!1),r.open("POST",d,!0),Object.entries(u).forEach(([e,t])=>{r.setRequestHeader(e,t)}),r.send(t)})};function rj(e,t){if(!t||0===Object.keys(t).length)return e;let r=new URL(e);return Object.entries(Object.entries(t).reduce((e,[t,r])=>({...e,[t.charAt(0)]:r}),{})).forEach(([e,t])=>{t&&r.searchParams.set(e,t)}),r.toString()}class rF{constructor({url:e}){rL(this,"url"),rL(this,"accessToken"),rL(this,"adminSecret"),rL(this,"headers",{}),this.url=e}async uploadFormData({formData:e,bucketId:t,headers:r}){let{error:n,fileMetadata:i}=await rM(this.url,e,{bucketId:t,headers:{...this.headers,...r},accessToken:this.accessToken,adminSecret:this.adminSecret});return n?{fileMetadata:null,error:n}:!i||"processedFiles"in i?{fileMetadata:i,error:null}:{fileMetadata:{processedFiles:[i]},error:null}}async uploadFile({file:e,bucketId:t,id:r,name:n,headers:i}){let s=new FormData;s.append("file[]",e),s.append("metadata[]",new Blob([JSON.stringify({id:r,name:n})],{type:"application/json"}),"");let{error:o,fileMetadata:a}=await rM(this.url,s,{accessToken:this.accessToken,adminSecret:this.adminSecret,bucketId:t,headers:{...this.headers,...i}});return o?{fileMetadata:null,error:o}:a&&"processedFiles"in a?{fileMetadata:a.processedFiles[0],error:null}:{fileMetadata:a,error:null}}async downloadFile(e){try{let{fileId:t,headers:r,...n}=e,i=rj(`${this.url}/files/${t}`,n),s=await fetch(i,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...r}});if(!s.ok)throw Error(await s.text());return{file:await s.blob(),error:null}}catch(e){return{file:null,error:e}}}async getPresignedUrl(e){try{let{fileId:t,headers:r}=e,n=await fetch(`${this.url}/files/${t}/presignedurl`,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...r}});if(!n.ok)throw Error(await n.text());return{presignedUrl:await n.json(),error:null}}catch(e){return{presignedUrl:null,error:e}}}async delete(e){try{let{fileId:t,headers:r}=e,n=await fetch(`${this.url}/files/${t}`,{method:"DELETE",headers:{...this.generateAuthHeaders(),...this.headers,...r}});if(!n.ok)throw Error(await n.text());return{error:null}}catch(e){return{error:e}}}setAccessToken(e){return this.accessToken=e,this}setAdminSecret(e){return this.adminSecret=e,this}getHeaders(){return this.headers}setHeaders(e){return e&&(this.headers={...this.headers,...e}),this}unsetHeaders(){let e=this.headers["x-hasura-role"];return this.headers=e?{"x-hasura-role":e}:{},this}generateAuthHeaders(){if(!(!this.adminSecret&&!this.accessToken))return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:{Authorization:`Bearer ${this.accessToken}`}}}class rV{constructor({url:e,adminSecret:t}){rL(this,"url"),rL(this,"api"),this.url=e,this.api=new rF({url:e}),this.setAdminSecret(t)}async upload(e){return"file"in e?this.api.uploadFile(e):this.api.uploadFormData(e)}getPublicUrl(e){let{fileId:t,...r}=e;return rj(`${this.url}/files/${t}`,r)}async getPresignedUrl(e){let{fileId:t,headers:r,...n}=e,{presignedUrl:i,error:s}=await this.api.getPresignedUrl(e);if(s)return{presignedUrl:null,error:s};if(!i)return{presignedUrl:null,error:Error("Invalid file id")};let o=rj(i.url,n);return{presignedUrl:{...i,url:o},error:null}}async download(e){let{file:t,error:r}=await this.api.downloadFile(e);return r?{file:null,error:r}:t?{file:t,error:null}:{file:null,error:Error("File does not exist")}}async delete(e){let{error:t}=await this.api.delete(e);return t?{error:t}:{error:null}}setAccessToken(e){return this.api.setAccessToken(e),this}setAdminSecret(e){return this.api.setAdminSecret(e),this}getHeaders(){return this.api.getHeaders()}setHeaders(e){return this.api.setHeaders(e),this}unsetHeaders(){return this.api.unsetHeaders(),this}}let rB={progress:null,loaded:0,error:null,bucketId:void 0,file:void 0,id:void 0},r$=()=>ta({predictableActionArguments:!0,schema:{context:{},events:{}},tsTypes:{},context:{...rB},initial:"idle",on:{DESTROY:{actions:"sendDestroy",target:"stopped"}},states:{idle:{on:{ADD:{actions:"addFile"},UPLOAD:{cond:"hasFile",target:"uploading"}}},uploading:{entry:"resetProgress",on:{UPLOAD_PROGRESS:{actions:["incrementProgress","sendProgress"]},UPLOAD_DONE:"uploaded",UPLOAD_ERROR:"error",CANCEL:"idle"},invoke:{src:"uploadFile"}},uploaded:{entry:["setFileMetadata","sendDone"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},error:{entry:["setError","sendError"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},stopped:{type:"final"}}},{guards:{hasFile:(e,t)=>!!e.file||!!t.file},actions:{incrementProgress:eW({loaded:(e,{loaded:t})=>t,progress:(e,{progress:t})=>t}),setFileMetadata:eW({id:(e,{id:t})=>t,bucketId:(e,{bucketId:t})=>t,progress:e=>100}),setError:eW({error:(e,{error:t})=>t}),sendProgress:()=>{},sendError:()=>{},sendDestroy:()=>{},sendDone:()=>{},resetProgress:eW({progress:e=>null,loaded:e=>0}),resetContext:eW(e=>rB),addFile:eW({file:(e,{file:t})=>t,bucketId:(e,{bucketId:t})=>t,id:(e,{id:t})=>t})},services:{uploadFile:(e,t)=>r=>{let n=t.file||e.file,i=new FormData;i.append("file[]",n);let s=0;return rM(t.url,i,{fileId:t.id||e.id,bucketId:t.bucketId||e.bucketId,accessToken:t.accessToken,adminSecret:t.adminSecret,name:t.name||n.name,onUploadProgress:e=>{let t=e.total?Math.round(e.loaded*n.size/e.total):0,i=t-s;s=t,r({type:"UPLOAD_PROGRESS",progress:e.total?Math.round(100*t/e.total):0,loaded:t,additions:i})}}).then(({fileMetadata:e,error:t})=>{if(t&&r({type:"UPLOAD_ERROR",error:t}),e&&!("processedFiles"in e)){let{id:t,bucketId:n}=e;r({type:"UPLOAD_DONE",id:t,bucketId:n})}if(e&&"processedFiles"in e){let{id:t,bucketId:n}=e.processedFiles[0];r({type:"UPLOAD_DONE",id:t,bucketId:n})}}),()=>{}}}}),{pure:rK,sendParent:rG}=tc,rq=()=>ta({id:"files-list",schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,context:{progress:null,files:[],loaded:0,total:0},initial:"idle",on:{UPLOAD:{cond:"hasFileToDownload",actions:"addItem",target:"uploading"},ADD:{actions:"addItem"},REMOVE:{actions:"removeItem"}},states:{idle:{entry:["resetProgress","resetLoaded","resetTotal"],on:{CLEAR:{actions:"clearList",target:"idle"}}},uploading:{entry:["upload","startProgress","resetLoaded","resetTotal"],on:{UPLOAD_PROGRESS:{actions:["incrementProgress"]},UPLOAD_DONE:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],UPLOAD_ERROR:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],CANCEL:{actions:"cancel",target:"idle"}}},uploaded:{entry:"setUploaded",on:{CLEAR:{actions:"clearList",target:"idle"}}},error:{on:{CLEAR:{actions:"clearList",target:"idle"}}}}},{guards:{hasFileToDownload:(e,t)=>e.files.some(e=>e.getSnapshot().matches("idle"))||!!t.files,isAllUploaded:e=>e.files.every(e=>{var t;return null==(t=e.getSnapshot())?void 0:t.matches("uploaded")}),isAllUploadedOrError:e=>e.files.every(e=>{let t=e.getSnapshot();return(null==t?void 0:t.matches("error"))||(null==t?void 0:t.matches("uploaded"))})},actions:{incrementProgress:eW((e,t)=>{let r=e.loaded+t.additions,n=Math.round(100*r/e.total);return{...e,loaded:r,progress:n}}),setUploaded:eW({progress:e=>100,loaded:({files:e})=>e.map(e=>e.getSnapshot()).filter(e=>e.matches("uploaded")).reduce((e,t)=>{var r;return e+(null==(r=t.context.file)?void 0:r.size)},0)}),resetTotal:eW({total:({files:e})=>e.map(e=>e.getSnapshot()).filter(e=>!e.matches("uploaded")).reduce((e,t)=>{var r;return e+(null==(r=t.context.file)?void 0:r.size)},0)}),resetLoaded:eW({loaded:e=>0}),startProgress:eW({progress:e=>0}),resetProgress:eW({progress:e=>null}),addItem:eW((e,{files:t,bucketId:r})=>{let n=t?Array.isArray(t)?t:"item"in t?Array.from(t):[t]:[],i=e.total+n.reduce((e,t)=>e+t.size,0),s=Math.round(100*e.loaded/i);return{files:[...e.files,...n.map(e=>(function(e,t){var r=ec(t)?T(T({},tv),{name:t}):T(T(T({},tv),{name:eh()}),t),n=e7[e7.length-1];return n?n.spawn(e,r.name,r):tr(e,r.name)})(r$().withConfig({actions:{sendProgress:rG((e,{additions:t})=>({type:"UPLOAD_PROGRESS",additions:t})),sendDone:rG("UPLOAD_DONE"),sendError:rG("UPLOAD_ERROR"),sendDestroy:rG("REMOVE")}}).withContext({...rB,file:e,bucketId:r}),{sync:!0}))],total:i,loaded:e.loaded,progress:s}}),removeItem:eW({files:e=>e.files.filter(e=>{var t,r;let n=null==(t=e.getSnapshot())?void 0:t.matches("stopped");return n&&(null==(r=e.stop)||r.call(e)),!n})}),clearList:rK(e=>e.files.map(e=>eM({type:"DESTROY"},{to:e.id}))),upload:rK((e,t)=>e.files.map(e=>eM(t,{to:e.id}))),cancel:rK(e=>e.files.map(e=>eM({type:"CANCEL"},{to:e.id})))}}),rH=async(e,t)=>new Promise(r=>{t.send({type:"UPLOAD",...e}),t.subscribe(e=>{var t;e.matches("error")?r({error:e.context.error,isError:!0,isUploaded:!1}):e.matches("uploaded")&&r({error:null,isError:!1,isUploaded:!0,id:e.context.id,bucketId:e.context.id,name:null==(t=e.context.file)?void 0:t.name})})}),rY=async(e,t)=>new Promise(r=>{t.send({type:"UPLOAD",...e,files:e.files}),t.onTransition(e=>{e.matches("error")?r({errors:e.context.files.filter(e=>{var t;return null==(t=e.getSnapshot())?void 0:t.context.error}),isError:!0,files:[]}):e.matches("uploaded")&&r({errors:[],isError:!1,files:e.context.files})})});var rz=e.i(90452);let rJ=/\r\n|[\n\r]/g;function rW(e,t){let r=0,n=1;for(let i of e.body.matchAll(rJ)){if("number"==typeof i.index||function(e,t){if(!e)throw Error("Unexpected invariant triggered.")}(!1),i.index>=t)break;r=i.index+i[0].length,n+=1}return{line:n,column:t+1-r}}function rQ(e,t){let r=e.locationOffset.column-1,n="".padStart(r)+e.body,i=t.line-1,s=e.locationOffset.line-1,o=t.line+s,a=1===t.line?r:0,c=t.column+a,l=`${e.name}:${o}:${c}
`,u=n.split(/\r\n|[\n\r]/g),d=u[i];if(d.length>120){let e=Math.floor(c/80),t=[];for(let e=0;e<d.length;e+=80)t.push(d.slice(e,e+80));return l+rX([[`${o} |`,t[0]],...t.slice(1,e+1).map(e=>["|",e]),["|","^".padStart(c%80)],["|",t[e+1]]])}return l+rX([[`${o-1} |`,u[i-1]],[`${o} |`,d],["|","^".padStart(c)],[`${o+1} |`,u[i+1]]])}function rX(e){let t=e.filter(([e,t])=>void 0!==t),r=Math.max(...t.map(([e])=>e.length));return t.map(([e,t])=>e.padStart(r)+(t?" "+t:"")).join("\n")}class rZ extends Error{constructor(e,...t){var r,n,i;const{nodes:s,source:o,positions:a,path:c,originalError:l,extensions:u}=function(e){let t=e[0];return null==t||"kind"in t||"length"in t?{nodes:t,source:e[1],positions:e[2],path:e[3],originalError:e[4],extensions:e[5]}:t}(t);super(e),this.name="GraphQLError",this.path=null!=c?c:void 0,this.originalError=null!=l?l:void 0,this.nodes=r0(Array.isArray(s)?s:s?[s]:void 0);const d=r0(null==(r=this.nodes)?void 0:r.map(e=>e.loc).filter(e=>null!=e));this.source=null!=o?o:null==d||null==(n=d[0])?void 0:n.source,this.positions=null!=a?a:null==d?void 0:d.map(e=>e.start),this.locations=a&&o?a.map(e=>rW(o,e)):null==d?void 0:d.map(e=>rW(e.source,e.start));const h=!function(e){return"object"==typeof e&&null!==e}(null==l?void 0:l.extensions)||null==l?void 0:l.extensions;this.extensions=null!=(i=null!=u?u:h)?i:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!=l&&l.stack?Object.defineProperty(this,"stack",{value:l.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,rZ):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(let r of this.nodes){var t;r.loc&&(e+="\n\n"+rQ((t=r.loc).source,rW(t.source,t.start)))}else if(this.source&&this.locations)for(let t of this.locations)e+="\n\n"+rQ(this.source,t);return e}toJSON(){let e={message:this.message};return null!=this.locations&&(e.locations=this.locations),null!=this.path&&(e.path=this.path),null!=this.extensions&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function r0(e){return void 0===e||0===e.length?void 0:e}function r1(e,t,r){return new rZ(`Syntax Error: ${r}`,{source:e,positions:[t]})}class r2{constructor(e,t,r){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=r}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class r3{constructor(e,t,r,n,i,s){this.kind=e,this.start=t,this.end=r,this.line=n,this.column=i,this.value=s,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}let r4={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},r8=new Set(Object.keys(r4));function r9(e){let t=null==e?void 0:e.kind;return"string"==typeof t&&r8.has(t)}function r5(e){return 9===e||32===e}function r6(e){return e>=48&&e<=57}function r7(e){return e>=97&&e<=122||e>=65&&e<=90}function ne(e){return r7(e)||95===e}(s=p||(p={})).QUERY="query",s.MUTATION="mutation",s.SUBSCRIPTION="subscription",(o=f||(f={})).QUERY="QUERY",o.MUTATION="MUTATION",o.SUBSCRIPTION="SUBSCRIPTION",o.FIELD="FIELD",o.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",o.FRAGMENT_SPREAD="FRAGMENT_SPREAD",o.INLINE_FRAGMENT="INLINE_FRAGMENT",o.VARIABLE_DEFINITION="VARIABLE_DEFINITION",o.SCHEMA="SCHEMA",o.SCALAR="SCALAR",o.OBJECT="OBJECT",o.FIELD_DEFINITION="FIELD_DEFINITION",o.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",o.INTERFACE="INTERFACE",o.UNION="UNION",o.ENUM="ENUM",o.ENUM_VALUE="ENUM_VALUE",o.INPUT_OBJECT="INPUT_OBJECT",o.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION",(a=v||(v={})).NAME="Name",a.DOCUMENT="Document",a.OPERATION_DEFINITION="OperationDefinition",a.VARIABLE_DEFINITION="VariableDefinition",a.SELECTION_SET="SelectionSet",a.FIELD="Field",a.ARGUMENT="Argument",a.FRAGMENT_SPREAD="FragmentSpread",a.INLINE_FRAGMENT="InlineFragment",a.FRAGMENT_DEFINITION="FragmentDefinition",a.VARIABLE="Variable",a.INT="IntValue",a.FLOAT="FloatValue",a.STRING="StringValue",a.BOOLEAN="BooleanValue",a.NULL="NullValue",a.ENUM="EnumValue",a.LIST="ListValue",a.OBJECT="ObjectValue",a.OBJECT_FIELD="ObjectField",a.DIRECTIVE="Directive",a.NAMED_TYPE="NamedType",a.LIST_TYPE="ListType",a.NON_NULL_TYPE="NonNullType",a.SCHEMA_DEFINITION="SchemaDefinition",a.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",a.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",a.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",a.FIELD_DEFINITION="FieldDefinition",a.INPUT_VALUE_DEFINITION="InputValueDefinition",a.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",a.UNION_TYPE_DEFINITION="UnionTypeDefinition",a.ENUM_TYPE_DEFINITION="EnumTypeDefinition",a.ENUM_VALUE_DEFINITION="EnumValueDefinition",a.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",a.DIRECTIVE_DEFINITION="DirectiveDefinition",a.SCHEMA_EXTENSION="SchemaExtension",a.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",a.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",a.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",a.UNION_TYPE_EXTENSION="UnionTypeExtension",a.ENUM_TYPE_EXTENSION="EnumTypeExtension",a.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension",(c=m||(m={})).SOF="<SOF>",c.EOF="<EOF>",c.BANG="!",c.DOLLAR="$",c.AMP="&",c.PAREN_L="(",c.PAREN_R=")",c.SPREAD="...",c.COLON=":",c.EQUALS="=",c.AT="@",c.BRACKET_L="[",c.BRACKET_R="]",c.BRACE_L="{",c.PIPE="|",c.BRACE_R="}",c.NAME="Name",c.INT="Int",c.FLOAT="Float",c.STRING="String",c.BLOCK_STRING="BlockString",c.COMMENT="Comment";class nt{constructor(e){const t=new r3(m.SOF,0,0,0,0);this.source=e,this.lastToken=t,this.token=t,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==m.EOF)do if(e.next)e=e.next;else{let t=function(e,t){let r=e.source.body,n=r.length,i=t;for(;i<n;){let t=r.charCodeAt(i);switch(t){case 65279:case 9:case 32:case 44:++i;continue;case 10:++i,++e.line,e.lineStart=i;continue;case 13:10===r.charCodeAt(i+1)?i+=2:++i,++e.line,e.lineStart=i;continue;case 35:return function(e,t){let r=e.source.body,n=r.length,i=t+1;for(;i<n;){let e=r.charCodeAt(i);if(10===e||13===e)break;if(nr(e))++i;else if(nn(r,i))i+=2;else break}return na(e,m.COMMENT,t,i,r.slice(t+1,i))}(e,i);case 33:return na(e,m.BANG,i,i+1);case 36:return na(e,m.DOLLAR,i,i+1);case 38:return na(e,m.AMP,i,i+1);case 40:return na(e,m.PAREN_L,i,i+1);case 41:return na(e,m.PAREN_R,i,i+1);case 46:if(46===r.charCodeAt(i+1)&&46===r.charCodeAt(i+2))return na(e,m.SPREAD,i,i+3);break;case 58:return na(e,m.COLON,i,i+1);case 61:return na(e,m.EQUALS,i,i+1);case 64:return na(e,m.AT,i,i+1);case 91:return na(e,m.BRACKET_L,i,i+1);case 93:return na(e,m.BRACKET_R,i,i+1);case 123:return na(e,m.BRACE_L,i,i+1);case 124:return na(e,m.PIPE,i,i+1);case 125:return na(e,m.BRACE_R,i,i+1);case 34:if(34===r.charCodeAt(i+1)&&34===r.charCodeAt(i+2))return function(e,t){let r=e.source.body,n=r.length,i=e.lineStart,s=t+3,o=s,a="",c=[];for(;s<n;){let n=r.charCodeAt(s);if(34===n&&34===r.charCodeAt(s+1)&&34===r.charCodeAt(s+2)){a+=r.slice(o,s),c.push(a);let n=na(e,m.BLOCK_STRING,t,s+3,(function(e){var t,r;let n=Number.MAX_SAFE_INTEGER,i=null,s=-1;for(let t=0;t<e.length;++t){let o=e[t],a=function(e){let t=0;for(;t<e.length&&r5(e.charCodeAt(t));)++t;return t}(o);a!==o.length&&(i=null!=(r=i)?r:t,s=t,0!==t&&a<n&&(n=a))}return e.map((e,t)=>0===t?e:e.slice(n)).slice(null!=(t=i)?t:0,s+1)})(c).join("\n"));return e.line+=c.length-1,e.lineStart=i,n}if(92===n&&34===r.charCodeAt(s+1)&&34===r.charCodeAt(s+2)&&34===r.charCodeAt(s+3)){a+=r.slice(o,s),o=s+1,s+=4;continue}if(10===n||13===n){a+=r.slice(o,s),c.push(a),13===n&&10===r.charCodeAt(s+1)?s+=2:++s,a="",o=s,i=s;continue}if(nr(n))++s;else if(nn(r,s))s+=2;else throw r1(e.source,s,`Invalid character within String: ${no(e,s)}.`)}throw r1(e.source,s,"Unterminated string.")}(e,i);return function(e,t){let r=e.source.body,n=r.length,i=t+1,s=i,o="";for(;i<n;){let n=r.charCodeAt(i);if(34===n)return o+=r.slice(s,i),na(e,m.STRING,t,i+1,o);if(92===n){o+=r.slice(s,i);let t=117===r.charCodeAt(i+1)?123===r.charCodeAt(i+2)?function(e,t){let r=e.source.body,n=0,i=3;for(;i<12;){let e=r.charCodeAt(t+i++);if(125===e){if(i<5||!nr(n))break;return{value:String.fromCodePoint(n),size:i}}if((n=n<<4|nu(e))<0)break}throw r1(e.source,t,`Invalid Unicode escape sequence: "${r.slice(t,t+i)}".`)}(e,i):function(e,t){let r=e.source.body,n=nl(r,t+2);if(nr(n))return{value:String.fromCodePoint(n),size:6};if(ni(n)&&92===r.charCodeAt(t+6)&&117===r.charCodeAt(t+7)){let e=nl(r,t+8);if(ns(e))return{value:String.fromCodePoint(n,e),size:12}}throw r1(e.source,t,`Invalid Unicode escape sequence: "${r.slice(t,t+6)}".`)}(e,i):function(e,t){let r=e.source.body;switch(r.charCodeAt(t+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:"\n",size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw r1(e.source,t,`Invalid character escape sequence: "${r.slice(t,t+2)}".`)}(e,i);o+=t.value,i+=t.size,s=i;continue}if(10===n||13===n)break;if(nr(n))++i;else if(nn(r,i))i+=2;else throw r1(e.source,i,`Invalid character within String: ${no(e,i)}.`)}throw r1(e.source,i,"Unterminated string.")}(e,i)}if(r6(t)||45===t)return function(e,t,r){let n=e.source.body,i=t,s=r,o=!1;if(45===s&&(s=n.charCodeAt(++i)),48===s){if(r6(s=n.charCodeAt(++i)))throw r1(e.source,i,`Invalid number, unexpected digit after 0: ${no(e,i)}.`)}else i=nc(e,i,s),s=n.charCodeAt(i);if(46===s&&(o=!0,s=n.charCodeAt(++i),i=nc(e,i,s),s=n.charCodeAt(i)),(69===s||101===s)&&(o=!0,(43===(s=n.charCodeAt(++i))||45===s)&&(s=n.charCodeAt(++i)),i=nc(e,i,s),s=n.charCodeAt(i)),46===s||ne(s))throw r1(e.source,i,`Invalid number, expected digit but got: ${no(e,i)}.`);return na(e,o?m.FLOAT:m.INT,t,i,n.slice(t,i))}(e,i,t);if(ne(t))return function(e,t){let r=e.source.body,n=r.length,i=t+1;for(;i<n;){var s;if(r7(s=r.charCodeAt(i))||r6(s)||95===s)++i;else break}return na(e,m.NAME,t,i,r.slice(t,i))}(e,i);throw r1(e.source,i,39===t?"Unexpected single quote character ('), did you mean to use a double quote (\")?":nr(t)||nn(r,i)?`Unexpected character: ${no(e,i)}.`:`Invalid character: ${no(e,i)}.`)}return na(e,m.EOF,n,n)}(this,e.end);e.next=t,t.prev=e,e=t}while(e.kind===m.COMMENT)return e}}function nr(e){return e>=0&&e<=55295||e>=57344&&e<=1114111}function nn(e,t){return ni(e.charCodeAt(t))&&ns(e.charCodeAt(t+1))}function ni(e){return e>=55296&&e<=56319}function ns(e){return e>=56320&&e<=57343}function no(e,t){let r=e.source.body.codePointAt(t);if(void 0===r)return m.EOF;if(r>=32&&r<=126){let e=String.fromCodePoint(r);return'"'===e?"'\"'":`"${e}"`}return"U+"+r.toString(16).toUpperCase().padStart(4,"0")}function na(e,t,r,n,i){let s=e.line,o=1+r-e.lineStart;return new r3(t,r,n,s,o,i)}function nc(e,t,r){if(!r6(r))throw r1(e.source,t,`Invalid number, expected digit but got: ${no(e,t)}.`);let n=e.source.body,i=t+1;for(;r6(n.charCodeAt(i));)++i;return i}function nl(e,t){return nu(e.charCodeAt(t))<<12|nu(e.charCodeAt(t+1))<<8|nu(e.charCodeAt(t+2))<<4|nu(e.charCodeAt(t+3))}function nu(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function nd(e,t){if(!e)throw Error(t)}function nh(e,t){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return function(e,t){let r;if(null===e)return"null";if(t.includes(e))return"[Circular]";let n=[...t,e];if("function"==typeof e.toJSON){let t=e.toJSON();if(t!==e)return"string"==typeof t?t:nh(t,n)}else if(Array.isArray(e)){var i,s,o=e,a=n;if(0===o.length)return"[]";if(a.length>2)return"[Array]";let t=Math.min(10,o.length),r=o.length-t,c=[];for(let e=0;e<t;++e)c.push(nh(o[e],a));return 1===r?c.push("... 1 more item"):r>1&&c.push(`... ${r} more items`),"["+c.join(", ")+"]"}return i=e,s=n,0===(r=Object.entries(i)).length?"{}":s.length>2?"["+function(e){let t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){let t=e.constructor.name;if("string"==typeof t&&""!==t)return t}return t}(i)+"]":"{ "+r.map(([e,t])=>e+": "+nh(t,s)).join(", ")+" }"}(e,t);default:return String(e)}}let np=globalThis.process&&"production"===globalThis.process.env.NODE_ENV?function(e,t){return e instanceof t}:function(e,t){if(e instanceof t)return!0;if("object"==typeof e&&null!==e){var r;let n=t.prototype[Symbol.toStringTag];if(n===(Symbol.toStringTag in e?e[Symbol.toStringTag]:null==(r=e.constructor)?void 0:r.name)){let t=nh(e,[]);throw Error(`Cannot use ${n} "${t}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class nf{constructor(e,t="GraphQL request",r={line:1,column:1}){"string"==typeof e||nd(!1,`Body must be a string. Received: ${nh(e,[])}.`),this.body=e,this.name=t,this.locationOffset=r,this.locationOffset.line>0||nd(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||nd(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}class nv{constructor(e,t={}){const r=np(e,nf)?e:new nf(e);this._lexer=new nt(r),this._options=t,this._tokenCounter=0}parseName(){let e=this.expectToken(m.NAME);return this.node(e,{kind:v.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:v.DOCUMENT,definitions:this.many(m.SOF,this.parseDefinition,m.EOF)})}parseDefinition(){if(this.peek(m.BRACE_L))return this.parseOperationDefinition();let e=this.peekDescription(),t=e?this._lexer.lookahead():this._lexer.token;if(t.kind===m.NAME){switch(t.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw r1(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(t.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(t)}parseOperationDefinition(){let e,t=this._lexer.token;if(this.peek(m.BRACE_L))return this.node(t,{kind:v.OPERATION_DEFINITION,operation:p.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});let r=this.parseOperationType();return this.peek(m.NAME)&&(e=this.parseName()),this.node(t,{kind:v.OPERATION_DEFINITION,operation:r,name:e,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){let e=this.expectToken(m.NAME);switch(e.value){case"query":return p.QUERY;case"mutation":return p.MUTATION;case"subscription":return p.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(m.PAREN_L,this.parseVariableDefinition,m.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:v.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(m.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(m.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){let e=this._lexer.token;return this.expectToken(m.DOLLAR),this.node(e,{kind:v.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:v.SELECTION_SET,selections:this.many(m.BRACE_L,this.parseSelection,m.BRACE_R)})}parseSelection(){return this.peek(m.SPREAD)?this.parseFragment():this.parseField()}parseField(){let e,t,r=this._lexer.token,n=this.parseName();return this.expectOptionalToken(m.COLON)?(e=n,t=this.parseName()):t=n,this.node(r,{kind:v.FIELD,alias:e,name:t,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(m.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){let t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(m.PAREN_L,t,m.PAREN_R)}parseArgument(e=!1){let t=this._lexer.token,r=this.parseName();return this.expectToken(m.COLON),this.node(t,{kind:v.ARGUMENT,name:r,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){let e=this._lexer.token;this.expectToken(m.SPREAD);let t=this.expectOptionalKeyword("on");return!t&&this.peek(m.NAME)?this.node(e,{kind:v.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:v.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){let e=this._lexer.token;return(this.expectKeyword("fragment"),!0===this._options.allowLegacyFragmentVariables)?this.node(e,{kind:v.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:v.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()}parseValueLiteral(e){let t=this._lexer.token;switch(t.kind){case m.BRACKET_L:return this.parseList(e);case m.BRACE_L:return this.parseObject(e);case m.INT:return this.advanceLexer(),this.node(t,{kind:v.INT,value:t.value});case m.FLOAT:return this.advanceLexer(),this.node(t,{kind:v.FLOAT,value:t.value});case m.STRING:case m.BLOCK_STRING:return this.parseStringLiteral();case m.NAME:switch(this.advanceLexer(),t.value){case"true":return this.node(t,{kind:v.BOOLEAN,value:!0});case"false":return this.node(t,{kind:v.BOOLEAN,value:!1});case"null":return this.node(t,{kind:v.NULL});default:return this.node(t,{kind:v.ENUM,value:t.value})}case m.DOLLAR:if(e){if(this.expectToken(m.DOLLAR),this._lexer.token.kind===m.NAME){let e=this._lexer.token.value;throw r1(this._lexer.source,t.start,`Unexpected variable "$${e}" in constant value.`)}throw this.unexpected(t)}return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){let e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:v.STRING,value:e.value,block:e.kind===m.BLOCK_STRING})}parseList(e){let t=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:v.LIST,values:this.any(m.BRACKET_L,t,m.BRACKET_R)})}parseObject(e){let t=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:v.OBJECT,fields:this.any(m.BRACE_L,t,m.BRACE_R)})}parseObjectField(e){let t=this._lexer.token,r=this.parseName();return this.expectToken(m.COLON),this.node(t,{kind:v.OBJECT_FIELD,name:r,value:this.parseValueLiteral(e)})}parseDirectives(e){let t=[];for(;this.peek(m.AT);)t.push(this.parseDirective(e));return t}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){let t=this._lexer.token;return this.expectToken(m.AT),this.node(t,{kind:v.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){let e,t=this._lexer.token;if(this.expectOptionalToken(m.BRACKET_L)){let r=this.parseTypeReference();this.expectToken(m.BRACKET_R),e=this.node(t,{kind:v.LIST_TYPE,type:r})}else e=this.parseNamedType();return this.expectOptionalToken(m.BANG)?this.node(t,{kind:v.NON_NULL_TYPE,type:e}):e}parseNamedType(){return this.node(this._lexer.token,{kind:v.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(m.STRING)||this.peek(m.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");let r=this.parseConstDirectives(),n=this.many(m.BRACE_L,this.parseOperationTypeDefinition,m.BRACE_R);return this.node(e,{kind:v.SCHEMA_DEFINITION,description:t,directives:r,operationTypes:n})}parseOperationTypeDefinition(){let e=this._lexer.token,t=this.parseOperationType();this.expectToken(m.COLON);let r=this.parseNamedType();return this.node(e,{kind:v.OPERATION_TYPE_DEFINITION,operation:t,type:r})}parseScalarTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");let r=this.parseName(),n=this.parseConstDirectives();return this.node(e,{kind:v.SCALAR_TYPE_DEFINITION,description:t,name:r,directives:n})}parseObjectTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");let r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();return this.node(e,{kind:v.OBJECT_TYPE_DEFINITION,description:t,name:r,interfaces:n,directives:i,fields:s})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(m.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(m.BRACE_L,this.parseFieldDefinition,m.BRACE_R)}parseFieldDefinition(){let e=this._lexer.token,t=this.parseDescription(),r=this.parseName(),n=this.parseArgumentDefs();this.expectToken(m.COLON);let i=this.parseTypeReference(),s=this.parseConstDirectives();return this.node(e,{kind:v.FIELD_DEFINITION,description:t,name:r,arguments:n,type:i,directives:s})}parseArgumentDefs(){return this.optionalMany(m.PAREN_L,this.parseInputValueDef,m.PAREN_R)}parseInputValueDef(){let e,t=this._lexer.token,r=this.parseDescription(),n=this.parseName();this.expectToken(m.COLON);let i=this.parseTypeReference();this.expectOptionalToken(m.EQUALS)&&(e=this.parseConstValueLiteral());let s=this.parseConstDirectives();return this.node(t,{kind:v.INPUT_VALUE_DEFINITION,description:r,name:n,type:i,defaultValue:e,directives:s})}parseInterfaceTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");let r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();return this.node(e,{kind:v.INTERFACE_TYPE_DEFINITION,description:t,name:r,interfaces:n,directives:i,fields:s})}parseUnionTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");let r=this.parseName(),n=this.parseConstDirectives(),i=this.parseUnionMemberTypes();return this.node(e,{kind:v.UNION_TYPE_DEFINITION,description:t,name:r,directives:n,types:i})}parseUnionMemberTypes(){return this.expectOptionalToken(m.EQUALS)?this.delimitedMany(m.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");let r=this.parseName(),n=this.parseConstDirectives(),i=this.parseEnumValuesDefinition();return this.node(e,{kind:v.ENUM_TYPE_DEFINITION,description:t,name:r,directives:n,values:i})}parseEnumValuesDefinition(){return this.optionalMany(m.BRACE_L,this.parseEnumValueDefinition,m.BRACE_R)}parseEnumValueDefinition(){let e=this._lexer.token,t=this.parseDescription(),r=this.parseEnumValueName(),n=this.parseConstDirectives();return this.node(e,{kind:v.ENUM_VALUE_DEFINITION,description:t,name:r,directives:n})}parseEnumValueName(){if("true"===this._lexer.token.value||"false"===this._lexer.token.value||"null"===this._lexer.token.value)throw r1(this._lexer.source,this._lexer.token.start,`${nm(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");let r=this.parseName(),n=this.parseConstDirectives(),i=this.parseInputFieldsDefinition();return this.node(e,{kind:v.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:r,directives:n,fields:i})}parseInputFieldsDefinition(){return this.optionalMany(m.BRACE_L,this.parseInputValueDef,m.BRACE_R)}parseTypeSystemExtension(){let e=this._lexer.lookahead();if(e.kind===m.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");let t=this.parseConstDirectives(),r=this.optionalMany(m.BRACE_L,this.parseOperationTypeDefinition,m.BRACE_R);if(0===t.length&&0===r.length)throw this.unexpected();return this.node(e,{kind:v.SCHEMA_EXTENSION,directives:t,operationTypes:r})}parseScalarTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");let t=this.parseName(),r=this.parseConstDirectives();if(0===r.length)throw this.unexpected();return this.node(e,{kind:v.SCALAR_TYPE_EXTENSION,name:t,directives:r})}parseObjectTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");let t=this.parseName(),r=this.parseImplementsInterfaces(),n=this.parseConstDirectives(),i=this.parseFieldsDefinition();if(0===r.length&&0===n.length&&0===i.length)throw this.unexpected();return this.node(e,{kind:v.OBJECT_TYPE_EXTENSION,name:t,interfaces:r,directives:n,fields:i})}parseInterfaceTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");let t=this.parseName(),r=this.parseImplementsInterfaces(),n=this.parseConstDirectives(),i=this.parseFieldsDefinition();if(0===r.length&&0===n.length&&0===i.length)throw this.unexpected();return this.node(e,{kind:v.INTERFACE_TYPE_EXTENSION,name:t,interfaces:r,directives:n,fields:i})}parseUnionTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");let t=this.parseName(),r=this.parseConstDirectives(),n=this.parseUnionMemberTypes();if(0===r.length&&0===n.length)throw this.unexpected();return this.node(e,{kind:v.UNION_TYPE_EXTENSION,name:t,directives:r,types:n})}parseEnumTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");let t=this.parseName(),r=this.parseConstDirectives(),n=this.parseEnumValuesDefinition();if(0===r.length&&0===n.length)throw this.unexpected();return this.node(e,{kind:v.ENUM_TYPE_EXTENSION,name:t,directives:r,values:n})}parseInputObjectTypeExtension(){let e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");let t=this.parseName(),r=this.parseConstDirectives(),n=this.parseInputFieldsDefinition();if(0===r.length&&0===n.length)throw this.unexpected();return this.node(e,{kind:v.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:r,fields:n})}parseDirectiveDefinition(){let e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(m.AT);let r=this.parseName(),n=this.parseArgumentDefs(),i=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");let s=this.parseDirectiveLocations();return this.node(e,{kind:v.DIRECTIVE_DEFINITION,description:t,name:r,arguments:n,repeatable:i,locations:s})}parseDirectiveLocations(){return this.delimitedMany(m.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){let e=this._lexer.token,t=this.parseName();if(Object.prototype.hasOwnProperty.call(f,t.value))return t;throw this.unexpected(e)}node(e,t){return!0!==this._options.noLocation&&(t.loc=new r2(e,this._lexer.lastToken,this._lexer.source)),t}peek(e){return this._lexer.token.kind===e}expectToken(e){let t=this._lexer.token;if(t.kind===e)return this.advanceLexer(),t;throw r1(this._lexer.source,t.start,`Expected ${ny(e)}, found ${nm(t)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e&&(this.advanceLexer(),!0)}expectKeyword(e){let t=this._lexer.token;if(t.kind===m.NAME&&t.value===e)this.advanceLexer();else throw r1(this._lexer.source,t.start,`Expected "${e}", found ${nm(t)}.`)}expectOptionalKeyword(e){let t=this._lexer.token;return t.kind===m.NAME&&t.value===e&&(this.advanceLexer(),!0)}unexpected(e){let t=null!=e?e:this._lexer.token;return r1(this._lexer.source,t.start,`Unexpected ${nm(t)}.`)}any(e,t,r){this.expectToken(e);let n=[];for(;!this.expectOptionalToken(r);)n.push(t.call(this));return n}optionalMany(e,t,r){if(this.expectOptionalToken(e)){let e=[];do e.push(t.call(this));while(!this.expectOptionalToken(r))return e}return[]}many(e,t,r){this.expectToken(e);let n=[];do n.push(t.call(this));while(!this.expectOptionalToken(r))return n}delimitedMany(e,t){this.expectOptionalToken(e);let r=[];do r.push(t.call(this));while(this.expectOptionalToken(e))return r}advanceLexer(){let{maxTokens:e}=this._options,t=this._lexer.advance();if(void 0!==e&&t.kind!==m.EOF&&(++this._tokenCounter,this._tokenCounter>e))throw r1(this._lexer.source,t.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function nm(e){let t=e.value;return ny(e.kind)+(null!=t?` "${t}"`:"")}function ny(e){return e===m.BANG||e===m.DOLLAR||e===m.AMP||e===m.PAREN_L||e===m.PAREN_R||e===m.SPREAD||e===m.COLON||e===m.EQUALS||e===m.AT||e===m.BRACKET_L||e===m.BRACKET_R||e===m.BRACE_L||e===m.PIPE||e===m.BRACE_R?`"${e}"`:e}let ng=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function nE(e){return nT[e.charCodeAt(0)]}let nT=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],nS=Object.freeze({}),nk={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>nx(e.definitions,"\n\n")},OperationDefinition:{leave(e){let t=nw("(",nx(e.variableDefinitions,", "),")"),r=nx([e.operation,nx([e.name,t]),nx(e.directives," ")]," ");return("query"===r?"":r+" ")+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:t,defaultValue:r,directives:n})=>e+": "+t+nw(" = ",r)+nw(" ",nx(n," "))},SelectionSet:{leave:({selections:e})=>nb(e)},Field:{leave({alias:e,name:t,arguments:r,directives:n,selectionSet:i}){let s=nw("",e,": ")+t,o=s+nw("(",nx(r,", "),")");return o.length>80&&(o=s+nw("(\n",nA(nx(r,"\n")),"\n)")),nx([o,nx(n," "),i]," ")}},Argument:{leave:({name:e,value:t})=>e+": "+t},FragmentSpread:{leave:({name:e,directives:t})=>"..."+e+nw(" ",nx(t," "))},InlineFragment:{leave:({typeCondition:e,directives:t,selectionSet:r})=>nx(["...",nw("on ",e),nx(t," "),r]," ")},FragmentDefinition:{leave:({name:e,typeCondition:t,variableDefinitions:r,directives:n,selectionSet:i})=>`fragment ${e}${nw("(",nx(r,", "),")")} on ${t} ${nw("",nx(n," ")," ")}`+i},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:t})=>{let r,n,i,s,o,a,c,l,u,d,h;return t?(i=1===(n=(r=e.replace(/"""/g,'\\"""')).split(/\r\n|[\n\r]/g)).length,s=n.length>1&&n.slice(1).every(e=>0===e.length||r5(e.charCodeAt(0))),o=r.endsWith('\\"""'),a=e.endsWith('"')&&!o,c=e.endsWith("\\"),l=a||c,u=!i||e.length>70||l||s||o,d="",h=i&&r5(e.charCodeAt(0)),(u&&!h||s)&&(d+="\n"),d+=r,(u||l)&&(d+="\n"),'"""'+d+'"""'):`"${e.replace(ng,nE)}"`}},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+nx(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+nx(e,", ")+"}"},ObjectField:{leave:({name:e,value:t})=>e+": "+t},Directive:{leave:({name:e,arguments:t})=>"@"+e+nw("(",nx(t,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({description:e,directives:t,operationTypes:r})=>nw("",e,"\n")+nx(["schema",nx(t," "),nb(r)]," ")},OperationTypeDefinition:{leave:({operation:e,type:t})=>e+": "+t},ScalarTypeDefinition:{leave:({description:e,name:t,directives:r})=>nw("",e,"\n")+nx(["scalar",t,nx(r," ")]," ")},ObjectTypeDefinition:{leave:({description:e,name:t,interfaces:r,directives:n,fields:i})=>nw("",e,"\n")+nx(["type",t,nw("implements ",nx(r," & ")),nx(n," "),nb(i)]," ")},FieldDefinition:{leave:({description:e,name:t,arguments:r,type:n,directives:i})=>nw("",e,"\n")+t+(n_(r)?nw("(\n",nA(nx(r,"\n")),"\n)"):nw("(",nx(r,", "),")"))+": "+n+nw(" ",nx(i," "))},InputValueDefinition:{leave:({description:e,name:t,type:r,defaultValue:n,directives:i})=>nw("",e,"\n")+nx([t+": "+r,nw("= ",n),nx(i," ")]," ")},InterfaceTypeDefinition:{leave:({description:e,name:t,interfaces:r,directives:n,fields:i})=>nw("",e,"\n")+nx(["interface",t,nw("implements ",nx(r," & ")),nx(n," "),nb(i)]," ")},UnionTypeDefinition:{leave:({description:e,name:t,directives:r,types:n})=>nw("",e,"\n")+nx(["union",t,nx(r," "),nw("= ",nx(n," | "))]," ")},EnumTypeDefinition:{leave:({description:e,name:t,directives:r,values:n})=>nw("",e,"\n")+nx(["enum",t,nx(r," "),nb(n)]," ")},EnumValueDefinition:{leave:({description:e,name:t,directives:r})=>nw("",e,"\n")+nx([t,nx(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:e,name:t,directives:r,fields:n})=>nw("",e,"\n")+nx(["input",t,nx(r," "),nb(n)]," ")},DirectiveDefinition:{leave:({description:e,name:t,arguments:r,repeatable:n,locations:i})=>nw("",e,"\n")+"directive @"+t+(n_(r)?nw("(\n",nA(nx(r,"\n")),"\n)"):nw("(",nx(r,", "),")"))+(n?" repeatable":"")+" on "+nx(i," | ")},SchemaExtension:{leave:({directives:e,operationTypes:t})=>nx(["extend schema",nx(e," "),nb(t)]," ")},ScalarTypeExtension:{leave:({name:e,directives:t})=>nx(["extend scalar",e,nx(t," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:t,directives:r,fields:n})=>nx(["extend type",e,nw("implements ",nx(t," & ")),nx(r," "),nb(n)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:t,directives:r,fields:n})=>nx(["extend interface",e,nw("implements ",nx(t," & ")),nx(r," "),nb(n)]," ")},UnionTypeExtension:{leave:({name:e,directives:t,types:r})=>nx(["extend union",e,nx(t," "),nw("= ",nx(r," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:t,values:r})=>nx(["extend enum",e,nx(t," "),nb(r)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:t,fields:r})=>nx(["extend input",e,nx(t," "),nb(r)]," ")}};function nx(e,t=""){var r;return null!=(r=null==e?void 0:e.filter(e=>e).join(t))?r:""}function nb(e){return nw("{\n",nA(nx(e,"\n")),"\n}")}function nw(e,t,r=""){return null!=t&&""!==t?e+t+r:""}function nA(e){return nw("  ",e.replace(/\n/g,"\n  "))}function n_(e){var t;return null!=(t=null==e?void 0:e.some(e=>e.includes("\n")))&&t}function nI(e){var t;let r,n=e.definitions.filter(e=>"OperationDefinition"===e.kind);return 1===n.length&&(r=null==(t=n[0].name)?void 0:t.value),r}class nO{constructor(e){this.headers={},this.isAccessTokenValidOrNull=()=>{if(!this.accessToken)return!0;try{let e=E(this.accessToken);return null!=e.exp&&1e3*e.exp>Date.now()}catch(e){return console.error("Error decoding token:",e),!1}},this.awaitForValidAccessTokenOrNull=async()=>{if(this.isAccessTokenValidOrNull())return!0;let e=()=>this.isAccessTokenValidOrNull()?Promise.resolve(!0):new Promise(t=>{setTimeout(()=>e().then(t),100)});return e()};const{url:t,adminSecret:r}=e;this._url=t,this.accessToken=null,this.adminSecret=r}async request(e,...t){let[r,n]=t,i=e.document?e:{document:e,variables:r,config:n},{headers:s,...o}=n||{},{query:a,operationName:c}=function(e){if("string"==typeof e){let t;try{let r=new nv(e,void 0).parseDocument();t=nI(r)}catch{}return{query:e,operationName:t}}let t=nI(e);return{query:function(e,t,r=r4){let n,i,s,o=new Map;for(let e of Object.values(v))o.set(e,function(e,t){let r=e[t];return"object"==typeof r?r:"function"==typeof r?{enter:r,leave:void 0}:{enter:e.enter,leave:e.leave}}(t,e));let a=Array.isArray(e),c=[e],l=-1,u=[],d=e,h=[],p=[];do{var f,m,y;let e,v=++l===c.length,g=v&&0!==u.length;if(v){if(i=0===p.length?void 0:h[h.length-1],d=s,s=p.pop(),g)if(a){d=d.slice();let e=0;for(let[t,r]of u){let n=t-e;null===r?(d.splice(n,1),e++):d[n]=r}}else for(let[e,t]of(d=Object.defineProperties({},Object.getOwnPropertyDescriptors(d)),u))d[e]=t;l=n.index,c=n.keys,u=n.edits,a=n.inArray,n=n.prev}else if(s){if(null==(d=s[i=a?l:c[l]]))continue;h.push(i)}if(!Array.isArray(d)){r9(d)||nd(!1,`Invalid AST Node: ${nh(d,[])}.`);let r=v?null==(f=o.get(d.kind))?void 0:f.leave:null==(m=o.get(d.kind))?void 0:m.enter;if((e=null==r?void 0:r.call(t,d,i,s,h,p))===nS)break;if(!1===e){if(!v){h.pop();continue}}else if(void 0!==e&&(u.push([i,e]),!v))if(r9(e))d=e;else{h.pop();continue}}void 0===e&&g&&u.push([i,d]),v?h.pop():(n={inArray:a,index:l,keys:c,edits:u,prev:n},c=(a=Array.isArray(d))?d:null!=(y=r[d.kind])?y:[],l=-1,u=[],s&&p.push(s),s=d)}while(void 0!==n)return 0!==u.length?u[u.length-1][1]:e}(e,nk),operationName:t}}(i.document);void 0===y.default||y.default.env.TEST_MODE||await this.awaitForValidAccessTokenOrNull();try{let e=await (0,rz.default)(this.httpUrl,{method:"POST",body:JSON.stringify({operationName:c,query:a,variables:r}),headers:{"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...this.headers,...s},...o});if(!e.ok)return{data:null,error:{error:e.statusText,message:e.statusText,status:e.status}};let{data:t,errors:n}=await e.json();return n?{data:null,error:n}:"object"!=typeof t||Array.isArray(t)||null===t?{data:null,error:{error:"invalid-response",message:"incorrect response data from GraphQL server",status:0}}:{data:t,error:null}}catch(e){return{data:null,error:{message:e.message,status:500*("AbortError"!==e.name),error:"AbortError"===e.name?"abort-error":"unknown"}}}}get httpUrl(){return this._url}get wsUrl(){return this._url.replace(/^(http)(s?):\/\//,"ws$2://")}get url(){return this._url}getUrl(){return this._url}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){let e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}var nN=Object.defineProperty,nD=(e,t,r)=>{let n;return(n="symbol"!=typeof t?t+"":t)in e?nN(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r};let nR=/^((?<protocol>http[s]?):\/\/)?(?<host>(localhost|local))(:(?<port>(\d+|__\w+__)))?$/;function nP(e,t){let{subdomain:r,region:n}=e;if(!r)throw Error("A `subdomain` must be set.");let i=r.match(nR);if(null!=i&&i.groups){var s;let{protocol:e,host:r,port:n}=i.groups;return s=t,("undefined"==typeof window&&void 0!==y.default&&y.default.env?y.default.env[`NHOST_${s.toUpperCase()}_URL`]:null)||("localhost"===r?(console.warn('The `subdomain` is set to "localhost". Support for this will be removed in a future release. Please use "local" instead.'),`${e||"http"}://localhost:${n||1337}/v1/${t}`):n?`${e||"https"}://local.${t}.local.nhost.run:${n}/v1`:`${e||"https"}://local.${t}.local.nhost.run/v1`)}if(!n)throw Error('`region` must be set when using a `subdomain` other than "local".');return`https://${r}.${t}.${n}.nhost.run/v1`}class nC{constructor(e){nD(this,"url"),nD(this,"accessToken"),nD(this,"adminSecret"),nD(this,"headers",{});const{url:t,adminSecret:r}=e;this.url=t,this.accessToken=null,this.adminSecret=r}async call(e,t,r){var n,i;let s={"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...null==r?void 0:r.headers,...this.headers},o=this.url+(e.startsWith("/")?e:`/${e}`);try{let e=await (0,rz.default)(o,{body:t?JSON.stringify(t):null,headers:s,method:"POST"});if(!e.ok){let t;return t=null!=(n=e.headers.get("content-type"))&&n.includes("application/json")?await e.json():await e.text(),{res:null,error:{message:t,error:e.statusText,status:e.status}}}return{res:{data:null!=(i=e.headers.get("content-type"))&&i.includes("application/json")?await e.json():await e.text(),status:e.status,statusText:e.statusText},error:null}}catch(e){return{res:null,error:{message:e.message,status:500*("AbortError"!==e.name),error:"AbortError"===e.name?"abort-error":"unknown"}}}}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){let e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}var nU=e.i(778),nL=nU.useLayoutEffect;function nM(e){var t=nU.useRef();return t.current||(t.current={v:e()}),t.current.v}var nj=function(){return(nj=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},nF=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r},nV=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o};function nB(e){for(var t,r,n,i,s,o,a,c,l,u=[],d=1;d<arguments.length;d++)u[d-1]=arguments[d];var p=nV(u,2),f=p[0],v=void 0===f?{}:f,m=p[1],y=(t=nM(function(){return"function"==typeof e?e():e}),r=v.context,n=v.guards,i=v.actions,s=v.activities,o=v.services,a=v.delays,v.state,c=nF(v,["context","guards","actions","activities","services","delays","state"]),l=nM(function(){return ty(t.withConfig({context:r,guards:n,actions:i,activities:s,services:o,delays:a},function(){return nj(nj({},t.context),r)}),c)}),nL(function(){Object.assign(l.machine.options.actions,i),Object.assign(l.machine.options.guards,n),Object.assign(l.machine.options.activities,s),Object.assign(l.machine.options.services,o),Object.assign(l.machine.options.delays,a)},[i,n,s,o,a]),l);return(0,nU.useEffect)(function(){if(m){var e=y.subscribe(eg(m));return function(){e.unsubscribe()}}},[m]),(0,nU.useEffect)(function(){var e=v.state;return y.start(e?e6.create(e):void 0),function(){y.stop(),y.status=h.NotStarted}},[]),y}var n$=e.i(51165),nK=function(e,t){return e===t},nG=function(e,t){if("state"in e&&"machine"in e){if(0===e.status&&t.current)return t.current;var r=0!==e.status?e.getSnapshot():e.machine.initialState;return t.current=0===e.status?r:null,r}return"state"in e?e.state:void 0};function nq(e,t,r,n){void 0===r&&(r=nK);var i=(0,nU.useRef)(null),s=(0,nU.useCallback)(function(t){return e.subscribe(t).unsubscribe},[e]),o=(0,nU.useCallback)(function(){return n?n(e):nG(e,i)},[e,n]);return(0,n$.useSyncExternalStoreWithSelector)(s,o,o,t,r)}let nH=class{constructor({refreshIntervalTime:e,clientStorage:t,clientStorageType:r,autoRefreshToken:n,autoSignIn:i,adminSecret:s,devTools:o,start:a=!0,...c}){nD(this,"auth"),nD(this,"storage"),nD(this,"functions"),nD(this,"graphql"),nD(this,"_adminSecret"),nD(this,"devTools"),this.auth=function(e){let t="subdomain"in e?nP(e,"auth"):e.authUrl,{subdomain:r,region:n}=e;if(!t)throw Error("Please provide `subdomain` or `authUrl`.");return new rC({url:t,broadcastKey:`${r}${null!=n?n:"local"}`,...e})}({refreshIntervalTime:e,clientStorage:t,clientStorageType:r,autoRefreshToken:n,autoSignIn:i,start:a,...c}),this.storage=function(e){let t="subdomain"in e?nP(e,"storage"):e.storageUrl;if(!t)throw Error("Please provide `subdomain` or `storageUrl`.");return new rV({url:t,...e})}({adminSecret:s,...c}),this.functions=function(e){let t="subdomain"in e?nP(e,"functions"):e.functionsUrl;if(!t)throw Error("Please provide `subdomain` or `functionsUrl`.");return new nC({url:t,...e})}({adminSecret:s,...c}),this.graphql=function(e){let t="subdomain"in e?nP(e,"graphql"):e.graphqlUrl;if(!t)throw Error("Please provide `subdomain` or `graphqlUrl`.");return new nO({url:t,...e})}({adminSecret:s,...c}),this.auth.onAuthStateChanged((e,t)=>{if("SIGNED_OUT"===e){this.storage.setAccessToken(void 0),this.functions.setAccessToken(void 0),this.graphql.setAccessToken(void 0);return}let r=null==t?void 0:t.accessToken;this.storage.setAccessToken(r),this.functions.setAccessToken(r),this.graphql.setAccessToken(r)}),this.auth.onTokenChanged(e=>{let t=null==e?void 0:e.accessToken;this.storage.setAccessToken(t),this.functions.setAccessToken(t),this.graphql.setAccessToken(t)}),this._adminSecret=s,this.devTools=o}get adminSecret(){return this._adminSecret}set adminSecret(e){this._adminSecret=e,this.storage.setAdminSecret(e)}setRole(e){this.graphql.setHeaders({"x-hasura-role":e}),this.storage.setHeaders({"x-hasura-role":e}),this.functions.setHeaders({"x-hasura-role":e})}unsetRole(){this.graphql.setHeaders((({"x-hasura-role":e,...t})=>t)(this.graphql.getHeaders())),this.storage.setHeaders((({"x-hasura-role":e,...t})=>t)(this.storage.getHeaders())),this.functions.setHeaders((({"x-hasura-role":e,...t})=>t)(this.functions.getHeaders()))}};class nY extends nH{constructor(e){super({...e,start:!1})}}let nz=(0,nU.createContext)({}),nJ=({nhost:e,initial:t,...r})=>{let n=nB(e.auth.client.machine,{devTools:e.devTools});e.auth.client.start({interpreter:n,initialSession:t,devTools:e.devTools});let i=(0,nU.useRef)(!0);return(0,nU.useEffect)(()=>{i.current?i.current=!1:t&&n.send("SESSION_UPDATE",{data:{session:t}})},[t,n]),nU.default.createElement(nz.Provider,{value:e},r.children)},nW=()=>{var e;let t=null==(e=(0,nU.useContext)(nz).auth)?void 0:e.client.interpreter;if(!t)throw Error("Could not find the Nhost auth client. Did you wrap your app in <NhostProvider />?");return t},nQ=()=>nq(nW(),e=>({isAuthenticated:e.matches({authentication:"signedIn"}),isLoading:e.hasTag("loading"),error:e.context.errors.authentication||null,isError:e.matches({authentication:{signedOut:"failed"}}),connectionAttempts:e.context.importTokenAttempts}),(e,t)=>e.isAuthenticated===t.isAuthenticated&&e.isLoading===t.isLoading&&e.connectionAttempts===t.connectionAttempts);function nX({children:e}){let{isAuthenticated:t}=nQ();return t?(0,nU.createElement)(nU.Fragment,null,e):null}function nZ({children:e}){let{isAuthenticated:t}=nQ();return t?null:(0,nU.createElement)(nU.Fragment,null,e)}let n0=()=>nq(nW(),e=>e.context.accessToken.value),n1=()=>(0,nU.useContext)(nz),n2=()=>{let e=n1(),[t,r]=(0,nU.useState)(null),[n,i]=(0,nU.useState)(!1);return{add:async t=>{i(!0);let n=await ru(e.auth.client,t),{error:s}=n;return s&&r(s),i(!1),n},isLoading:n,isSuccess:!t,isError:!!t,error:t}},n3=()=>{let e=nW(),[t,r]=(0,nU.useState)(!!e.status&&e.getSnapshot().matches({authentication:"signedIn"}));return(0,nU.useEffect)(()=>e.subscribe(e=>{r(e.matches({authentication:"signedIn"}))}).unsubscribe,[e]),t};function n4(e){let t=n1(),r=nB((0,nU.useMemo)(()=>rs(t.auth.client),[t])),n=nq(r,e=>e.matches("requesting")),i=nq(r,e=>e.context.error),s=nq(r,e=>e.matches("idle.error")),o=nq(r,e=>e.matches("idle.success"));return{changeEmail:(0,nU.useCallback)(async(t,n=e)=>rd(r,t,n),[r,e]),isLoading:n,needsEmailVerification:o,isError:s,error:i}}let n8=()=>{let e=n1(),t=nB((0,nU.useMemo)(()=>ro(e.auth.client),[e])),r=nq(t,e=>e.matches({idle:"error"})),n=nq(t,e=>e.matches({idle:"success"})),i=nq(t,e=>e.context.error);return{changePassword:e=>rh(t,e),isLoading:nq(t,e=>e.matches("requesting")),isSuccess:n,isError:r,error:i}},n9=()=>{let e=n1(),t=nB((0,nU.useMemo)(()=>(({backendUrl:e,interpreter:t})=>ta({schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,id:"enableMfa",initial:"idle",context:{error:null,imageUrl:null,secret:null},states:{idle:{initial:"initial",on:{GENERATE:"generating",DISABLE:"disabling"},states:{initial:{},error:{},disabled:{}}},generating:{invoke:{src:"generate",id:"generate",onDone:{target:"generated",actions:["reportGeneratedSuccess","saveGeneration"]},onError:{actions:["saveError","reportGeneratedError"],target:"idle.error"}}},generated:{initial:"idle",states:{idle:{initial:"idle",on:{ACTIVATE:[{cond:"invalidMfaType",actions:"saveInvalidMfaTypeError",target:".error"},{cond:"invalidMfaCode",actions:"saveInvalidMfaCodeError",target:".error"},{target:"activating"}],DISABLE:"#enableMfa.disabling"},states:{idle:{},error:{}}},activating:{invoke:{src:"activate",id:"activate",onDone:{target:"activated",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}},activated:{type:"final"}}},disabling:{invoke:{src:"disable",id:"disable",onDone:{target:"idle.disabled",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidMfaTypeError:eW({error:e=>tA}),saveInvalidMfaCodeError:eW({error:e=>t_}),saveError:eW({error:(e,{data:{error:t}})=>t}),saveGeneration:eW({imageUrl:(e,{data:{imageUrl:t}})=>t,secret:(e,{data:{totpSecret:t}})=>t}),reportError:eM((e,t)=>({type:"ERROR",error:e.error})),reportSuccess:eM("SUCCESS"),reportGeneratedSuccess:eM("GENERATED"),reportGeneratedError:eM(e=>({type:"GENERATED_ERROR",error:e.error}))},guards:{invalidMfaCode:(e,{code:t})=>!t,invalidMfaType:(e,{activeMfaType:t})=>!t||"totp"!==t},services:{generate:async r=>{let{data:n}=await t9(`${e}/mfa/totp/generate`,"GET",{token:null==t?void 0:t.getSnapshot().context.accessToken.value});return n},activate:(r,{code:n,activeMfaType:i})=>t5(`${e}/user/mfa`,{code:n,activeMfaType:i},null==t?void 0:t.getSnapshot().context.accessToken.value),disable:(r,{code:n})=>t5(`${e}/user/mfa`,{code:n,activeMfaType:""},null==t?void 0:t.getSnapshot().context.accessToken.value)}}))(e.auth.client),[e])),r=nq(t,e=>e.matches({idle:"error"})||e.matches({generated:{idle:"error"}})),n=nq(t,e=>e.matches("generating")),i=nq(t,e=>e.matches("generated")),s=nq(t,e=>e.matches({generated:"activating"})),o=nq(t,e=>e.matches({generated:"activated"})),a=nq(t,e=>e.matches("disabling")),c=nq(t,e=>e.context.error);return{generateQrCode:()=>new Promise(e=>{t.send("GENERATE"),t.onTransition(t=>{t.matches("generated")?e({error:null,isError:!1,isGenerated:!0,qrCodeDataUrl:t.context.imageUrl||"",totpSecret:t.context.secret}):t.matches({idle:"error"})&&e({error:t.context.error||null,isError:!0,isGenerated:!1,qrCodeDataUrl:"",totpSecret:t.context.secret})})}),isGenerating:n,qrCodeDataUrl:nq(t,e=>e.context.imageUrl||""),isGenerated:i,activateMfa:e=>new Promise(r=>{t.send("ACTIVATE",{activeMfaType:"totp",code:e}),t.onTransition(e=>{e.matches({generated:"activated"})?r({error:null,isActivated:!0,isError:!1}):e.matches({generated:{idle:"error"}})&&r({error:e.context.error,isActivated:!1,isError:!0})})}),isActivating:s,isActivated:o,isDisabling:a,isError:r,error:c,disableMfa:e=>new Promise(r=>{t.send("DISABLE",{code:e}),t.onTransition(e=>{e.matches({idle:"disabled"})?r({error:null,isDisabled:!0,isError:!1}):e.matches({idle:"error"})&&r({error:e.context.error,isDisabled:!1,isError:!0})})}),totpSecret:nq(t,e=>e.context.secret||"")}},n5=()=>{let e=n0();return e?E(e):null},n6=e=>{let t=n1(),r=nq(e,e=>e.matches("uploading")),n=nq(e,e=>e.matches("uploaded")),i=nq(e,e=>e.matches("error")),s=nq(e,e=>e.context.error||null),o=nq(e,e=>e.context.progress),a=nq(e,e=>e.context.id),c=nq(e,e=>e.context.bucketId);return{add:t=>{e.send({type:"ADD",file:t.file,bucketId:t.bucketId||c})},upload:r=>rH({url:t.storage.url,accessToken:t.auth.getAccessToken(),adminSecret:t.adminSecret,...r},e),cancel:()=>{e.send("CANCEL")},destroy:()=>{e.send("DESTROY")},isUploaded:n,isUploading:r,isError:i,error:s,progress:o,id:a,bucketId:c,name:nq(e,e=>{var t;return null==(t=e.context.file)?void 0:t.name})}},n7=()=>n6(nB(r$)),ie=()=>{let e=n5();return(null==e?void 0:e["https://hasura.io/jwt/claims"])||null},it=e=>{let t=ie();return(null==t?void 0:t[e.startsWith("x-hasura-")?e:`x-hasura-${e}`])||null},ir=()=>{let e=n1(),[t,r]=(0,nU.useState)([]),n=nB(rq,{},e=>{"UPLOAD_ERROR"===e.event.type?r(e.context.files.filter(e=>{var t;return null==(t=e.getSnapshot())?void 0:t.context.error})):(e.matches("uploaded")||"CLEAR"===e.event.type)&&t.length>0&&r([])}),i=nq(n,e=>e.matches("uploading")),s=nq(n,e=>e.matches("uploaded")),o=nq(n,e=>e.matches("error"));return{upload:t=>rY({url:e.storage.url,accessToken:e.auth.getAccessToken(),adminSecret:e.adminSecret,...t},n),add:e=>{n.send({type:"ADD",...e})},clear:()=>{n.send("CLEAR")},cancel:()=>{n.send("CANCEL")},progress:nq(n,e=>e.context.progress),isUploaded:s,isUploading:i,files:nq(n,e=>e.context.files),isError:o,errors:t}},ii=e=>{let[t,r]=(0,nU.useState)(!0),n=n0();(0,nU.useEffect)(()=>{r(!1)},[]);let i=(0,nU.useContext)(nz);return new Proxy({},{get(r,s){let o=`${i.auth.client.backendUrl}/signin/provider/${s}`,a=null!=e&&e.connect?{connect:n}:{};return t6(o,t7(t?void 0:i.auth.client.clientUrl,{...e,...a}))}})},is=e=>{let t=n1(),r=nB((0,nU.useMemo)(()=>ra(t.auth.client),[t])),n=nq(r,e=>e.matches("requesting")),i=nq(r,e=>e.context.error),s=nq(r,e=>e.matches("idle.error"));return{resetPassword:(t,n=e)=>rp(r,t,n),isLoading:n,isSent:nq(r,e=>e.matches("idle.success")),isError:s,error:i}},io=e=>{let t=n1(),r=nB((0,nU.useMemo)(()=>rc(t.auth.client),[t])),n=nq(r,e=>e.matches({idle:"error"})),i=nq(r,e=>e.matches({idle:"success"})),s=nq(r,e=>e.context.error);return{sendEmail:(t,n=e)=>rf(r,t,n),isLoading:nq(r,e=>e.matches("requesting")),isSent:i,isError:n,error:s}},ia=()=>{let e=nW(),t=nq(e,e=>e.context.errors.authentication||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error)),r=nq(e,e=>e.matches({authentication:{authenticating:"anonymous"}})),n=nq(e,e=>e.matches({authentication:"signedIn"})),i=nq(e,e=>e.matches({authentication:{signedOut:"failed"}})),s=nq(e,e=>e.context.user,(e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id));return{accessToken:nq(e,e=>e.context.accessToken.value),error:t,isError:i,isLoading:r,isSuccess:n,signInAnonymous:()=>rv(e),user:s}},ic=()=>{let e=nW(),t=nq(e,e=>e.context.user,(e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id)),r=nq(e,e=>e.context.accessToken.value),n=nq(e,e=>e.context.refreshToken.value),i=nq(e,e=>e.context.errors.authentication||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error)),s=nq(e,e=>e.matches({authentication:"signedIn"})),o=nq(e,e=>e.matches({authentication:{authenticating:"password"}}),(e,t)=>e===t),a=nq(e,e=>e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(e,t)=>e===t),c=nq(e,e=>null!==e.context.mfa);return{accessToken:r,refreshToken:n,error:i,isError:nq(e,e=>e.matches({authentication:{signedOut:"failed"}}),(e,t)=>e===t),isLoading:o,isSuccess:s,needsEmailVerification:a,needsMfaOtp:c,mfa:nq(e,e=>e.context.mfa),sendMfaOtp:t=>rS(e,t),signInEmailPassword:(t,r)=>rm(e,t,r),user:t}};function il(e){let t=nW(),r=nq(t,e=>e.context.errors.registration||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error));return{signInEmailPasswordless:(r,n=e)=>ry(t,r,n),isLoading:nq(t,e=>e.matches("registration.passwordlessEmail")),isSuccess:nq(t,e=>e.matches("registration.incomplete.needsEmailVerification")),isError:nq(t,e=>e.matches("registration.incomplete.failed")),error:r}}let iu=()=>{let e=nW(),t=nq(e,e=>e.context.user,(e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id)),r=nq(e,e=>e.context.accessToken.value),n=nq(e,e=>e.context.refreshToken.value),i=nq(e,e=>e.context.errors.authentication||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error)),s=nq(e,e=>e.matches({authentication:"signedIn"})),o=nq(e,e=>e.matches({authentication:{authenticating:"securityKeyEmail"}}),(e,t)=>e===t),a=nq(e,e=>e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(e,t)=>e===t);return{accessToken:r,refreshToken:n,error:i,isError:nq(e,e=>e.matches({authentication:{signedOut:"failed"}}),(e,t)=>e===t),isLoading:o,isSuccess:s,needsEmailVerification:a,signInEmailSecurityKey:t=>rg(e,t),user:t}},id=()=>nq(nW(),e=>e.context.user,(e,t)=>(e&&JSON.stringify(e))===(t&&JSON.stringify(t))),ih=()=>{let e=id(),t=n1(),r=ie(),n=!!e&&(null==r?void 0:r["x-hasura-auth-elevated"])===(null==e?void 0:e.id),[i,s]=(0,nU.useState)(!!n);return(0,nU.useEffect)(()=>{s(!!n)},[n]),{elevated:i,elevateEmailSecurityKey:e=>rT(t.auth.client,e)}},ip=()=>{let e=nW(),t=nq(e,e=>e.context.user,(e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id)),r=nq(e,e=>e.context.accessToken.value),n=nq(e,e=>e.context.refreshToken.value),i=nq(e,e=>e.context.errors.authentication||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error)),s=nq(e,e=>e.matches({authentication:"signedIn"})),o=nq(e,e=>e.matches({authentication:{authenticating:"password"}}),(e,t)=>e===t);return{accessToken:r,refreshToken:n,error:i,isError:nq(e,e=>e.matches({authentication:{signedOut:"failed"}}),(e,t)=>e===t),isLoading:o,isSuccess:s,signInPAT:t=>rk(e,t),user:t}};function iv(e){let t=nW(),[r,n]=(0,nU.useState)(""),i=async(...e)=>{if(2===e.length){let[r,n]=e;return rb(t,r,n)}let[n]=e;return rb(t,r,n)},s=nq(t,e=>e.context.errors.registration||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error));return{signInSmsPasswordless:(r,i=e)=>(n(r),rx(t,r,i)),sendOtp:i,isLoading:nq(t,e=>e.matches("registration.passwordlessSms")||e.matches("registration.passwordlessSmsOtp")),isSuccess:nq(t,e=>e.matches("authentication.signedIn")),needsOtp:nq(t,e=>e.matches("registration.incomplete.needsOtp")),isError:nq(t,e=>e.matches("registration.incomplete.failed")),error:s}}let im=(e=!1)=>{let t=nW();return{signOut:r=>rw(t,"boolean"==typeof r?r:e),isSuccess:nq(t,e=>e.matches({authentication:{signedOut:"success"}}),(e,t)=>e===t),error:nq(t,e=>e.context.errors.signout||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error))}},iy=e=>{let t=nW(),r=nq(t,e=>!!e.context.errors.registration),n=nq(t,e=>e.context.errors.registration||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error)),i=nq(t,e=>e.matches("registration.emailPassword")),s=nq(t,e=>e.matches("registration.incomplete.needsEmailVerification")),o=nq(t,e=>e.matches({authentication:"signedIn",registration:"complete"})),a=nq(t,e=>e.context.user,(e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id));return{accessToken:nq(t,e=>e.context.accessToken.value),refreshToken:nq(t,e=>e.context.refreshToken.value),error:n,isError:r,isLoading:i,isSuccess:o,needsEmailVerification:s,signUpEmailPassword:(r,n,i=e,s)=>rA(t,r,n,i,s),user:a}},ig=e=>{let t=nW(),r=nq(t,e=>!!e.context.errors.registration),n=nq(t,e=>e.context.errors.registration||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error)),i=nq(t,e=>e.matches("registration.securityKey")),s=nq(t,e=>e.matches("registration.incomplete.needsEmailVerification")),o=nq(t,e=>e.matches({authentication:"signedIn",registration:"complete"})),a=nq(t,e=>e.context.user,(e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id));return{accessToken:nq(t,e=>e.context.accessToken.value),refreshToken:nq(t,e=>e.context.refreshToken.value),error:n,isError:r,isLoading:i,isSuccess:o,needsEmailVerification:s,signUpEmailSecurityKey:(r,n=e,i)=>r_(t,r,n,i),user:a}},iE=()=>nq(nW(),e=>{var t;return null==(t=e.context.user)?void 0:t.avatarUrl},(e,t)=>e===t),iT=()=>nq(nW(),e=>{var t;return null==(t=e.context.user)?void 0:t.defaultRole},(e,t)=>e===t),iS=()=>nq(nW(),e=>{var t;return null==(t=e.context.user)?void 0:t.displayName},(e,t)=>e===t),ik=()=>nq(nW(),e=>{var t;return null==(t=e.context.user)?void 0:t.email},(e,t)=>e===t),ix=()=>nq(nW(),e=>{var t;return null==(t=e.context.user)?void 0:t.id},(e,t)=>e===t),ib=()=>nq(nW(),e=>{var t;return null==(t=e.context.user)?void 0:t.isAnonymous},(e,t)=>e===t),iw=()=>nq(nW(),e=>{var t;return null==(t=e.context.user)?void 0:t.locale},(e,t)=>e===t),iA=()=>nq(nW(),e=>{var t;return e.matches("authentication.signedIn")&&(null==(t=e.context.user)?void 0:t.roles)||[]});function i_(e){let t=nW(),r=async(e,r)=>rO(t,e,r),n=nq(t,e=>e.context.errors.registration||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error)),i=nq(t,e=>e.matches("registration.signInEmailOTP")||e.matches("registration.verifyEmailOTP")),s=nq(t,e=>e.matches("authentication.signedIn")),o=nq(t,e=>e.matches("registration.incomplete.needsOtp"));return{signInEmailOTP:(r,n=e)=>rI(t,r,n),verifyEmailOTP:r,isLoading:i,isSuccess:s,isError:nq(t,e=>e.matches("registration.incomplete.failed")),error:n,needsOtp:o}}let iI=()=>{let e=nW(),t=nq(e,e=>e.context.user,(e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id)),r=nq(e,e=>e.context.accessToken.value),n=nq(e,e=>e.context.refreshToken.value),i=nq(e,e=>e.context.errors.authentication||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error)),s=nq(e,e=>e.matches({authentication:"signedIn"})),o=nq(e,e=>e.matches({authentication:{authenticating:"idToken"}}),(e,t)=>e===t);return{accessToken:r,refreshToken:n,error:i,isError:nq(e,e=>e.matches({authentication:{signedOut:"failed"}}),(e,t)=>e===t),isLoading:o,isSuccess:s,signInIdToken:(t,r,n)=>rN(e,{provider:t,idToken:r,nonce:n}),user:t}},iO=()=>{let e=n1(),[t,r]=(0,nU.useState)(null),[n,i]=(0,nU.useState)(!1);return{linkIdToken:async({provider:t,idToken:n,nonce:s})=>{i(!0);let o=await rD(e.auth.client,{provider:t,idToken:n,...s&&{nonce:s}}),{error:a}=o;return a&&r(a),i(!1),o},isLoading:n,isSuccess:!t,isError:!!t,error:t}},iN=()=>{let e=nW(),t=nq(e,e=>e.context.user,(e,t)=>(null==e?void 0:e.id)===(null==t?void 0:t.id)),r=nq(e,e=>e.context.accessToken.value),n=nq(e,e=>e.context.refreshToken.value),i=nq(e,e=>e.context.errors.authentication||null,(e,t)=>(null==e?void 0:e.error)===(null==t?void 0:t.error)),s=nq(e,e=>e.matches({authentication:"signedIn"})),o=nq(e,e=>e.matches({authentication:{authenticating:"securityKeyEmail"}}),(e,t)=>e===t),a=nq(e,e=>e.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(e,t)=>e===t);return{accessToken:r,refreshToken:n,error:i,isError:nq(e,e=>e.matches({authentication:{signedOut:"failed"}}),(e,t)=>e===t),isLoading:o,isSuccess:s,needsEmailVerification:a,signInSecurityKey:()=>rR(e),user:t}};e.s(["NhostClient",()=>nY,"NhostProvider",()=>nJ,"NhostReactContext",()=>nz,"NhostReactProvider",()=>nJ,"SignedIn",()=>nX,"SignedOut",()=>nZ,"VanillaNhostClient",()=>nH,"useAccessToken",()=>n0,"useAddSecurityKey",()=>n2,"useAuthInterpreter",()=>nW,"useAuthenticated",()=>n3,"useAuthenticationStatus",()=>nQ,"useChangeEmail",()=>n4,"useChangePassword",()=>n8,"useConfigMfa",()=>n9,"useDecodedAccessToken",()=>n5,"useElevateSecurityKeyEmail",()=>ih,"useFileUpload",()=>n7,"useFileUploadItem",()=>n6,"useHasuraClaim",()=>it,"useHasuraClaims",()=>ie,"useLinkIdToken",()=>iO,"useMultipleFilesUpload",()=>ir,"useNhostClient",()=>n1,"useProviderLink",()=>ii,"useResetPassword",()=>is,"useSendVerificationEmail",()=>io,"useSignInAnonymous",()=>ia,"useSignInEmailOTP",()=>i_,"useSignInEmailPassword",()=>ic,"useSignInEmailPasswordless",()=>il,"useSignInEmailSecurityKey",()=>iu,"useSignInIdToken",()=>iI,"useSignInPAT",()=>ip,"useSignInSecurityKey",()=>iN,"useSignInSmsPasswordless",()=>iv,"useSignOut",()=>im,"useSignUpEmailPassword",()=>iy,"useSignUpEmailSecurityKeyEmail",()=>ig,"useUserAvatarUrl",()=>iE,"useUserData",()=>id,"useUserDefaultRole",()=>iT,"useUserDisplayName",()=>iS,"useUserEmail",()=>ik,"useUserId",()=>ix,"useUserIsAnonymous",()=>ib,"useUserLocale",()=>iw,"useUserRoles",()=>iA],61177),e.i(20831);let iD="nhostSession",iR=e=>{let t=e&&"auth"in e?e.auth.getSession():e;if(!t)return void tE.remove(iD);let{refreshToken:r,...n}=t,i=new Date;i.setSeconds(i.getSeconds()+t.accessTokenExpiresIn-60),tE.set(iD,JSON.stringify(n),{sameSite:"strict",expires:i})},iP="undefined"!=typeof window;class iC extends nY{constructor(e){super({...e,autoSignIn:iP&&e.autoSignIn,autoRefreshToken:iP&&e.autoRefreshToken,clientStorageType:"cookie"}),this.auth.onAuthStateChanged(()=>{iR(this)}),this.auth.onTokenChanged(iR)}}e.s(["NhostClient",()=>iC],36446),e.i(61177),e.s(["NhostProvider",()=>nJ,"useAuthenticationStatus",()=>nQ,"useSignInEmailPassword",()=>ic],73893)}]);